eXeCutE imMedIate *   is  INFiNITE      Or nOt exisTS  ( seLECT NOt Ôºà  "" @ "´™´"   =>  DefaUlT  As MaStEr  @ _5      Ôºå :#·°∑   =>  DeFaULt    )  nOT  In  Ôºà witH ""  .  "„Ñ•" @ lEft     Ôºà MAStEr  Ôºà DiSTinCt Ôºâ   ( "©†ò" @ "®Æº"  Ôºà )   =>  "" Ôºà aLl )   .  :17  @ "„âß"   ( + Ôºâ  OVer ( PArtITion By :1  Ôºà uNiqUe ‚®± )   =>  ‚®± VARrAYs       orDeR sIbLINGS By ‚®± desc  NUlLs FiRST     rOWS ‚®±  foLLoWINg    )   at LOCAl    muLTISET uNiON aLL  traNslAte ( ‚®± USinG CHar_CS )      +  - eXTRACtvALUe ( deFaULT    , xMLcaSt ( ‚®± as lONG    )  at timE ZOne DBTImeZONe    MULtiSEt inteRSeCt  tRIm ( ‚®± FrOM  ‚®± )    ** Cast ( ‚®± as Time   RAnge ‚®± ..  ‚®±    Ôºâ   multiSeT uNioN  cHARSet  @ "™¢Ñ" . :5    .  *  ( + Ôºâ  wiThIN GrOUP Ôºà OrDeR siBliNGs By ‚®±  Ôºå ‚®± aSC  NullS FIrSt     Ôºâ  oVER ( parTItiON BY ‚®± as NOCYcLE       ORDer bY ‚®±  Ôºå ‚®± deSC  NUlls firST     )   aT TimE ZOnE ‚®±       +  + ‚®± aT LOCaL    MulTiSEt InTeRsect  cAST ( mulTISEt Ôºà with "" @ DiREcT_LoaD  . ""    AS ( ‚®± Ôºâ  cyclE "" @ ‡∑®  @ :4    ( ‚®±   )    Ôºå "" Ôºà "" @ "¨øø" @ ""   =>  DEfaUlt  "ßÄï" @ :‡ºõ‡•é      Ôºå ‚®± :_      )     sET aSsociatE  @ :9  . RoWId    .  "®π¥" @ ""     To ''''    DeFaUlt $.7      Ôºà ‚®± Ôºâ  uNION  Select DefAult     inTO ErRoR_INDEx  ( )      FROm ‚®± AS oF periOD FOR ""  Ôºà diStINCt ANysCHemA  @ "" @ ""   =>  defAUlt    )   Ôºà + Ôºâ  BEtWeen    UNpivoT Ôºà Ôºà key  Ôºà uniQue ‚®± as ‚øª4     Ôºå "" @ :4  . :27   ( unIQue Ôºâ   =>  ‚®± AS "®õö"     Ôºâ   Ôºà + Ôºâ  , "ëÇÑ"  .  scHeMa  @ "„âø" . :·†∂‡©¥   Ôºà DEFauLt    Ôºâ     Ôºâ   FOr "" Ôºà UniQUe )   ( Ôºâ      IN Ôºà Ôºà lasT  @ eXPiRE  . ""  Ôºà W_   =>  dEFAUlT  ""     Ôºâ   Ôºà ALL )   ( + )  Ôºå "®Æ≠"  ( + )   )    Ôºâ   )     As _‡≠∂  @ :9  @ ""      PiVOT Xml ( DEFauLt   Ôºå seEd  @ ""   =>  defAUlT    For "•ã´" Ôºà ALL "•äÑ" @ LocaTOr  . ""  Ôºà Ôºâ   =>  ‚®± aS PARTITIoNS  @ "®êÅ"     , "" @ _    =>  ‚®±   )   ( + Ôºâ    in ‚®±  Ôºâ      whERE ‚®±  STart wITH ‚®±  conneCT bY ‚®±    ORDeR By ‚®±  , ‚®± desc  nUlLS FIrSt      Ôºâ  As inTERVal Ôºà DIStinCT DefaulT  As ""     )   aUTo  @ :23  @ "ÆÜì"  ( ‚®± "£¨ì" @ ""      Ôºâ   .  *   To ( )   DEcoDE     CHArAcTEr sET ‚®±    )  at tIme ZONe ‚®±     ** DeCoDE Ôºà ‚®± Ôºâ         , *    Ôºâ      mod  - null  aT LOCAl     mulTiSeT except dIstInCt  "" @ "´ô¶" . ""  ( DIsTINCt Ôºâ   .  NoORDEr  @ :#9  . :6     % FOuNd  AT LoCAl         Is EMptY      OR CuRRENt oF  :25  Ôºà "" Ôºà UnIqUE )   =>  deFaULT   Ôºå "¢É†" @ "™ºú" . coLumN_vaLUe   Ôºà ‚®± Ôºâ   =>  ‚®±   )      and ""  ( + )  % buLK_RoWCOuNt Ôºà ‚®± Ôºâ      ** XMLqUery Ôºà *   PassiNG bY ValuE *   aS :Ôª≤“ë  @ "ß≠ü" @ ""   Ôºà Ôºâ   Ôºà + Ôºâ   , *     REtuRNiNg coNTEnt Ôºâ   At tIme zOne seSSiONtiMezONe       ||  Ôºà ‚®± Ôºâ At LoCAL    multiseT unIOn  TimEzonE_rEGION  @ ""  Ôºà aLl )    % IsoPeN     MOD  sYs_CONneCT_bY_pATh Ôºà UnIQue ‚®± meDIum     Ôºå ·Çé   =>  deFauLt    Ôºâ    MUltIseT EXCePt aLL  xmLagg ( ‚®± Ôºâ  At TIme ZoNe sesSiONTiMEzOnE     ** Treat Ôºà ‚®± AS rEf "®∂è"    Ôºâ         not  BEtwEen  INTErVal '' MinuTE        -  xmLCaST ( mULtIsEt Ôºà Ôºà ‚®± )  uNIon ALl  sELECT DIStinct ‚®± As :37  @ UnconDitIonal  . :92        froM TaBle Ôºà ‚®± Ôºâ   PARTiTIoN bY Ôºà ‚®±   )    Ôºå taBLe Ôºà ‚®± Ôºâ   cRoss jOIn  XmLtABlE Ôºà U''   colUMns ‚®± DoUbLE PRECISIoN   PatH TimesTAmP 'ÆÜô'   deFAUlt ‚®±  Ôºå ‚®± FOr oRDINalITy   Ôºâ  VerSIOns bETWEen TImesTaMP  DIREct_LoAd  @ "§∞ë"   ( + Ôºâ  % BULK_ExCEPTioNs ( ‚®± Ôºâ  . eRRor_InDEx   At LocAL     ** PrIoR COnneCt_by_ROOT ‚®±  At TImE zoNE dBtimEzone      mULtISet ExCEpt aLL  CursoR Ôºà ‚®± Ôºâ  at TIMe zONE dBTimEzone      MOD  ?  aT TiMe zONE seSsiontIMeZONe         AnD CAse ‚®± wHen ‚®± THEN ‚®±  ELSe ‚®±   ENd  at LOCaL     ** NEW "¶Æ¶"  ( + )      mod  "©Ä†" Ôºà dISTiNCT DEfAUlt    Ôºâ   .  "ùûî" @ :_7  . jsOn_tABLE   Ôºà )    KEEp ( DEnsE_RAnk fiRst Order sIbLInGs By ‚®± asC   Ôºå ‚®±    )             PartItIon bY Ôºà ""  =>  dEfaulT   Ôºå :65  Ôºà All ‚®± Ôºâ   =>  ‚®± ""     Ôºâ  jOin  XmLtaBLe ( XmlnAMEspAcEs Ôºà Ôºâ  Ôºå 5.8e-1d   paSSINg AT  ( ‚®± )   =>  DEfaUlT  recyCLe     Ôºå DEfAULT  AS "¨¶ì" @ :11         Ôºâ    ON ‚®±      connECT By NocYcLE ‚®±  sTARt wiTh ‚®±  GROup By ROlLup ( Ôºà ‚®± , ‚®± Ôºâ   Ôºå ‚®±   )    Ôºå Ôºà ( ‚®±   , Ôºà Ôºâ    Ôºâ   Ôºâ        foR UpDatE oF  "" @ tRim    ( + )  , :·áà$  @ "Æçü" @ ""      WiTH rEAd OnLY    )  AS OpaQUE fIXed ( )  uSing LIbRArY _#  @ ""   Ôºà UNIque dEFAuLT  BAtch  @ :6      Ôºå "™öã" Ôºà Ôºâ   =>  ‚®±   )    ;  CHARacTEr SeT ‚®±    Ôºâ    ** flasH_cachE  @ PRiMaRY  @ atTrIbUtes   Ôºà UNIqUe Ôºâ    kEeP Ôºà dENSE_raNK FirSt OrDEr siBLIngS By ‚®± NuLLS laST   , ‚®± DEsc     Ôºâ   aT lOcaL         aNd  *         , :#   =>  noT exisTs  ( SELEcT disTINCt ‚®±  , dEFAult     frOm ‚®± vERsioNS PeRIOD FOr "" ( DEFAulT   Ôºå dEFaULT  As ""     )   Ôºà + Ôºâ  ‚®±  Ôºà ‚®± Ôºâ  mUlTISET iNTersEcT  null  at LocAL     ** ‚®± At TIMe zOne #‡ºÉ  @ "≠á∫"   .  *  Ôºà + Ôºâ           ANd *     UNpivoT exClude nulls Ôºà Ôºà "" @ "®∞∏"  ( Ôºâ   Ôºà + Ôºâ   )   fOR "" Ôºà uniquE "°ØÉ"  =>  ‚®± LANgUAgE  @ :2       )      iN Ôºà DEAlLoCate  @ ""  ( All )      , Ôºà :64  @ ForEign  . ""   ( + )  , ""  Ôºà + Ôºâ   Ôºâ   AS ( tRuE   , DATe ''''   Ôºâ     Ôºâ   Ôºâ      PARtItiOn by Ôºà :70  Ôºà All ‚®± Ôºâ   =>  ‚®± AS sUBtype  @ ""      Ôºâ   UNpIvOT INclUdE nULls ( "°±≤" @ ·πö    ( )     FOr TimezONE_AbbR  Ôºà "" @ "" @ "‚ôå"   =>  DEfAuLT  as :18     Ôºå ‚®± :Ôπª      Ôºâ      in ( ( SPliT  @ "" . :‡¶å$    ( + )  , "¶®Ü"  ( + Ôºâ   Ôºâ   AS tIMesTamP ''''      , ( reAdS  @ "" . :86   ( uNIQuE )    , "≠åí" @ fIrst  @ "§πâ"     )    Ôºâ   )        wItH CHeCk OpTiOn  consTRAiNT :36  ( )      )    AND NOt cURreNT oF  "•µ∂" ( ""  =>  DefAult   Ôºå ‚®±   )       OR nOT eXTrACt Ôºà tiMezonE_hOUR FROm ‚®±  Ôºâ  At TimE ZonE SeSSiOntimezOnE    mUltiSET unIoN ALl  cuRSOR ( wITh ""   ( _  @ nOnedItIOnABLE  . ""  Ôºà unIqUe Ôºâ   ( + Ôºâ  , "Û†Ñú"  .  *  ( + )   )  As ( ‚®± Ôºâ  SEarcH DepTH fiRST By ‚®±  , ‚®± deSc  nUlls FiRSt    SeT "" @ THan  @ :74         sElect UniQuE defauLT  AS SeRverERroR  @ ""     Ôºå "" @ gloBaL   Ôºà uNIQue ‚®± Ôºâ   =>  dEFAulT     BUlk cOLLecT INto lOCaL   ( DisTINct "§¢¥" @ "¢û∑" . :_‡¥ö   ( )   =>  ‚®±   )    Ôºå :9  Ôºà ALl "óÉ∑" @ #    =>  ‚®± ""    Ôºå DefaulT  vaLiDatE  @ "íÑ•" . timezONe_Abbr       )   Ôºà + Ôºâ    FrOM jSoN_TabLE Ôºà ‚®± cOlumns ( "¶ïá"  .  "" @ ·•ä7  @ "°ÇØ"    FoR oRdiNALItY   )  )  "êõ∞" @ PipEliNed      paRtITion bY Ôºà ‚®±   Ôºâ  InNEr joiN  ( jsOn_taBLe Ôºà ‚®± foRmat jsoN Ôºå ""  .  :3  @ "" @ "ìêï"     NUll oN  ERroR  coLumNS ( NEsTeD PaTh DAte '§Öæ'    ColUmns Ôºà "üîü"   NchaR VArYIng ( )     trUNcate FORMAT JSON WITHout arraY wRAPPeR    , "·∂à" @ :8  @ paRTIAL    .  :‹û    FOR orDInALity   )    )  )  PiVoT Ôºà defauLt   Ôºå :43  @ "ßüî" @ "·òû"   =>  ‚®± as LoBs      foR Ôºà ReteNtION  Ôºà DISTINct )   .  *    )    In Ôºà ‚®± Ôºâ   Ôºâ    AS of TImEstaMp  ‚®±  , "®àÇ" @ Value  . Ô¥Ç·æü   Ôºà ‚®± )   =>  DEFauLt  ""         naTURaL leFt OUter  JOin  ‚®±  pIVot Xml ( ""  =>  ‚®±  , DEFaULt  AS :_  @ "¨óú"      for ( QUOTA   Ôºà ‚®±  , :67  @ "ë±ò" @ hEap   ( dIsTiNct Ôºâ   =>  DeFAUlT  As baSic  @ :9  @ ""      )   Ôºà + )   )    In Ôºà ANy   Ôºå ‚®±   Ôºâ   )     Ôºâ aS "ßññ" @ ""     JOin  :·ÉÉ   .  "" @ :9  @ "Í©ñ"    samPLe Ôºà ‚®± )   uNpIVOT Ôºà EvAlUATE  @ :1      For "·ñù" ( Ôºâ   .  *  Ôºà + )    iN ( "¶°Å" ( UniQUE "" @ "êùî"   =>  defaULt  as cLoB     , ‚®±   )   ( UNique Ôºâ   Ôºà + )   aS ( 0xE   , TRue   )     Ôºâ   )      ParTITion By ( ‚®±  , NO   =>  ‚®± ""     )  NAtUrAl RIghT OUter  joiN  ‚®±  oN ‚®±   UsinG ( miNvalUE  @ #  . :Ôºú‡¥Ç    Ôºà uNiqUe deFAUlt  #      Ôºâ    Ôºå "®ªç" @ "¨Å´" . :9   ( truStEd  @ MAX  @ ""  ( alL )   =>  ‚®±  , "·ºé" ( ‚®± Ôºâ   =>  deFault    )   ( )   Ôºà + Ôºâ  )    , ( XmLtable Ôºà U''   paSsing deFauLt     cOlUMNS ‚®± FOr ORDInAlITY   Ôºâ  PIVOt xml ( ‚®±  Ôºå vERsIoNS   =>  dEFAuLT  :_0  @ "≠ëò"      foR coMPaCT  Ôºà "ùÅØ"  =>  deFauLt  "" @ :4      , ‚®±   Ôºâ   .  "≠´ö" @ ""  ( all )   Ôºà + Ôºâ    iN Ôºà Ôºà #  @ PaTh    =>  ‚®± AS SaMple      Ôºâ   As "" @ sOrT  . :6      Ôºå aNY   )   Ôºâ    VERSIOnS BEtWEEn ScN  *   aND *       pArtItIoN By Ôºà ‚®± ""    Ôºå :ƒï·∏à  @ "ù°ä"   =>  ‚®±   Ôºâ  inNer jOin  ( ‚®± )   pARTitiON BY ( deFaulT  AS :#—≤      )  CrOss JoIn  ‚®±    Ôºâ  NAtUrAl JOIN  The Ôºà ‚®± )  piVOt Ôºà dEFault  "" @ ""      FoR ( demAnd  ( )   ( alL "¶è£" @ PCtVersion  @ ""  Ôºà uNiQue Ôºâ   =>  ‚®±   )     )    iN ( ‚®±  AS wrapPED  @ ""     , aNY   )   )      paRtITiOn by Ôºà ‚®±   Ôºâ  rIGHt  JoiN  "" @ :3  @ "·ô•"   .  COntInuE    SUbPARTItIon ( ""  .  dEmANd  ( UNIqUe )    )  sampLe Ôºà ‚®± Ôºâ  SeED Ôºà ‚®± Ôºâ    as OF TimeStamp  "" @ "òùß"  ( ‚®± )   =>  DeFauLT   , DeFaULt  AS "òöÑ" @ "üåâ"          cROSS Join  ‚®±  UsInG ( "ûÄÖ" @ :1  @ Ô¥å6     Ôºå AcCoUNt   Ôºà + Ôºâ  Ôºâ    UNpIVoT inClUdE NullS ( Ôºà :1  @ "‡™™"  ( ""  =>  DeFaULt  :·Å≤      Ôºâ   ( + Ôºâ   Ôºâ   FOr ( "¢à°" @ "ó≥ó" @ ""  Ôºà AlL Ôºâ    , "õäß" ( COnStraiNTs   =>  defAUlT  As VaRcHAr  @ :5       )     Ôºâ    iN ( Ôºà LOgging   Ôºà + )   Ôºâ    , „ÇîÔæ∑  @ FiXed   Ôºà AlL ‚®±   )   .  "üå¢" @ "" . :5    ( + )   as 0X      Ôºâ   Ôºâ      whERe ‚®±  HaviNg ‚®±  groUp by gRoUPIng sEts ( RolluP Ôºà Ôºà ‚®± Ôºå ‚®± Ôºâ    Ôºâ     Ôºâ    , ( ( Ôºà ‚®± , ‚®± Ôºâ   )   Ôºå groUpiNG Sets ( Ôºà ‚®± , ‚®± )   Ôºå ( )    )    )        for UPdate wAit Q',òñ™,'     ORdeR BY ‚®± DesC  NUllS LaST     wItH cHeCK oPtIoN    Ôºâ        LikE4  syS_CoNNeCT_BY_Path Ôºà )         eScaPE ‚®±    anD *   < >  NcHR ( ‚®± Ôºâ    ** Ôºà ( ‚®± )  iNTErsECT  ( ‚®± Ôºâ   Ôºâ  AT local      *  Trim Ôºà ‚®± FRoM  ‚®± Ôºâ  At TIME ZONE Xmlagg Ôºà ‚®± ORDer siblingS by ‚®± nuLls LAST   Ôºå ‚®±    )  At tIMe zONe dBTImEzOnE       MULtisET EXCEpt  trANSLATE Ôºà ‚®± uSInG cHAR_cs )    ** "•ò°"  Ôºà + Ôºâ  OVer Ôºà Ôºâ   aT lOcaL    mULTiSEt EXcePT  6  aT locAl              ""     )    , "¢Éì" @ :7      Ôºâ  aS ( WITH lasT    as ( ‚®± )   , "" @ rEdUCeD  @ ·πø     Ôºà :8  @ "" . savePoInT   ( )   .  *   Ôºå :#‹í  ( ALl "" Ôºà dISTINCT Ôºâ   =>  DEfAULT    Ôºâ   .  *    Ôºâ  aS Ôºà ‚®± Ôºâ  search dEpTH firSt By not "ó±≠"  ( Ôºâ   ( + Ôºâ  % BuLk_ExCeptioNs ( ‚®± Ôºâ  . erRor_CODE    MuLtiseT iNtERSect disTiNCt  + cONnECT_bY_rOot "" @ "¢¥Æ"  Ôºà ‚®±   )   .  *   At tIMe zone sEssionTImEzoNE         /  neW :42   ( uNiQUe ‚®± daTABASe  @ STOragE  . ""     Ôºå :_  @ yeAr  . ""   =>  DEFault  As :4      )   Ôºà + Ôºâ     ** XMlQueRy ( *   PaSSiNg *   as REF  @ "ÆüÆ"  ( Ôºâ     Ôºå NEW LiKE4  @ ID  @ _   ( diStINCt Ôºâ   Ôºà + Ôºâ   At lOcAL     ** "´âã" @ ""   Ôºà + )  witHiN grOUp Ôºà orDEr By ‚®± nulLS FIrst   Ôºå ‚®±    )    mULTisET INTErsEcT All  XmLcaSt Ôºà ‚®± aS ‡¥Ç$  Ôºà aLl ""  =>  ‚®±   )    % rowTYpE    )  aT TimE ZOnE tRaNslaTe Ôºà ‚®± UsIng NcHAR_cs )  At locaL              rEtURniNG conTEnT )       ||  CaSE WheN ‚®± tHeN ‚®±   end     /  ExtRaCt ( Day FrOM DATe  ‚®±  )  AT TiMe zoNE DBTimezoNe         is  nAn     AND nOt Ôºà DEfauLt  AS "ó®´" @ OpeRAtIONS  @ "‚ò´"     , deFAULt    Ôºâ  ovErLapS ( "" ( Ôºâ   =>  ‚®± "´≥¶"     Ôºâ         asC  nulLs last    SET "" @ :4  . exTErnalLY       cyCLE prIVate  @ "≠æ´" @ ""  ( UniquE NoT *   iS OF ( _    , "´èä"   )     aND "" @ "óôÉ"   ( + )  % rowcount   MUltiSeT UNion  tREat ( ‚®± aS UNUSAbLE  @ :14    .  "‚∫•" @ :4      )  . :÷†$   .  "" ( ALl adVAnCeD  @ "" . ""   =>  DeFAuLT   , DeFaULt    Ôºâ      at LoCAL         =  Any  Ôºà :1   =>  ‚®±   Ôºâ     OR ExISTS  Ôºà ‚®± )       "òúî"     Ôºâ   Ôºà + Ôºâ  Ôºå colLECT  @ ""  Ôºà Ôºâ     SEt eXTRACT  @ ""   .  ·øèÔÆë     to '£Ωñ'    DefaulT Nq'#§ßï#'       ( ‚®± Ôºâ  For upDAtE SKip loCKed   orDEr By "ßææ" @ :2  . inItranS   ( dEfAulT  as coNstant  @ :ƒø1       )   .  :_3    OvEr Ôºà PARTItion BY auTHId  @ "†ç£"   =>  ‚®±  Ôºå defaUlT     Ôºâ   at LocAL    mUlTiSet inteRsect  exTRacTVaLuE ( "Ø•á" Ôºà "" @ ""  ( UniquE )   =>  ‚®± As ""     Ôºâ   =>  ‚®± "´ã†" @ :53       Ôºå *    Ôºâ    ** prIoR Sys_connECt_BY_PaTh Ôºà Ôºâ   aT TIme ZoNe - ‚®± AT timE ZoNe DbTImEZone                aND Not CuRreNt OF  PuBliC   ( DIstINct Ôºâ   ( + )     OR ( :76  Ôºà UniQue defAulT  diReCT_Load      Ôºâ   =>  ‚®±  Ôºå dEfaUlt    Ôºâ  oVErlaps ( "ü†ß"  =>  ‚®± aS ""     Ôºâ         ASC     WitH READ ONLY  cONsTraInT "" @ "" . "§ª±"      Ôºâ    Ôºà wiTh "®ìµ" @ #    .  CoNsTant    as Ôºà ‚®± Ôºâ  SEarCH dEPTH firsT By deCodE Ôºà ‚®± Ôºâ   MUlTiset INTerSecT diStiNCT  CAST Ôºà ‚®± aS Ôºà tRuE  Ôºå faLse  )  )  at loCAL     ** WrAppEr  @ ""  Ôºà AlL ""  =>  DefAUlt  ""    , ‚®±   Ôºâ   ( + Ôºâ  KeEP ( deNSe_raNK FiRsT oRdeR by ‚®±  Ôºå ‚®± ASc  NUllS lAST     )  over ( ORdER SIBLingS By ‚®±  Ôºå ‚®± deSC  NUlLS LASt     RanGe betWeeN unBoUnDEd FolLoWINg  anD curRent ROw    Ôºâ    MultISEt uNIOn  Ôºà ‚®± Ôºâ at lOCal         Is of TYpe Ôºà ONlY ‡•ä  @ :3  . TIMeSTAmp     , #·Åå    Ôºâ        dESc  nULlS fIrSt    sET levEls  @ "•ò°"      CyCLe reWRiTE  Ôºà "ùÑì" @ :43  . ""   =>  DEfAUlt  as "™ßê" @ "†Ü∞"     Ôºå noT (  dEfAULt   Ôºå :#  Ôºà )   =>  ‚®±   )  IN  ( DefaULT  AS nEw_nAmes  @ daTe  . :6      Ôºå ‚®± as "•®á" @ "" @ fIXed       Ôºâ     And not *   NOT  In  *       OR CURREnt oF  "ÆÆÜ" @ :53   ( :›õ  @ ""  Ôºà All Ôºâ   =>  ‚®±   Ôºâ           )   Ôºà DistInCT Ôºâ   ( + Ôºâ   sEt loNg     tO .1D    dEFAulT '•ì∂'       ( ‚®± Ôºâ  unIOn  SElecT ""  =>  Default  ""    Ôºå "" @ "§∞î" . ""   =>  Not XmLQueRY ( *   pAsSING BY vaLUe Ôºà ‚®± )   mULtIset inTERsecT AlL  ?    ** CUrsOr Ôºà ‚®± Ôºâ  At TimE ZoNE TRIm Ôºà ‚®± )  At loCaL          +  DECOdE Ôºà ‚®± )  AT lOcAL    mulTiSEt eXcePT disTinct  3e3D      Mod  chr Ôºà ‚®± usiNg ncHaR_cS Ôºâ   MultisEt UnioN  EXtRaCT Ôºà deFAulT  ﬁ®  @ alWAYS  @ "¶úì"      Ôºå *    Ôºâ  aT TimE ZonE SEssiOntIMEzOne         AS :66  @ :87  @ LIkE2   Ôºà dEfaUlt   Ôºå "§ãÜ" ( ALL ‚®± )   =>  DeFaulT    Ôºâ   Ôºà + Ôºâ    RetUrnING COnTeNt Ôºâ   AT timE zOnE dbTimEZone    mUltIsEt UNION  Ôºà ‚®± )   ** CURSOR Ôºà ‚®± Ôºâ     mOD  "£Æª" @ CacHE  @ "ÆØä"   ( Ôºâ   Ôºà + )  wiThIN gROUp Ôºà ORdeR SiBlInGS bY ‚®±    )   at LOcal     ** :##  @ "ìÇì"  Ôºà UNiQUe fUNCTioN   =>  ‚®± :7     Ôºå ‚®±   )    At tiME zOne DBTiMEzoNE       -  Treat ( ‚®± aS "≠ôë"  .  "ëª®" @ "" @ MAP      )  . "™Üø" @ :52  @ :≈î·§®    .  ""      mULTiSET inteRsEct DISTINcT  nuLl        beTwEEN  EXTRACt Ôºà TiMezone_minUte frOm ‚®±  Ôºâ  at TiMe ZONe sESSIoNtIMEZone      *  pRiOR CASE ‚®± WheN ‚®± then ‚®±   eND          anD  *     AnD ExiSTS  Ôºà ‚®± Ôºâ       AS "" @ "™øè"       bulK colleCt INTO errORS  @ teMPOrAry   Ôºà UNIQue Ôºâ   Ôºà deFAUlt    Ôºâ    , "©çå"  Ôºà + Ôºâ    FrOM ( :ÕΩ    SAMpLe BLoCk Ôºà cUrRenT Of  BReAdtH  Ôºà aLL Ôºâ   .  *  ( + )       Ôºâ   as DbtImEzOne     parTITion By Ôºà not XMlcast ( MuLTISeT ( ‚®± )  as TiMEsTAMP ( "" @ :1    =>  ‚®± aS "ß¢ò" @ "·≠ä" @ "ßπ´"      )   WItH ( Ôºâ   tiMe  ZONe Ôºà DeFaulT    )     )  aT tIme ZonE _2  ( UNIQuE )   ( + Ôºâ  WITHIN GroUp ( OrdEr by ‚®±  Ôºå ‚®± NuLls FIRsT     Ôºâ  ovEr Ôºà )          ||  NeW PCtversION   Ôºà DefAUlT   Ôºå "„Å±" @ "" @ #    =>  deFAuLT  "" @ followinG       )     AT LocaL     ** tRAnslAtE ( ‚®± usiNG NcHar_cs )        < =  SOME  Ôºà ‚®± Ôºâ    AND *   In  Ôºà  uNDer  Ôºà Ôºâ   =>  ‚®± SuSpenD     , "√ñ" @ ‚∂´‚∫¥   Ôºà ALL )   =>  defAULt    Ôºâ     Or Ôºà DEfAULT  aS :5  @ "" @ ""     Ôºå ‚®± :_      )  OvERlaPs ( :77   =>  ‚®±   )         aS "" @ "" . "·õê"      )  fUll  JoIn  JSoN_taBLe ( NOT xMlAgG Ôºà ‚®± Ôºâ  AT LocAL    MULtisET EXcePt diSTINCt  "ùòÑ" @ BEFOre  . OvERlAPs     oVeR Ôºà oRDeR By ‚®± desC     )   At LOcal     ** ?      ||  + ?  At tiME zonE nulL      at Time zONE sEsSIonTImezOne    multisEt excEPt aLL  + caST Ôºà multiSeT ( ‚®± )  As Ref eXIt  @ "" @ :2   Ôºà distINcT )   ( deFeRrABlE  ( unIque DeFAULT    Ôºâ   =>  ‚®±  , ‚®± "·∑¥"     Ôºâ   Ôºà + Ôºâ   % TYPe    )   At LocaL         nOT  LiKe2  Decode Ôºà ‚®± )   MultiSEt ExCePt  syS_conNECT_BY_pAtH ( "òÑì" @ month    =>  DefaUlT  :12  @ "ßëü" . "Û†Ü©"     Ôºå DEFAULT    )   at timE ZOne seSsiontimezOnE     ** "" ( All )    % isopeN   MuLtISEt excePt DiSTINCt  coNnect_by_ROOt CHr ( ‚®± UsInG ncHaR_Cs )    AT lOCaL      /  CAsE whEn ‚®± THEn ‚®±  eLsE ‚®±   eND  AT lOcal    MuLTIseT EXCePt  - treat ( ‚®± As rEF ""  .  "" @ :2  . gEneratED      Ôºâ      ** "" @ "£ùº" @ "ü•è"   .  NOPARallEl  ( DistINCt ‚∑ï   =>  ‚®±   Ôºâ   ( + Ôºâ  KeEp Ôºà dENse_RaNk laST oRdEr sibLINgS By ‚®± desc   Ôºå ‚®± NUllS last     Ôºâ  over Ôºà paRTiTioN By DeFault  as #       oRDeR By ‚®± dEsC  nuLLs fIrSt     ROwS UNboUNDED prECeDIng    )   At TIME ZonE DbtiMeZONE    MuLTisET ExCePT disTincT  "" @ :1   Ôºà )   Ôºà + Ôºâ  OvER ( )   AT tImE ZONe SEssioNTiMezoNE       +  edITIoniNg   .  *   % bUlK_rowCOUNt ( ‚®± )     MulTISEt InTeRsecT  xMLQUery ( *   PAssing sys_cONnect_by_pAtH ( DIStincT Ôºâ   at tiME zONE xmLCast ( MULtiSeT ( ‚®± Ôºâ  aS timeStaMP   range ‚®± ..  ‚®±    Ôºâ  at LOcal         /  ( ‚®± Ôºâ          rEturnInG conTEnt )     ** exTraCT ( TimEzOnE_miNute frOm dAtE  ‚®±  )   MultISeT unIOn  "·æÜ" @ "°∏á"    KEEp ( DeNSe_raNK fIRst OrdeR BY ‚®±    )  oveR ( PARTiTiON BY "" Ôºà DIsTinCt ‚®± as "·∏§"     Ôºâ   =>  ‚®± :72  @ bREAdTh  . "òã≤"     Ôºå "Æûö" Ôºà UniquE Ôºâ   =>  DEfAulT     )   At loCAl      /  miNeXTEnTs  @ nO  @ :#    Ôºà + Ôºâ  OvEr ( ParTItIon bY defAULT     ORder sIBLinGS By ‚®± aSc  nuLLS LasT   , ‚®± nULLs First     )   AT tIme ZONE cONNEct_bY_RoOt PRioR ‚®±        mULtiSeT uNIoN ALl  nCHR Ôºà ‚®± )    ** :‡®ø  Ôºà Ôºâ   .  "òöà" @ "®Üâ" @ :#ƒü     aT LocaL            OR nOT eXiSTs  ( ‚®± )       , "óâò" @ FrEeliSt    .  ‡Æä·øâ     COluMnS ( NChaR_cS  @ :5  . ""   .  ""   Ôºà FalSe  , fAlsE  )  exIsTs PATh .2     , USAGE    oPaqUe FIXed ( :9  @ ""  Ôºà )   =>  *   SUbmULtiseT Of TrEaT Ôºà ‚®± AS "™™î" @ "êîÉ" @ "ü§°"     )   at TiMe ZONe sESsiOnTIMEZOnE       ||  xmlAGg ( ‚®± OrDer bY ‚®± ASc   Ôºå ‚®±    Ôºâ            AnD Not ExiSts  Ôºà ‚®± Ôºâ     or Not ?   multiSet UnION  XMLAgG ( ‚®± Ôºâ  aT LoCaL       +  NcHr ( ‚®± Ôºâ  AT locAL     ** tRiM ( ‚®± )  at tImE zONe dbtimezoNE      mOd  - cONneCT_bY_roOt NEW DBtImezoNE  @ "" . :77   Ôºà "´ô≤"  =>  dEfAuLt  As "§Öü"     )   .  *  Ôºà + Ôºâ      aT LoCaL    multIsET UnIon alL  iNTERVAl '''' YEAR  TO yeaR Ôºà uq'&´Æè&'   Ôºâ     at tIMe ZonE rebUild   Ôºà disTINCT Ôºâ    ovEr ( )   aT LOcAl        ** - trim ( TrAilIng FROm  ‚®± Ôºâ    MulTiSeT inTerSECT  tRaNSlATe ( ‚®± UsInG NCHAR_cs )              , *        aS "" @ LiKe2       )  Using LIbRaRy "ÆØ†" @ Escape   ( DeFAult    )   Ôºà + Ôºâ  ;  rAnGe CUrRenT of  :65      AnD nOT EXiSTS  Ôºà ‚®± )       ..  NoT Ôºà  "¨Ω¨"  =>  ‚®± :#  @ "òü†"     , "ÔΩª" @ SHuTDOWN  @ ""  ( aLl ‚®±  Ôºå DefAult  ·ã¥      Ôºâ   =>  deFaUlT    )  ! =  Ôºà ‚®± )     ANd NOt *   Is  NoT  NaN      OR *   nOt  IN  ( ‚®± )          tRuNCATE PATh ""  .  :3  @ minvALuE  . onLIne        )  )  aS of sCN  "Ô¥í" @ "•Øñ" @ "ùñ≤"  Ôºà DiStINct Ôºà  ‚®± , ‚®±  )  <  Ôºà Ôºà ‚®± Ôºâ  Ôºå Ôºà Ôºà ‚®± )  Ôºâ  Ôºâ      or *   liKe4  :57  @ "" @ :‡¥¶1   ( Ôºâ   ( + Ôºâ  % RowcOunT  at TiMe zOnE ( ‚®± Ôºâ      MUltISEt UnIoN ALL  aLLOW  @ ""   Ôºà ‚®± Ôºâ    % IsoPeN  aT tiME ZonE dBtIMEzOnE       +  NuLL   mUltiset eXcePT  cAST ( ‚®± As ReF "ùÇü"  Ôºà uniqUE Ôºâ   Ôºà + )    Ôºâ  aT LOcAl         ESCape ‚®±       #‡æ§     , jsON  Ôºà uNIqUE Ôºâ   =>  DEFauLt  As "" @ SAlT       )   =>  nOt CUrREnT OF  "" @ :5  @ ""      and ExISTS  Ôºà ‚®± Ôºâ     oR nOt *   is Of Ôºà oNlY ""   Ôºå _5  @ iNcLudiNg    .  "" @ "" . InITIaLLy     )         Ôºå dEfaUlt      pIvoT ( :2  @ "™≠π"  Ôºà Ôºâ   =>  NOT ExTraCTvAlue ( SAVE   =>  ‚®±   Ôºå *    , new "" Ôºà dIStinCT DEFAUlT  aS :‡Øó$  @ "ÆÇû" @ :5      Ôºå DefAUlT  "‡®ß"     Ôºâ   .  "§∞í" @ "£äè" . ""   ( + Ôºâ    muLtIseT excePt DisTIncT  EXTRact ( "" ( AlL ‚®±  Ôºâ   =>  ‚®±   Ôºå CuRsOR Ôºà ‚®± )  At TIME zOnE SESsIoNTImEZONe     ** dECOdE ( ‚®± , ‚®± Ôºâ     *  :16  @ uNusEd  @ ""    aT tIme ZoNe dBtimEZONE    MultIset EXcepT DISTIncT  nOMiNValUE  Ôºà )   .  *   WIthIN grOup Ôºà OrDEr sibLiNgS bY ‚®± DesC     Ôºâ   At LOcAL     ** :#4  Ôºà ‚®±  , "•ôì"  =>  ‚®±   )   .  "óò´" @ TiMezONE_MiNUtE  @ ‡µæ    Ôºà + )  % bULk_ROwCOUNt Ôºà ‚®± Ôºâ    AT LOcaL          )    ** exTrAcT Ôºà HOUR frOm DaTE  ‚®±  Ôºâ   mUltiSeT InteRSect DIStiNcT  U''   aT LoCaL      *  xmLqUery ( + ‚®± At time zOne DbtimEZOne     ** deCODE ( ‚®± Ôºâ   MultISeT except  TiMeZONe_AbBR  @ "" . FALsE   Ôºà "ò£ú" ( dIsTinCt )   =>  deFauLT  As #      Ôºâ    WIThin GROUP ( ORDER bY ‚®± nUllS laST     Ôºâ  over ( PartiTIOn BY defAULT  AS :10  @ "‡æá"     Ôºå coLLaTIoN  @ :4    =>  ‚®±    orDER bY ‚®±    rANge between ‚®±  fOLLoWInG  ANd cURrEnT RoW    Ôºâ         PAsSing By valuE *   AS "" @ extENT    Ôºà dEFauLt  "´Ñè"     )   ( + )    rETURNinG ConTent )   at time Zone seSsIOntimeZONE       -  ExtRACT Ôºà ‚®± "¢óÜ" @ "´πö" . "´áê"      , *    Ôºâ     MOd  PrioR - ‚®±   aT loCaL    MUltiSET IntErsECt DIstinCT  ExTRact ( dEFaULt    , CHaraCtEr    keEP ( dense_RaNK lAst oRDEr SiBLingS by ‚®± NullS FIrSt   , ‚®± aSC  nUlLS LAST     Ôºâ     ** XMlAGg ( ‚®± ordER sIbliNgs BY ‚®± ASC     )         Ôºå "·Ü©" @ :42  . :4   ( )   Ôºà + )  % buLk_excePTiOns . COUNT   at timE zoNe DbTimEZone    MulTIsEt ExcEpT  CasE whEN ‚®± THEN ‚®±   End  at loCAL          Ôºâ    ** eXTraCt ( TimEzoNe_HOUR FROM ‚®±  )  At tiMe zONE ( ‚®± Ôºâ at LocAL             Ôºâ     /  TRanslaTE ( ‚®± USiNG NCHAR_Cs )  aT LoCal     ** dECOde Ôºà ‚®± , ‚®± Ôºâ      ||  XmlQUeRY Ôºà cASt Ôºà mUlTiSeT ( ‚®± )  as Ôºà falsE  , true  Ôºâ % rowTypE    Ôºâ  at TimE zOne SeSsIoNtIMEZoNe    muLTIsET UNIoN ALl  TrUE      /  Cursor Ôºà ‚®± Ôºâ  At TimE ZonE dbTIMeZoNe     ** DEcODE Ôºà ‚®± )   mULtiSET uNIOn  TRiM ( ‚®± )        pASsING By VaLue *     ReTURnING CONtENt Ôºâ   aT loCaL    mUlTiSET UNiOn  ?    ** TrEAt Ôºà ‚®± AS rEf fIlESysTeM_likE_logginG   .  :‡µ®     )  . _‚ºú  @ IdeNTIfIer   Ôºà DIStINCt Ôºâ   ( + Ôºâ    AT tiME zONe seSSIOntImezonE    MULTisET excepT  cONNeCt_bY_rOOt SYs_cOnnEcT_By_pATH ( distiNCT MinexteNtS  ( ‚®± Ôºâ   =>  ‚®± "ìà®" @ "êì¥" . ""      Ôºâ   at locaL     at TiMe ZOne nUlL        *  xmLCAst Ôºà ‚®± As LONG raw ( UNIQUe Ôºâ      )          anD CuRReNt oF  "§Ø§" Ôºà )   Ôºà all "°ä≥"  =>  DeFault    )       oR *   not MEmBer OF *       aNd noT eXiStS  Ôºà ‚®± Ôºâ       ""     fOr sTOrAGE  @ :‡´â$    .  *  ( + )    IN ( ‚®± Ôºâ   Ôºâ     cOunt  @ "" @ "¨û∑"     PArtItIOn by Ôºà defAuLt  aS "" @ ""     Ôºå #7  @ :3  @ sTOrE   Ôºà dIStINCT "" @ NCHR    =>  Not exTRACt Ôºà TIMezone_mINute FROm DaTE  ‚®±  )   mUlTISet uNiOn diSTIncT  ‡≤Ç‡µ∫   Ôºà + )  aT TiMe zOne SESsiOntiMezonE         in  (  ‚®± Ôºâ    AnD ( ‚®± )  oveRlapS Ôºà ‚®± )           Ôºâ   =>  XMLagg Ôºà ‚®± oRDer By ‚®± asC  NuLlS laST     Ôºâ  at lOcAL    MulTiset UNion  + chR ( ‚®± USinG nCHAr_cS )      /  "" ( )    wiTHin groUp Ôºà orDer SibLiNgS BY ‚®± nulLS FirST   Ôºå ‚®±    Ôºâ   at LOcAL    mULtIset EXCEpT All  XmlcaST Ôºà multISET Ôºà ‚®± Ôºâ  As DOUBLE PREcISIoN Ôºà dEfauLt    Ôºâ    )    ** ""  Ôºà uNiqUe ‚®±   Ôºâ   ( + Ôºâ  % buLK_ROwCOuNt Ôºà ‚®± )    AT lOcAl         noT  bETwEen  *   And  *      oR (  soRT   =>  ‚®± AS :3     Ôºå DEFauLt    Ôºâ  ^ =  Ôºà ‚®± Ôºâ     aND CUrRENT OF  onlIne  @ ediTIoNAble    ( alL Ôºâ         "üì¥"     Ôºâ  naTUraL joIn  ‚®±    Ôºâ   pivoT ( "òÇÉ" @ "" @ ""  ( Ôºâ   =>  DeFauLt  :9  @ "" @ "†äÄ"     , "Ø¢±" ( DistiNCt dEFaUlT   Ôºå nOT cURREnT Of  :„áî‡≥¶  @ enABlE   Ôºà ALl Ôºâ   .  "" @ :_2       aNd noT *   nOT  lIke  *   EsCaPE ‚®±       As ""     )   =>  ( ‚®± ) at TiMe zOne tRAnslATE ( ‚®± usIng nChAR_cS Ôºâ      MuLtIsEt EXcEpT  Ôºà ‚®± Ôºâ     MOD  Pipe  ( Ôºâ   .  *  Ôºà + )  keEP Ôºà deNse_Rank FiRst OrDer sIBlIngs BY ‚®± desC  NulLs lASt   Ôºå ‚®± ASc     Ôºâ   aT TiMe zonE dbtiMezoNe     ** neW "" @ "´ã≠" @ :5   ( dISTinct NchaR_Cs  @ "" @ :8    =>  DEfAuLt   , ‚®±   Ôºâ     at LocAL    MULtISet intERSecT DisTInct  CaSe WhEn ‚®± thEn ‚®±  elSe ‚®±   EnD      ||  trIm ( ‚®± )  At LOcAL    mUltISeT uNION DisTInCt  Case ‚®± wHEN ‚®± Then ‚®±  else ‚®±   End     /  ?    ** DAtE ''   at TIME zonE DbTIMeZoNE         not  BEtWEEN  *   And  tREAT ( ‚®± AS ref gEnEratED  @ "" . "‚Ñ¥"     )  . ‡∞Ç1   ( + )    At lOCAL     ** Ôºà ‚®± Ôºâ     /  + syS_cOnNEct_By_paTh ( Ôºâ    aT LoCaL       ||  "§∂Ü" Ôºà INteRval   =>  DefaULT  as :4  @ :_  @ PARTITIOn       )   .  *   keep Ôºà dENSe_Rank laST ORdEr By ‚®±  , ‚®± dESc  nULls Last     )  oVeR ( Ôºâ            Or NOt ( ""  =>  ‚®±  , dEFauLt  aS "¨ç¥"     )  oVErlaps Ôºà deFAulT  AS oRGanIZatIOn  @ VisIBLe      , "" @ :2  . ""  Ôºà DIStiNCT )   =>  ‚®±   Ôºâ      And _  ( )   ( "ßÉ°" @ ""  Ôºà ALl ‚®± )   =>  defAuLt    )    % found  aT tIme zonE SESSionTIMEzone    MUltIseT UNiOn  XMlqUerY Ôºà *   PASsiNG tRANsLate ( ‚®± uSING ChAr_Cs Ôºâ   mUltIset ExCEpt DISTINCt  eXtrACt Ôºà TIMezone_regiON from ‚®±  )    ** PRior xmLQUeRy ( ‚®±   *  ‚®± mulTisEt EXcept  ‚®±  ** ‚®± MUltiSET EXcept  ‚®±      PASSiNG *     RETUrNING CoNtENt Ôºâ   AT TIME ZoNE ‚®±     aT TIME ZoNE SEssioNtiMezoNe    MulTisET InteRseCt ALl  prIOr CAST Ôºà ‚®± AS RAw   rangE ‚®± ..  ‚®±    Ôºâ    at LoCAL      /  syS_conNEcT_By_PATh Ôºà uNiQuE ‚®±   )    MultIset excePt AlL  ConNEct_by_Root :#  @ "§≠à" @ "©Ææ"   Ôºà + Ôºâ  aT loCAl     AT tImE ZOnE "§∞Ø" @ :84  . loCkiNG    Ôºà + )         -  - nEw :4  ( Ôºâ     At tImE ZoNE seSSIOnTImEzONe     MuLtIseT uniON  "" @ "„ãì" @ searCH   Ôºà Ôºâ   Ôºà + )  wIthin grOuP Ôºà ORder BY ‚®± dEsC   , ‚®± NuLLs lAST     )     ** ( ‚®± ) At locAl    mUltISet InteRseCt AlL  CurSOR ( ‚®± )  AT LOcaL      MOd  treat ( ‚®± AS "©Ç¨"    )     ** subPArTiTiONs  @ "" . „ÉÄ·àÉ    Ôºà DISTInCT ‚®± AS cHarActER  @ lESs       )   Ôºà + Ôºâ  oVeR Ôºà PARTiTiOn By ""  =>  dEfaULt  "≠ùæ"      OrDeR bY ‚®± nuLlS FiRsT     )         AS "£ñê" Ôºà ALl Ôºâ   Ôºà + Ôºâ    ReTUrnING coNtENT )   at Time zoNe dBTimEZoNe      moD  8.E-8        Not meMbER oF *            fOR Ôºà :_Ô±â  @ pAssInG  @ "¶¥ñ"  ( :·ªü#   =>  DEfAult  ""     Ôºâ     Ôºâ    IN Ôºà aNY   Ôºâ   )     Ôºå Ôºà ‚®± )  :66  @ CHarSeT         stART wITh nOt CuRSoR Ôºà ‚®± )  at TIMe zoNE + ?  AT lOCAl    at LoCal       mULtISet UNioN  extrAct  mONth FroM ‚®±  Ôºâ    ** chr  ‚®± USInG nCHAr_cs )     /  "ñºê"  .  *   WitHiN GROuP  oRdEr BY ‚®± Asc  NulLs lAST         MultIseT inTeRsEcT  TRim  leadinG ‚®± From  ‚®± )        iS nOt OF Type  :52   .  "íâó"   Ôºå "§óä" @ ""             cOnNECt by nOcycLE Not cuRREnt Of  maTcHeD   ‚®±  , :·ªõƒø  @ "" @ WAiT    DistInCT    =>  deFAuLT  as :98  @ "‚∫â"         .  "" @ aFtEr  . "¢èè"    +         haViNg nOT eXIStS   ‚®±     aND "" @ serverErRor  . ""    % notfoUnd  at tIme ZoNE dBTIMeZonE    MultISET EXCepT DiSTinct  SUBmUlTISet   disTiNcT     keEp  dENSe_ranK FIRSt orDeR SiBLIngs BY ‚®±  , ‚®± DESc        At locAl     **  ‚®±     /  prIoR xmlqUeRY  *   paSsING cAst  muLtIsET  ‚®±   as InTErvAl  "" @ "§ç≠"   ‚®±       uNiquE     +   To  :70            aT tiMe ZoNE SeSSiOnTimEZone    mulTISET eXcEPT  _·ø£    +   % bulk_eXCEPtIOnS . coUNt   At tiME ZonE ‚®±       -  "" @ "ßúú" . mAstER    ‡¥∂   alL ‚®± "" @ ""         =>  DEFault        % rOwCoUnT     /  nULL   muLTIsET EXCept  "" @ :#Í†ì  @ "†òß"    % BULK_RowcOunt  ‚®±     aT lOCal     ** TReaT  ‚®± as reF nOcycle       . "" @ EmptY  @ ·Ö£1    .  :7       MULtISEt UniOn DiSTInCt   ‚®±   At loCAL           RETURNiNG CoNTENt    At LocaL      multIset excEPT  CasT  mULTISET  ‚®±   AS VaRcHar2 CollAtE RowCOUnt      % RowtYpE      At tiME ZoNe  ‚®±       ** "¶ñá"  aLl :25  @ "" @ ""      =>  DEFauLt  NatUraL  @ dAte  @ :7          .  "Ôª´"      +   % BuLk_rOwCOUNT  ‚®±     aT LOCAl       -  decoDe  ‚®±   AT TiMe zOnE dBtImEzOne    mulTiSET exCEPt AlL  xmlAGG  ‚®±     ** trIm  ‚®±   aT TImE zone dBtImEzOne    muLTiSET InTErSeCT diStiNct  case when ‚®± theN ‚®±  eLsE ‚®±   eNd     /  :52  @ uNuseD  . ""   unique ‚®± AS "≠•ú"         +   OVER     aT TimE zoNe SesSiOnTImEZone         BETweeN  *   anD  xmlCAst  ‚®± aS OPAque fiXeD    UsiNG LIBRaRy :#  @ "™æß"    ;       ** COnNecT_By_rOOt pRIor "†πë" @ :98  . kEEp_dUpliCAtEs     % IsOpEN  At LoCaL          /  coNNECT_By_ROOt eXTRAcT  UNdeR   =>  ‚®± ‡∞ó  @ "™™•"      Ôºå :#1       +   OvEr  oRDER SiBlINgs By ‚®± DEsc        at tIme Zone ‚®±    Multiset EXCEPT All  nEW "" @ LEvEL    aLL alWays   alL DEFault       =>  DEfauLt  as ""             *  Null  At LoCal       -  exTract  ‚®±   , *       muLTIsET exCEPT  nuLl  aT LOcaL     **  ‚®±    mULtiSEt uNiON  prIOR ‚®±     Mod  cASE ‚®± when ‚®± tHEn ‚®±   END   muLtIseT UNIon  NchR  ‚®±   aT TIme ZOne dbtimezONE     ** EXtRAct  Hour from DatE  ‚®±    aT LOCal    MultiSEt inTeRsECT diStINCT  - ‚®± AT tImE zoNe ‚®±          , XmLcaSt  ‚®± aS oPaQuE fixEd  All ‚®±     usING lIBRARY ""   "‚öó" @ ""   =>  DEfaulT  ViSible     , :5      =>  ‚®± "" @ "ß´¥"          +   ;      MULTiSET UNIoN  ''''       +  "£¥∞" @ ""   .  *   +   WITHin gRouP  ORDEr SIblInGs BY ‚®± nulls LASt   Ôºå ‚®±      oVer     At TIme zONE SESsiONTimezOne     ** 1D   At lOCAL    MulTISet inteRSecT dIStinct  + ‚®± at LOcAL              at tIme Zone seSSIoNTIMeZONe    MultISeT EXcepT dIstINct  + CHR  ‚®± USIng NcHAr_cs      ** ?                oRDeR SIblINGs BY Not exists   ‚®±        deSc  NULls FirSt   Ôºå nOt *   <  *     And treaT  ‚®± as :#  @ cOALeSCE    .  ""      . :8    +     AT TIMe ZoNe DBTiMeZOne    MultIsET IntERsECt DIstINCt  CasE ‚®± wHEN ‚®± tHEN ‚®±  eLSe ‚®±   eNd        ~ =  "°ëØ" @ DUPLICAtED    uniqUE     UNIqUe DEFAUlt        aT loCaL    MuLtIseT InterSEcT  sYs_cOnNect_bY_paTH  ‚®±  Ôºå LoGgInG   =>  DEFAuLT          *  XmLAGg  ‚®± ordeR bY ‚®± NuLLS firsT       At TIme zONE sESSIontiMEzONE    muLTIset EXcePt alL  trIM  TraiLING ‚®± frOM  ‚®±       +  Ô±°1  @ :87  . “Ω2    UNique     +   AT loCaL     ** "¢ëû"       keep  dENSE_RAnK last ORDEr SIBLINgS By ‚®± AsC   , ‚®± deSc       oVer  ParTiTion BY ‚®± "ê¥Ñ"    Ôºå "" @ "¶∫©"   ‚®±  , defaUlt  aS "" @ "‚å†" @ ""         =>  DefaULt  as NUllS       ORdEr SIBLinGs bY ‚®± NUlLs fIRSt   Ôºå ‚®± nulLS fiRsT           mOD  xmLQueRY  CURsor  ‚®±    mULTISEt UNIon  ncHR  ‚®±   aT tImE ZoNE nuLL  aT TIme ZONe dBtiMEzOnE         mOD  Prior CURSor  ‚®±     At lOCal    MUlTisEt INTerseCt  xMLcAst  muLTISET  ‚®±   as vARCHaR  ‚®± chaR     ChARActeR seT ‚®± % cHarSet       AT tImE ZOne sESSiOnTImEzoNE     ** CAsE ‚®± WhEN ‚®± thEn ‚®±  ElsE ‚®±   END  aT local         pAssINg by vaLue *   as always      returnIng cOnteNT      ** EXTrAcTvaluE  TABLeSpAcE   =>  ‚®±   Ôºå *    , *               Or nOT  "™∫ê" @ _    disTinCt    =>  deFaULT  As :31  @ RELaTIoNal  @ Use      , dEFAuLT      ovERLAps  DEfaULt   , "êÖ≤" @ "òçç" . "Íù§"   =>  ‚®±         and *   nOT  likE2  *        ASc     fOR UpDate SKiP LOcKEd      mINUS  sELEct dEfaULt  AS :80     , :‡∏§Ô±π   aLL noT exisTS   SElECt uNiqUE ‚®±  IntO "" @ jAVA       .  dAtA      froM xMLTAbLE  xmLNAmespaces  ‚®± defaulT TIMEStamP ''     , 0x   COlumns ‚®± :91  @ "™çΩ"   ‚®±     DIstInCT ‚®±     +   cHARactER set ‚®± % CHarSeT         unPIVoT  "Æ¶à"  .  *   +    FOR "" @ :Ô≥ª4        ALl     +     IN   "¢ÆΩ" @ ""    +   Ôºå "Íïï"          As IntErval '' MiNute  uq'\·ìÜ\'                  VeRsIonS PERiOD FoR USe    betweEn  tRAnSLATE  ‚®± uSinG nCHAR_cS      Mod  - nChR  ‚®±   At TiME zOne dBTImeZone          anD ‚®± At loCaL     ** CoALescE  @ "†º¶"    DisTinct     % isOpeN   MULtiSEt exCept alL  EXtRACt  ‚®±  Ôºå "·âá"  AlL ‚®±     ‚®±     +   AT LoCAl     **  ‚®±  at TIME zOne DBtiMeZonE    mulTisET EXCePT aLL  ConnEct_BY_roOT ?       /  deCOdE  ‚®± , ‚®±   At LOcal    MuLtiSET eXCEPt  xmLQuerY  *   pASsING BY VAlue XmLaGG  ‚®±   At tImE ZOne ‚®±       ||  CursOR  ‚®±      MOD  TrANsLaTe  ‚®± uSiNG NcHaR_cs    MulTisEt inteRsEcT DIsTiNcT  new rePLaCe  @ cOnveRT        +           , - ‚®± at timE zonE SeSSIONTIMezonE     ** exTRaCT  tImEZoNe_hOuR FroM date  ‚®±    AT loCaL       ||  tRim  ‚®± FROM  ‚®±   at LOcal    muLTISet iNtersect disTiNCT  ExTRACT  ‚®±  Ôºå ‚®±      ** pRIOR ‚®±  aT loCal    MulTIsEt unIon  NUlL     mOD  DEcODe  ‚®± , ‚®±   at tIMe zONE ‚®±    MultiSeT eXcePt DIstInCt  TreAT  ‚®± AS ReF "" @ ""   .  ""             aS "" @ ·àæ  . :52       rEtURNING COnteNt      ** caSE WHEn ‚®± tHEn ‚®±   enD  aT Local       +  SYs_coNNECt_bY_pATH      mULTIset EXCEPt  ?  aT TiME zOne cAST  ‚®± aS :82  @ "" @ _    uNiqUe ‚®±     +   % RowTYpE      aT TIMe zonE SESsiONtimezone        ** :5   .  ""  disTincT ‚®±        MoD  NeW vIRtUaL              AT LoCAL      /  CURSoR  ‚®±    MUlTIsET exCEpT  XMLaGg  ‚®±   at TIME ZOne SessIONTimeZONE     **  ‚®±   MUlTisEt uNIon  XMlagg  ‚®± Order bY ‚®± dESC   , ‚®± NUlls FIRSt       AT loCAL             pArtiTiON BY  ‚®±   JoIN  tablE  ‚®±     ON ‚®±   PivOT xML  ‚®± For "´ù†"  DIstINCT     +     in  Any           Ôºå TImestAMp  @ sibLINGS     AS Of PerIoD fOr "¨≥î" @ "¶ë¥"   .  *   ‚®±      PartITIoN bY  ‚®±      wheRE ‚®±  conNecT bY ‚®±  GrOup BY      ,   ROLlUP  ‚®±  ,  ‚®±         , RoLlUp  ‚®±                havInG ‚®±    iNtersect   ‚®±   wItH cheCK oPtion         Or *   Is  nOt  InFiNitE        ""        =>  noT cuRReNT oF  traNslaTE  @ ""    +           BulK COlLEct INTo "Æåû"      +   , Œå·ø´   :7  @ :86    uNIQUe "¢πô"  =>  CurRent Of  pcTuSEd  @ :_Ôæ∑    uNiQUE ‚®±     +     aNd XMLCAsT  mUltISet  wIth AttriBUTES  @ :16      "" @ "" . ""   .  :_  @ quOta  . ""    Ôºå PaRent          as  ‚®±   seArCH BReaDth firST By ‚®±   set exTRAcT      cYCle "¶¶Ø"  ‚®±      sET Ô≠Ø  @ "" . "ﬁÄ"   .  "ü©¶" @ "†ºù"     tO n''    DeFauLt interval '' yeaR  TO SEcONd  FAlse   Ôºå dAte 'ò°à'           , ""   as  ‚®±   cyCle "" @ QuEry        Ôºå "óç∫"   DiSTinCT ‚®±     +    sEt "" @ :9      to TImEStaMP '≠ã∞'    defAulT 0X        ‚®±   ORDEr bY ‚®± aSC  NUllS LAst   , ‚®± nulLs Last        AS RAW  alL        aT TIMe ZONe dbtIMeZoNe    MulTiseT uNioN  sYS_conNeCt_bY_pAth  ‚®±        ||  TREAt  @ :#    .  *   +   % bUlk_exCeptIONS . counT     ** "¶âà"   WITHin GRoUP  ORDeR SiblinGs BY ‚®± Asc       oVeR  paRTitIOn By ‚®±     AT local              as :_     , NeSTEd   ‚®±    =>  DEFAULt  "" @ "§ïî" @ BREADth          =>  *   NOT  iN   SeLECT UNIquE ‚®±    iNtO "" @ :3    dIstIncT     +     FrOm  ‚®± UNpivoT EXclUde NUlls   eXCEpTIons  @ "êä©"    uNiQUe         for  :50   dEFAuLt        +        in   ""  .  *       aS TIMeStaMP ''               CroSS jOIn   ‚®± unpiVoT EXClUde nULLS  "†¢Å" @ ""    +    fOr rEfEREnCES  @ ""   uniQUE     +     in   ‡∑Ø   UNiQuE         +                  NATuRAL inNEr JOIN  ‚®±     as "" @ :5      iNner JoIn  json_tablE  ‚®± FoRmAT jSon COlumNS  nESTed daTE ''    coLumNs  No              uNpiVoT iNClUDe NUlLs   "™•ò" @ SeGmeNT         for "£ó´" @ "Í¶Ñ"    +     IN  _  @ ""   All DeFAULt  aS tIMESTaMp                     parTitiON By  ""  ‚®±    =>  dEfaulT       On ‚®±   UnpiVOt iNcLUDe NULls   :6  @ :·•™        +       For LimIt      IN   ""  .  *                 where ‚®±    fOr UPDAtE of  ""  UNiqUE :6  @ exIT    =>  ‚®± ·Ñâ0          dISTiNct COntINUE  @ "ßßÇ"      =>  dEfAult        +     wITH cheCK opTioN  ConsTraiNT "Ô∂∞" @ ""             "" @ :1          .  "§∏ì"        fROM Json_TaBLE  PCTtHreSHold  @ valiDATe    uNiQUe ‚®± AS :88          +   KEEP  densE_RANk first oRDEr sIbLInGS by ‚®± DeSC  nulls LaST       Over  ParTItioN by ‚®±    oRder BY ‚®±    ranGe betweEN CUrrenT rOW  AnD ‚®±  fOlLoWing                  FORMaT JsON COlumNS  "™ª©" @ ""    foRmat JSon WITh coNdITiONAL WrAPpER  PATH AFTEr           pIvoT  ""  =>  dEfaULT    FoR  :_·Ü∫         in  wiTh "òò´" @ ""    aS  ‚®±   SEARCH dEPth FirsT BY nOt   :‡Ø∏5   ALl    =>  deFault  nomaXVALUE  @ CASCadE         nOt  In    ‚®± AS ""               asc  nUlLS FiRsT    SET "•¶º"        ‚®±   orDeR sIbLINGS By not ExiSTS  ‚®±         FOR updatE oF  SPlit  @ "•ì¨"         NOWaiT           VeRSions bETWeEn tiMEsTAmp  *   aNd *       PARTITIOn By  ""  =>  DEfauLT      CrOss JOin  xMLtaBLE  n''''       PArTitIon BY  "" @ :80    DEfAUlt  As :72  @ ""         =>  exISTs   SEleCt ‚®± "¨ÖΩ" @ DIsaBlE        FrOm ‚®± versIONs PeriOd fOR :63  @ BuilD    Distinct    .  "óî•" @ "¢Éê"   DisTInCT ‚®±       +   betWEEn  *   aNd #_    oVEr       ** ‡øá  @ ""    "¢éó"  DiSTincT    =>  dEfAUlt        +   % founD  at tIMe zONE - CAst  ‚®± As rEf "„Ñë"  ""  =>  ‚®±       DEfaulT  aS dEcRYPT          +    characTeR SET ‚®± % ChaRSet       AT LoCAL                 LeFT OutEr  jOIN  ‚®± UsInG  :5   ALl          START WiTh ‚®±  COnnECT bY nOcyclE ‚®±  GroUP By   groUpINg SeTS  ‚®±                           "‹©"         uNPiVoT eXcLUdE NULLs  "" @ referENceS    .  cOunt  @ "®Ωê"    +    For  ""   +        iN  :_·üÑ  @ :#    Rowid  @ "¨∏æ"   aLl    =>  ExtracT  MonTh FROm DatE  ‚®±    At TIMe ZoNe dbTiMezOnE         nOT sUBMULTISET OF CoNNECt_BY_rOoT CHR  ‚®± uSINg nchaR_cs     at LoCAL     ** nULL  At TIme Zone dBtimeZONE                       aS  tRue                 wHERe nOt  SelEct DEFaUlT     iNto "îêõ"     fROM  "•úû" @ :2     as of PERIOD For "´∞î" @ "Æìé"       ‚®±    pIvOt xMl  :80      =>  ‚®± bufFer_pOol      For joIN  @ ""   .  *     iN ‚®±        naTURAl iNNer join  the  ‚®±    PArtITIOn by  deFaULT      inNEr JOin  ‚®±      PArTiTION bY  dDl   =>  dEfAUlT  AS "ë∞á" @ ‡∞®            cOnNect bY ‚®±  sTaRt WitH ‚®±  HAVING ‚®±    ORDer By ‚®± NuLls laSt     with rEaD onLy  constRAiNT :#·áë  @ "©ô•"   uNiquE deFaulT  aS bulK  @ EdItionINg                     Like2  *         GroUP BY   ‚®±     >   WIth :9     Í†ï·åã    Unique "·ó†" @ ELEMent    UnIque DefAuLt  "" @ ""         =>  ‚®±       +      aS  ‚®±     sElECT disTINCT "¶£≤" @ ""   dISTINCt DefaUlt       =>  ‚®± :41       BuLK COLLeCt iNTo "™ÑÇ"       +     froM xMLtABLe  XMlNaMEspAcES    , timesTaMp ''''   PasSINg By vaLUE ‚®±       :47     fULL  JoIN  ThE  ‚®±    JoIn  "" @ RaiSE_appLICatiOn_ErROR     SUBpaRtItiON  :5   diSTinCt     +     sAMpLe bLocK  ‚®±   SeEd  ‚®±     PiVot Xml  "†éÑ"  =>  ‚®± aS "" @ _‡∫ö       FOr "" @ ""         in  ‚®±  As ""           VeRsioNs BEtwEen TimeStAMp  *   aND SYs_CONnecT_bY_patH  disTiNCT    AT tIme zONE ""  .  InCludiNG  @ dEptH     % BUlK_EXceptIons  ‚®±   . ErroR_IndeX                CrOsS JoIn  ‚®±  UsIng  "óÖô"   ‚®±       +       pivot  "" @ MediUm    DEfaULt  OptImAL  @ ""         =>  DefAulT  :·Å£7      FoR new_nAmes  @ #    All :83      =>  dEfAulT       .  *     IN ‚®±        wheRE ‚®±  sTaRT WitH ‚®±  ConnecT by ‚®±  hAVinG ‚®±  grOup BY   ‚®±            fOR uPDAtE OF  :8     nowait                 hAvInG EXists    ‚®±   FOR UPdATE SKIP LocKed   OrdeR bY ‚®± dESC                wITH rEaD oNly               FroM  THe  WITh "‚ØÄ" @ "¶°®"     "" @ ""    +      as  WiTh sYNoNYm    AS  ‚®±   SeArch DePth FIRsT By NoT *   IS NOt of TYPE  OnlY "™Éº" @ ""            ASC    seT DemAnd      cyCLe "" @ enfOrced    uniquE     +    seT "‡æñ" @ eNcrypT      to intERvAl '''' hOur  To miNuTE  0X2   , 0X         dEFAULT FAlSE        ‚®±   orDEr SIblIngs bY NOt  "®∑Ω"  disTInCT deFAULt  As ‡ß°6         =>  NoT .0  at LOcAl     ** trIM  ‚®±         Is A SET            OvErlaPs  :_$  @ fREEListS    =>  NoT *   is  NulL        "´°á"              Nulls FIRsT     foR UPdatE of  mIN  @ ""    ""  DeFauLt       =>  cURreNt oF  :38   .  :99  @ _·¢ç        +        uSINg  @ ""                  seLect deFAuLt  As Ô≤Ñ       Bulk coLLeCT INto ""   dIsTINCt     +     FrOm  ‚®±   AS oF PErIod FoR novaLidATE   "´®¥" @ C    =>  nOT *   iS NOT EMPTy             .  *   cUrreNt of  "´Ç¥"   uNIQUe     +             paRTiTion BY  :5  @ ""   =>  DefAUlT       Pivot XMl  deFaULT    fOr  :√ú  @ ""   "©ùú"  DIStinCt    =>  NOt   trEaT   =>  + dECoDE  ‚®±   At loCAL          iN  "ü•Ω" @ :·ûª    aLL ‚®± aS "ëÉ∏" @ anYSCheMa           +   wITHIn gROuP  ORdEr BY ‚®±      oVER  ORDER sIbLIngs BY ‚®± DESc  nULLS FiRST     raNGE uNBounDED pREcEDiNg       AT local               aS :3  @ "¨∞¥"        IN   DeFAuLT            "§üô"        .  *        iN  ‚®±            wItH cHEck optiON  CONStRAINT "£¶∫"          for UPDATE skIp lOckeD   WItH cHecK OPtION      UnpIvoT incLUDE NUlls   dEFERred  @ nO    DiSTinCt "íä∞"  =>  DefAULt  as "©∏Ñ"             foR pRecedING  @ ƒîu    .  *     IN  :‡•¶   UNiqUE NoT cUrREnt Of  nESTeD  @ "îôÑ"    +        "¨èâ" @ :26                          pArTiTION By  ""  dEFAult       =>  dEfaULt       UNPiVot ExcLuDE NUllS   "ß¨ã" @ ""   .  :2  @ ""   aLL *   ! =  *                  foR oVERlapS    UnIQUe     +     In   "´ìÖ"   +       As  q'^^'                 As rEsULT     CroSs joIN  :64  @ anAlyZE     saMplE  ExIstS   wITh :_0     "" @ ""       as  SElEct UNiquE "Æûª" @ "¨££"      =>  NOt  eValUATe   =>  DefAuLT  AS "" @ ""        oVerlaps  ‚®±            rEwrItE  @ :5        FrOM  ‚®±    pARTItion BY  noT CASt  MUltISeT  ‚®±   as dOuBle pRecISION          ** xmlqUERy  TrEAt  ‚®± As "°µä" @ :#        . "†º±"  DiSTInct DeFaULT          AT TIMe zoNE SESsIoNtimEzOne         PAssinG *     ReTuRninG cOntENT          Is  NoT  NUll        "Ø®ò"       NATUrAL iNNer JOiN  ‚®±    COnnect bY nocyCLE ExistS   ‚®±         group bY nOT *   IS Of  :2                   Order By *   IS NOt Of  onLY "·©£" @ ""            DesC        sEarcH DepTh fIrst BY nOT XmLCASt  MuLTisEt  wItH ""   AS  ‚®±   cycLE :35  @ DAY    NOmaxVAluE  @ ""   =>  DEFAuLt        +    set _     TO ''''    DEFAuLT 0       ‚®±      aS "ëµø"  .  "´ÆÄ"  aLl     +      aT LocaL     ** cAse elSE ‚®±   enD  At TImE ZOne DBtimEZONe              asC  nULLS fiRst    seT eXcLUdE  @ :Ô∂Ñ          sEleCt aLl nOcopy  @ pERIoD       =>  DEFAulT  as :75  @ CrEAtion        intO :4  @ "ßàí"   aLl     ALl "" @ ORDINALIty    =>  NOt  ‚®±     oVerlaPs  ‚®± ""              as DEfeRRed          +     From Json_table  TrAnsLate  ‚®± usiNG NChAr_cs         not  in   ‚®±        , .1E+3D    COLUmNs  NesTed n'©™º'    columns  ""   EXIstS           unpIvot   #·Ñ≥            fOR ""  .  *     IN   "©ò∑"  All SPacE   "·ã£" @ ""      =>  DEfAUlt  AS :44  @ ""         =>  NOt cuRrEnt Of  :·øæ$  @ moNitORIng     defauLt                   +       AS 0x              "™ò∑"       Where ExIsTS   ‚®±         sTARt with  ‚®±     ** ''         BeTWeen  *   aND  *         coNNEcT bY nocycLe cURrENT OF  "" @ ""   ALL     +         hAvINg Not  ‚®±  aT TIMe ZonE TRanSLAte  ‚®± uSiNg NCHaR_cs        ** coNnecT_By_rOot ?    At loCaL         nOt  liKE4  *   EScApe ‚®±          foR uPdAtE OF  ErrOR      orDeR SiBlINgS BY ?  at LocaL     **  ‚®±         < >  SOMe     "" @ :1    =>  ‚®± "" @ :Ôºø                  nuLlS FIRSt     wITh rEAd onLy                 "´û•" @ ""     LEfT  joiN   ‚®±    CRoss JOIn  ‚®±  ON Not ExiStS    sElEct dEfaULt  __       into queRy   sessioNTImEZonE  @ ""   =>  DefAulT       .  ""   +     FrOm jsoN_Table  "êôß"  UNIQUe    .  :47    % noTfOUnd  AT tImE zone sESSioNtIMEzONE     ** poLYmorpHiC  @ "©Ñ°"   deFaULt        +   OvER  OrDER siBlingS By ‚®±    RAnge BETWeEN ‚®±  PREcediNg  and cUrrEnt ROW       AT LOcAl         iS  NoT  NuLl        , :73  @ oPaQUE      COLuMNS  ·åØ    ExIsTS       As of SCN    UnUSED  @ elSIf    uNIqUE "‡øè" @ :_       =>  ‚®± "ÆìÉ" @ "£ú©"         =>  ‚®±     >    dEFaulT  as #…Ñ                     As ""    pARtItiON by  NOt *   Is Not A SEt        as LiKec  @ ""         PIVOT  reLiES_On   =>  defAULT    For  "êïû" @ ""    dIStiNcT     +        In  anY            WherE nOt  DefauLt      ovErLAps  "" @ :66    ‚®±      =>  dEFault  aS "" @ DIsablE                 conNecT By NOCYClE NOt Current OF  ""   uNIqUe :9  @ :#_       =>  DeFAUlt              stArT With *   > =  nEw ""       +                  WIth read oNLy  CoNstrainT DAtabAsE   DIstInct :52   =>  NUll  At Time ZONE dbTImEZonE         nOT  BeTwEEN   ‚®±    ** elemeNT  @ "Ø§∞"   uNIQUE ‚®± :37  @ "Í¶É"         .  *   kEEP  dENSE_rank LAsT Order by ‚®± Asc  nUlLs fIrsT        at locaL         and  *        AS "" @ ŸÆ·Äø               OrdeR sIbliNgs by noT cURrent OF  ""        NuLlS FIrSt                unpivot  "" @ MIn        ALl     +    fOR  "°éô" @ "§°ü"   .  :3  @ ""         in  :#7   aLL     NoT NCHR  eXistS   wIth "¢Æà"    "‡≤±" @ wORK       .  *   +      aS  WiTh :9    as  ‚®±   sEarCh Depth FIRst By ‚®± DEsc    sEt "™åØ"        ‚®±   oRDEr bY ‚®± NuLls LaST     for upDAte WAit Q':≠≠ñ:'     with check opTIOn  CoNstRaInT OUter        CYcLE "ùúá"  DISTINCT JavA   =>  DefauLT         Set "ßëù"    TO q'--'    DEFAULt 6f       SElECt AlL "" @ "„áä"      =>  ‚®± aS "Æ†î" @ AGEnt        buLK colLect INtO ‡∂£·∫ø    +     FRoM JsON_tABLE  ‚®± FoRMat JSOn ColuMns  tyPe  @ ""    fOR oRdiNalITy       AS oF pERioD FOr FUlL  @ "°ª∫"   aLL dEfAULT        BETWeeN    Pivot XML  DEfaULT  ‡≥¨8      FOR "Í™¥" @ :#     +     IN   :1   "ìâ∫" @ #    All    =>  ‚®± EXtErnaLLY  @ ""         =>  ‚®± :8  @ SuBPARtItion                    pARtITioN by  DeFAuLT         whERE ‚®±  StARt WItH ‚®±  CoNnect bY ‚®±    For UpDaTe oF  "" @ "≠Üâ"     SkIP lOCKeD                   iS  INFiNITe              +              ConNEcT by *   In  *          hAvInG nOT *   lIkeC  nUll  at tIMe zoNE coNnECT_BY_ROOt oVeR    +          ** exTraCt    ""  all    =>  DeFault  As :1        iN   SELeCT defauLt  aS ""      frOM xmLTAbLE  iNTeRVAL '' Year  tImesTAmp ''   Ôºå 7.6D        PasSiNg By vAlUe "ëç´"  =>  DefAUlT         ParTition by  ‚®± ""       INnER jOiN  TabLE  WitH pIpEliNeD  @ SHARDeD     As  ‚®±   CYCle ‡ΩΩ  @ "·ãâ"     sET "Ô∞Æ" @ :4      To tiMeSTAMp ''    dEFAUlT datE ''        ‚®±   With CheCK oPTion       NAtuRaL join  pCtUsed    VERSiOnS peRiOd fOR "óæ¨"  :13  @ ""      =>  deFaUlT       .  *   +   ‚®±  + - ‚®± at TIme ZoNE SeSsioNTiMeZoNE    at LOcaL     ** TRanslatE  ‚®± USINg NChaR_cs         And *     UNPIvoT   rEsULt_CAcHE    All "ûÄè"  =>  ‚®±           foR  "" @ ""   dEfaulT             In  "" @ XmLSCHEma     +              PaRTitIoN bY  ‚®± as "©®í"          UNPiVOt excluDe NULlS  :#Ôæ†   alL      FoR NoLoggING  @ Ô∫£    dEfaULt  AgGRegaTe  @ :67           +     in   aRRAy           aS dAtE ''''               wHERE ‚®±  gROup by         HaviNg ‚®±    For UpdatE Wait n''''     oRder SIBlIngs bY ‚®±    wiTH reaD only  cOnsTRAinT "´Çï" @ "òëä"                Ôºå XmlQUERy  cASe NOt ‚®±       EnD  At TImE Zone ‚®±         PAssing *   as :1    +     rETuRNinG conTent           , *      At TiME ZONE DBTimezONe         EsCAPe nOt ExISTS   sELect DiSTINCt "§¢î" @ "¶¢º"   UNiQuE    =>  ‚®±    INTo GlobAL   .  :·Ωü6  @ "£å¢"      FrOm XmLTAbLE  TruE   coLuMnS ‚®± FOR oRdiNAlItY     PIVOT  "" @ "¶ñæ"   ‚®±      =>  DefAULt  "·Ä™" @ :#       For  "•õª" @ globaL     DisTiNcT     +        In  WITH :15  @ ""    as  ‚®±   sEaRCH brEaDTH fIRSt BY ‚®± aSC    SeT ""        ‚®±           verSionS BETWEeN TImEstAmp  XMLcast  ‚®± as iNterVAl  alL    uNlocK   diStINct "¶ãö"  #  @ UnUSABle    ‚®± AS SaVe         =>  DeFault  AS "©ª°" @ ""         =>  ‚®±       tO  :8  @ :5     +    CHaRAcTer Set ‚®±      AT TImE zoNE ""  distIncT     +   % BULk_Rowcount  ‚®±          ** treAt  ‚®± aS ""       AT LoCaL         AnD *       jOiN    ‚®±   ORDeR bY ‚®± nUlLS FirST     FoR UPdAtE     vErSions BeTWeen TiMEStAMp  *   anD CURSOr  WIth :9  @ bAtCH      "" @ PRiVAte    .  *      As  ‚®±     SelECt ALl renAME      =>  ‚®±    FrOM the  ‚®±   AS :‡≤º0     LEft oUTer  join  ‚®± uSinG  "•†™"  ALl defAuLT        +        START wITh ‚®±  coNNECT BY ‚®±  GROup BY  cuBe   ‚®±                 For UPdaTe of  "†¥ã"  dEfault  "" @ ""           NOWaIT   WiTh REad only  cONStRaiNt :7                  CrOSs JoIN  tAbLE  ‚®±    ParTItiOn By  "" @ "¨Øö"   DIStINct :‡ªä·Çö  @ OuT    =>  dEFAuLT  GrOupIng  @ eDItiOnaBLe          =>  ‚®±       ON ‚®±     GrOUP bY                 HavIng ‚®±    orDer sibliNgS bY ‚®± dEsc                      wITh reAD oNlY           bUlK COlLect IntO :#  @ "ëíØ"    DIStiNCT       USINg   *   LIKE4  XMLaGG  noT existS    WITh "´´í"    "" @ "™ñÅ"    +      aS  wITh :7     "£®´"      +      AS  ‚®±   SEArCH DEPth firsT By ‚®±   seT ""     cyclE ROW   .  SKip     seT "" @ aLLOW      to IntervAl '©™≠' dAy  To Year  0x         deFAULt 4       ‚®±   oRDer bY ‚®± ASC  NUlls fIrsT     foR updATe SKIp lOCKEd      cycLE "" @ #    "ß¥ö" @ :23    =>  defauLT  as :·Ñµ  @ "¨¥í"              +    SET "°ª™" @ "©â§"     tO ''    DEfAult DaTe 'ùòà'       SelecT _   UNIqUe    =>  ‚®± AS bLoCk       fRom "" @ ""    PArtItioN  ‚≤ö   unIQUe DeFauLT        unIqUE        pArtITIOn By  Default  ExtErNaLLy        iNNer joiN  jsON_TaBle  ‚®± ColUMns  "§£ü"   TrUnCatE fORmAt JSon       uNpIVoT IncLude nuLLs  nOsCale  @ ""     foR  ""  ‚®±       +        iN   ""                eXclUdE     joIn   ‚®± PIvOt xMl  "Ôæå" @ ·Çé    DIstinCt :98  @ ""   =>  ‚®± AS "‚Ωæ" @ FOreiGN          =>  DeFaulT    fOr "" @ "üÄ™"       +     in  ‚®±             partItiON BY  DefaULT        usIng  ""   +      pivOt  :6   =>  ‚®± buLK  @ DaTA       fOr :8  @ :93    uNIqUE ‚®±         iN  seLEcT dEfAULT  OBJeCT  @ ""       BUlk COllecT INto :24         FROm  XmltaBLe  XmlNAmeSpaceS  DeFaUlT ''     Ôºå $.5  paSsING "‚ä¶" @ TiMezoNe_regIoN    all    =>  ‚®±       uNpivoT   :#  @ lIBrARy     +       fOr  "£ì∫"  .  *        In  ÔøÑ    +    AS  nq'[†≠Å]'                 CrOSs JOIn   ‚®±   aS OF sCN  "ÃÖ" @ ""      =>  dEFAULT  aS ""       piVot Xml  ‚®± AS "" @ ""      FoR  "·îù"   distIncT "" @ ""   dIstINcT ‚®±      =>  deFaULT        +        In  ANy            parTitIOn bY  DEFAuLt  :26  @ CuRrENt_usEr         NatUraL iNneR Join  ‚®±   UNpivOt exCLude NULLs  soME   BUilTIN   =>  ‚®± :#           fOr :·æï  @ deBUG       .  :49  @ "¶ãã"      In   "Í•ã"   defaUlt        +                 pIVoT  "‚¨•" @ "û≤≠"      =>  dEFauLt    FoR "" @ meMoPTimIZE    .  *     IN  ‚®±        as Of periOD FOR secOnD       aLL ‚®± AS ""         +   BeTWEeN     ""    paRtItIoN bY  ‚®±     LeFT  jOIN  :2    saMPle bLoCk  ‚®±   sEEd  ‚®±       UsING  BuIlTiN  @ "·§¥"   aLL "¢ºß"  =>  ‚®± "" @ #          .  *   +      pIVot XMl  "•Åë" @ "¢¶™"   =>  DefauLt    FOr  ""  ALL    .  ExIt         iN  ‚®±          WHere ‚®±  COnnect By nocYCLe ‚®±    WItH check optIOn             GroUp bY  ‚®±         hAViNG ‚®±    FoR UPDATE oF  _  @ nOKEEP    UniQUe     :12  @ ErRorS    =>  DefAuLt  aS :7  @ ""          +    nOwAIt   OrDeR By ‚®± aSC        ORdEr siblings bY ‚®± nULlS LasT     with reAD ONlY                        "" @ scn         nOt  In    cURRENT oF  ""  deFAUlt             "Æáí"                 ReTuRniNG INto "ßêÖ" @ ""   dIStincT     ""  =>  Not CUrRENT Of  :9  @ STAtisTIcS                +       