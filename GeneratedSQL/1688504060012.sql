AlTeR TyPe "ЁзАб" @ rEAD  @ ""    add map meMbEr FUnCtIOn '' ( dEFaULT   , nOT "ЁЯЗп" ( UNIquE "ЁижЗ" @ :7    =>  nOt cuRreNT oF  CYcLe  @ ""  ( DIsTinct я╝Й   ( + )    ANd noT *   Is  nOt  Nan      oR (  ""  =>  *   Is OF ( COmPlETe    я╝М :3   .  "ЁлАВ" @ ""    )      or eXISTs  ( WitH с║Уркб  @ BReadTh  . ""    ( :#6   .  *  я╝И + я╝Й  , "ЁжХН" @ "ЁУВА"  я╝И )     )  AS ( SELect DISTinCt ти▒   frOM "ЁоЛЮ"      , JSOn_TABLe я╝И ти▒ formaT json eRRor ON  EmptY  CoLuMnS ( рд╝   .  "ЁнЙИ" @ "" . RelATIonal     ( TRUE  я╝М tRUE  я╝Й raNGE ти▒ ..  ти▒    TRuNcATE paTH .3e-3f      , DAte    fOr ORDinALITy   )  )  vErSioNS BetweEN tIMEStAmP  eXtRact ( ти▒  , *    , priOR ти▒  AT lOCal      MOD  TREAt я╝И ти▒ AS rEF "Ём╛о" @ :#  . :15      я╝Й  . DATE  @ LoGgING        MULtiSet InTeRsecT diStINCT  я╝И ти▒ я╝Й At TIMe ZoNE ти▒     ** NEw #  я╝И )      mUltiset uNIoN  NEW "ЁйУФ" я╝И UNiQue )     AT tIMe zONe SESsIONtImeZoNe          )  at lOcaL         ANd + Chr я╝И ти▒ USing NcHaR_Cs я╝Й     ** connEct_By_RoOt Trim ( ти▒ )  aT LoCAl      MultisET inTerseCt DISTInCt  ?      ||  ╟М▐О  @ "" @ :4    я╝И ти▒ , ти▒  )   я╝И + )  kEeP я╝И DEnSE_rANK LasT oRDER siblINGS by ти▒ DesC  NULls LAST   я╝М ти▒ nulLS lasT     я╝Й           uNpivot excLUDE NuLLS я╝И NOkEEp  @ "" . "ЁаБЬ"  я╝И aLL ти▒  )   .  "ЁйУй"  я╝И + я╝Й   FOR :1   ( uNIQUe я╝Й   я╝И + я╝Й    in я╝И "" @ "ЁЫКд"  ( ти▒  )   я╝И + )   as ( dATE ''   )     я╝Й   я╝Й      NatURal joIN  XMlTABLE ( xMlNamESPacEs я╝И dEfault TiMESTAMp ''''   я╝Й  я╝М INTerval '' SecoNd ( n''   я╝М 'ЁогЗ'   я╝Й     paSsiNG BY vaLue ти▒ , ти▒    я╝Й  PIvOt XMl я╝И ти▒  FoR я╝И ""  .  "" @ KeEP_duplIcAteS  @ ""  ( aLL )    , SCN  @ "" @ "Ёб┤в"  я╝И )   я╝И diSTiNCt ти▒  )     )    In я╝И Any   я╝М ти▒   я╝Й   )    as OF SCn  ти▒      pArtITiOn By я╝И ти▒ я╝М ти▒  )  leFt OuTer  jOIN  я╝И ти▒ PivOT ( ти▒  FOr я╝И :25  ( ти▒ я╝М ти▒  я╝Й   .  *   , "" @ eACh      )    IN ( WIth "" @ ""   .  RoWCOUnt    AS ( ти▒ я╝Й  sEaRCh brEAdth First by ти▒ ASc   , ти▒   SEt :39  @ noLoGGiNg    .  ""     CYcLe PrEServE  @ :с╣К      set "" @ "ЁЭР╡" . :53      TO q'(ЁнЖй)'    DeFAUlt $.6      я╝И ти▒ я╝Й  FOr UpdAtE oF  shArD   .  "Ёв╕╢" я╝И ти▒ я╝М ти▒  я╝Й   ( + )  , "ъТ┐" @ WorK  . :#_       orDer by ти▒ nuLlS LAST   , ти▒ desC  Nulls firsT      )   я╝Й     я╝Й     uNpiVoT INCLude nulls ( я╝И :36  ( DiStIncT ти▒ , ти▒  )   я╝И uniqUE я╝Й   я╝И + я╝Й  , zOne  @ "ЁиеМ"  ( я╝Й   ( UniQuE я╝Й   я╝И + я╝Й   я╝Й   For "ЁзжК"  я╝И + )    IN ( "" я╝И )   .  *     я╝М я╝И :т▓Ш3  @ :1  . _╟о    ( uNIque ти▒ , ти▒  я╝Й    я╝М "ЁЦ║Ф" я╝И ти▒ , ти▒  я╝Й   я╝И + )   )   As IntErvAL '''' sECONd       )   )        UnIon alL  я╝И selEct ти▒   into DeCRyPT  @ ExisTS   я╝И )      froM я╝И ти▒ я╝Й  uNPivoT ( я╝И :1   ( + )   )   For NeXT  @ "ЁзЪМ"  ( alL я╝Й   ( + )    IN ( я╝И ""  я╝И + )  я╝М "" @ CoAlesce   ( unIQUE ти▒  я╝Й     )    я╝М я╝И paraLlEl_enABle   .  *    я╝Й    )   )      PARTiTion bY ( ти▒  я╝Й    я╝М taBLE ( ти▒ я╝Й  :я│▒1     paRTITion BY я╝И ти▒ я╝М ти▒  )   Pivot xML ( ти▒  FOr "сН╢" @ "ЁдКЖ"   я╝И + я╝Й    In ( ти▒ )   )      wHEre ти▒  START WITh ти▒  coNnect By NoCYClE ти▒    Order by ти▒  я╝М ти▒ dESc  NUlls LaST      я╝Й  WITH cHeCk opTIoN  ConsTRaInT New_NAMEs      я╝Й   я╝М ""   as ( SELECT ти▒ я╝М ти▒   bULk cOllEct InTo ""   я╝М :1  @ "ЁмЗС" @ ""  ( ти▒ , ти▒  )   ( diStiNct ти▒  я╝Й   ( + я╝Й    FrOM xmLtaBlE ( 0x3   COlUMns ти▒ FoR oRdINaLITy  я╝М ти▒ FOr oRdINalItY   я╝Й  VERSioNs pEriod FoR "" @ insTeaD  . #р┐Ъ   ( я╝Й   я╝И + )  beTween  *   AnD *        UnpivoT eXCLudE nUllS я╝И ( leaDINg     я╝Й   foR я╝И "" ( ти▒  я╝Й   ( + )  , :1  @ :_9   я╝И ти▒ я╝М ти▒  )     )    in я╝И aGGRegate   ( dIStinct я╝Й   я╝И + )    я╝Й   )      conneCT BY nOCyClE ти▒  grOuP By я╝И ( я╝Й    я╝М cUBE я╝И ти▒   )    )   я╝М ( ти▒   я╝Й        OrDeR sIbLiNgS bY ти▒  я╝М ти▒ ASc     fOr upDaTe NoWait   WiTh Check Option    )  cYcle "сД╢" @ "ЁозД" . ""   .  "ЁкХИ" @ #уГА   ( All )    , "Ёл╢Б" ( я╝Й   я╝И + )   SEt "ъй╕" @ mErge    .  :70     To 0x    DEfaUlt Date 'ЁдЙЭ'       ( WitH TRusTED  @ "ЁлЛа"   .  :╨е    ( "ЁлЭЧ" @ "" . :╓н    ( DISTInCt )     )  As я╝И witH "ЁЧЯС" @ "ЁЭЩЛ"   .  "т░╢"   ( qUery   .  *   , CoMpleTE  @ :80   ( ти▒ , ти▒  я╝Й   ( + )   )  as я╝И ти▒ я╝Й  SEarCH dEpTH FiRSt BY ти▒  я╝М ти▒ desC  nULLs FIRsT    set :5   .  "ЁмЦ┤" @ ""       я╝М natURAl  @ "ЁмнВ"   .  "Ёл╣Г" @ :83  . "сге"    ( mAXvaluE  @ OvER  @ :7    .  *    я╝Й  As я╝И ти▒ я╝Й  cycle "" @ BItmAP  @ "рвг"   я╝И + )   seT _   .  ▄┐сЙй     to U'ЁФЦД'    dEFAULt 3.1E7D       SeLect ти▒ , ти▒   fRoM tABle ( ти▒ я╝Й   PARTiTIOn BY ( ти▒ я╝М ти▒  я╝Й  Cross JoiN  tHe ( ти▒ )  "сзи" @ "сКР"         wHErE ти▒  coNnecT by ти▒  stART WitH ти▒  HAVInG ти▒  gRoup bY я╝И grOuPInG SetS ( ( я╝Й    )    )        INtERSecT  я╝И ти▒ )  oRder by ти▒  , ти▒ asc  nULls last     fOr uPdaTe Of  :#р╝в  я╝И ти▒ , ти▒  )   я╝И )    я╝М lIbrAry  @ HAsh   я╝И AlL ти▒ я╝М ти▒  я╝Й   .  "" @ "" . "ЁРЕЖ"  ( AlL ти▒  )     skIp LOCkEd    я╝Й  SeARcH dePTH FirST BY ти▒ nUllS Last   я╝М ти▒   seT :╙Ъ  @ ""       , "ЁФШЙ"   as ( SeLEcT uNIque ти▒   Bulk COlLECT IntO "" ( diStinCT )   ( + )  , aUThEntIcATioN   я╝И + )    FrOm JSoN_TABle ( ти▒ , cOmPAct  @ :1    .  "ЁвЭ╗"    ErRor On  error  COLuMns ( :3    ExIstS ERrOr on  eRROr    я╝Й  )  VErSiONs pEriod FOr "" ( ти▒ , ти▒  я╝Й   ( distINCT )   ( + )  ти▒  ( ти▒ я╝Й AT TIme zonE DBtIMEzoNe     ** xmLcaST я╝И ти▒ as NatiOnAL cHAracTeR VaRyIng ( DIsTINCT ти▒  я╝Й  cOllate new      % tYpE    я╝Й  At TiME zOne EXtRAct я╝И tIMEzone_reGiON FrOm DATe  ти▒  я╝Й        /  VaLUe   .  *   AT lOCal     ** PRiOr "" @ :3  @ SCOpe    ( )    OVer я╝И partiTiON By ти▒ , ти▒   )           and *       PARTitIon by ( ти▒  я╝Й  JOin  я╝И ти▒ )  As "" @ ""     PaRTiTIOn bY ( ти▒  )  cROss jOIN  я╝И ти▒  я╝Й uNPiVot InCluDE nUlLs я╝И "Ёл│о" @ CoUNt  @ :62    ( я╝Й   ( + )   fOr #9  я╝И diStinCt ти▒ я╝М ти▒  я╝Й   я╝И AlL ти▒  я╝Й   я╝И + )    IN ( ( "ЁЯЕд" @ "ЁзЙС" . ""  ( ALl )   .  cONSTRAINts  @ "ЁЧ╗м" @ "т╛к"     )   AS TRuE      я╝Й   )          , я╝И ти▒ я╝Й  As Of SCn  ти▒ я╝М ти▒       PIVOT ( ти▒  fOr "ЁвФП" я╝И я╝Й      in я╝И ти▒ )   я╝Й      sTarT wIth ти▒  cONneCT By ти▒  GrOuP By я╝И GROUPiNg SEtS ( RoLLuP ( ( ти▒ я╝Й    )    я╝М ( ти▒ я╝Й    )    , я╝И ( ти▒ )   я╝М я╝И )    )   )   я╝М GrOuPing SETs я╝И ти▒    я╝Й       hAVIng ти▒    union  я╝И ти▒ )  wITH reaD onLY    )    ( sELEct diStINCT ти▒ я╝М ти▒   INtO seSsiON   .  :р╛Й  ( ти▒  )   я╝И + я╝Й    FROm :1  @ json_tabLE    .  ""   SuBpARtITIon ( "уЕЙ" @ ""   .  ""  я╝И + )  я╝Й   PaRTITION bY ( ти▒  )  crOss jOiN  сЕЧ_    sAMPLE я╝И ти▒ )   pivot xml ( ти▒  FOr я╝И "" я╝И diStINCT ти▒  )    я╝М nChR  @ "ЁаЮУ" . #янк    ( я╝Й   я╝И + я╝Й   я╝Й    in я╝И я╝И ти▒  я╝Й   As "сТЭ" @ :с╣е  @ ""     я╝Й   я╝Й    aS oF PErIoD For "" @ FINAL  . "ЁСв╝"  ( )   .  *   beTWeEn      PArtItion BY я╝И ти▒ я╝М ти▒  )      WHeRE ти▒  stART WIth ти▒  coNnECT bY nOcycLe ти▒  grOUp By я╝И )         uniOn ALl  ( ти▒ я╝Й  wIth chEcK optiON  cOnstRAINt ComPact  @ :1  @ :6   ( alL ти▒ , ти▒  я╝Й      )  FOR UPdAtE   )  UnioN  ( WitH "ЁмР╝" @ SavE    .  ""   AS я╝И wItH cHaRacTEr  @ "" @ :26     as ( ти▒ я╝Й  seArCh dEpth FIrSt BY ти▒ AsC   , ти▒ DeSc  nULLS fiRsT    SET _┌╝   .  :57        ( ти▒ )  Minus  SELEct diStINct ти▒ я╝М ти▒   inTO "Ёз╗Щ"  я╝И uNiQUE )   я╝И + я╝Й  я╝М ForMaT  @ noNEDitiOnablE  @ FrEElISt   ( ти▒  я╝Й   ( + я╝Й    FRoM JsON_tAbLe я╝И ти▒ , "Ёгго" @ "" @ "ЁеЦЛ"   .  ╪Т0  @ "Ёз░г"     erroR On  eRror  COLUmns ( "" @ :#5    .  eXTERNALLY    ForMat jSOn   я╝Й  )  AS caChe      uNpiVOT я╝И returNInG  я╝И я╝Й     FoR ( "═│" @ :31  . rEjecT    .  "" @ "ЁвЭ┐" @ "ЁЫЗЫ"   я╝И + я╝Й  я╝М #5  @ :4      я╝Й    IN я╝И fIlesysTEm_LIke_LoGgInG     aS я╝И ''   )     я╝М я╝И рл║р╝Я  я╝И UniquE )   я╝И + )   )    )   я╝Й     я╝М "ЁШЪ▓"  .  "ЁЧ╣д"   saMpLe BlocK я╝И ти▒ )  Seed я╝И ти▒ я╝Й    As OF PeRiOD For "" @ ""  я╝И ти▒ я╝М ти▒  )   я╝И ти▒  )   я╝И + )  ти▒    pivOt ( ти▒  FOR ORDInAlItY  ( uniQUe )   .  *     IN ( ( ти▒  я╝Й   inneR  @ "Ёл╖Г" @ :р╣М      я╝М Any   )   )      paRTitiON by ( ти▒  )  INnER JoIN  JSON_TAbLE ( ти▒ fOrMaT JSon , TimestAMP ''    coLUMNs я╝И neSTED PaTH ""  .  :6  @ "" @ ""     coLumNS ( "Ёлб╝"   foR OrDInaLiTy   я╝Й    я╝М INitIAlLy  @ ""   .  "ЁЯУЗ" @ :97     exIsTs paTh ""  .  hAsh  @ "╘╣"     FALsE On  emPtY    я╝Й  )    UsIng я╝И "Ён║О"  .  "ЁЧа╕"   я╝М :#9  @ StAtEMENT  @ ""  ( ти▒ , ти▒  )   ( aLl ти▒ я╝М ти▒  я╝Й   я╝И + )  )     Where ти▒  HavIng ти▒    FoR uPdatE oF  :_я╝Л  @ THAn    .  *    sKiP LoCKEd    я╝Й  seARCh DePTH fIRst BY ти▒ nUlls laST    sET "ЁйТж" @ "Ёен▓"      cyCle "ЁШЧЩ" @ :97   ( DistINCT я╝Й     Set "Ём╢Д"    to 1   DeFAuLt TImEStaMP ''      , EXECUTe    я╝И :72   ( DISTiNCT ти▒  я╝Й   ( + )   )  as я╝И SeLect ти▒   fRom XmltabLe я╝И xmlNAMesPacEs ( ти▒ я╝М ти▒  dEfAUlT InteRVaL '''' monTh я╝И 'Ёг┐ж'   я╝Й   To MoNtH    я╝Й  я╝М datE ''   PassIng ти▒ я╝М ти▒   cOlumnS ти▒ Long я╝И я╝Й     patH N''    я╝М ти▒ "ЁЧРЩ" ( unIQUe )   я╝И + )   dEfaUlT ти▒   )  aS Exit     ParTItion bY ( ти▒ я╝М ти▒  )  nAturAl JOIN  JSoN_TaBle ( ти▒ ErrOR On  ErRoR  COlumns ( "ЁеМв" @ ""    eRrOr on  EMPtY    я╝Й  я╝Й  PiVOt я╝И ти▒ я╝М ти▒  foR ╓О╨▒  @ :7  @ QuoTA   ( я╝Й   я╝И all ти▒ , ти▒  )      In ( ти▒ я╝Й   )    veRsIoNS bEtwEeN tiMEsTamP  *   And ( ти▒ )  at lOCAl     ** TRansLAtE ( ти▒ usiNG CHaR_cs )  aT tImE ZoNe SESsiOntImezOnE      /  TRansLATe ( ти▒ uSIng nCHaR_cS я╝Й  At timE zOne SeSsiOntiMEZONE    MUlTisEt inTeRsecT  ?              uNPivOt ( ( "" @ :_6  @ SCHema    ( я╝Й   ( + я╝Й  я╝М "тСг"    я╝Й   for ( :96  я╝И DisTinCt ти▒ , ти▒  я╝Й   .  "" @ "ЁУАЛ"  я╝И я╝Й   ( + )  я╝М sYNoNym   .  я┐д  @ "сжб" @ "ЁЧзк"  я╝И ти▒  я╝Й   я╝И + )   )    iN я╝И joIN  я╝И DISTINcT )     aS ( Q'тАатАа'   я╝Й     я╝Й   я╝Й      havING ти▒    ordeR sIBlINGS BY ти▒ desC  nulLS FIrsT     wiTH REad only    я╝Й    sElECT All ти▒ , ти▒   BuLK CollEct iNtO "" @ HIGh  @ "ъХР"   я╝И unIque ти▒ , ти▒  )      FrOM the я╝И wIth cOmpuTe  @ :71     я╝И "" @ "" . #5   ( ти▒  я╝Й   .  *  я╝И + )  я╝М :78     )  As ( ти▒ я╝Й  SearcH dEptH FiRsT by ти▒ ASC    set "" @ noSCaLe       cycle "ЁегЫ"  я╝И + )   seT BiNary   .  :24  @ DUpLiCATED      to dAte ''    DEfAUlt ''       sELECT ти▒   buLK cOllecT INTO "Ёж╜У"  я╝И я╝Й      fRom ( xmlTablE ( .7D    я╝Й   PaRtItiON bY ( ти▒  )  iNNeR Join  ти▒ on ти▒   UnPiVOt EXcLUDE NUlLS я╝И ( :_  @ "" . "ЁЧЫУ"  ( AlL ти▒ я╝М ти▒  я╝Й   я╝И я╝Й    я╝М "ЁйзС" @ "" . "тбН"   я╝И + )   )   for :с╣╢уДз   .  *     In я╝И я╝И "Ём▓З" @ :6  . PArALleL   я╝И DISTINCt ти▒ , ти▒  )   .  INDICATor  ( ти▒ , ти▒  я╝Й   я╝И + )  я╝М "" @ "" @ zONe    ( )   ( + я╝Й   я╝Й    )   я╝Й     я╝Й pIvoT xMl я╝И ти▒  FOR я╝И ржмсБЩ  ( uNIQuE )   .  *   , "ЁжеИ" @ self      )    iN ( ANy   я╝Й   я╝Й      pARtitIOn By я╝И ти▒  я╝Й    , ( я╝И ти▒ )  AS Of PerioD fOR :1  я╝И uNiQue ти▒  )   я╝И )   ( + )  BetWeEN    unPiVot INclude NUllS я╝И :5   .  rolLuP  @ "ЁТЖо"  ( All ти▒ я╝М ти▒  )   я╝И + я╝Й   foR ( "" @ :с║й   я╝И UNIqUE ти▒  )     я╝Й    IN ( сБЗ   ( )      , ( "тЫ╗" @ "рйЩ"   я╝И ти▒  я╝Й   ( + )   )   As fALSE      я╝Й   )       PIVoT ( ти▒ я╝М ти▒  for "" ( dIsTInct ти▒  я╝Й      iN ( aNY   я╝Й   я╝Й     ) uNPiVot я╝И я╝И SUbmuLtISet  я╝И )    , "" ( All )   я╝И + )   я╝Й   FOR "" @ :80  @ "ЁоПб"   .  *  ( + я╝Й    iN ( SubparTITIon  я╝И я╝Й   я╝И + )   As ( 0  , FALse   )     я╝М pEriOD  @ doUBle  @ cOnsTraINTS    я╝И DiSTiNCt ти▒ , ти▒  )      )   )    verSIons bEtwEEN TIMeSTAMP  "Ёгк░"  .  _  @ ""  я╝И ти▒  я╝Й    % rOWcOuNT   MultISeT eXCEPT  XMlAGG ( ти▒ order siblinGs By ти▒ NuLLS FIRST     я╝Й  aT lOCAL         And Cast ( multiseT я╝И ти▒ я╝Й  As TiMEStAMp я╝И UnIque я╝Й   wITh я╝И dISTINct ти▒ , ти▒  я╝Й   TiMe  zOnE    )   MuLTIset exCePT DisTInCt  "" @ _  @ :2   ( UnIqUE )   я╝И + я╝Й  wiThIN gRoUp ( OrdER by ти▒ asC     я╝Й   at LOCAL     ** DEcodE я╝И ти▒ )  at TImE zonE DBtimezONE       +  xMLQUerY ( *   paSsinG BY VAlue deCodE я╝И ти▒ )     MOd  0x     ** cOlumn_ValUE   ( ти▒  )   ( + )  ovER я╝И parTitIOn by ти▒ я╝М ти▒   OrDeR sIBlINGs BY ти▒    rowS ти▒  fOLloWInG    я╝Й   AT tIme ZONe DBtiMeZoNE       +  SYs_ConNECt_bY_PATH я╝И )   aT lOCaL    mUlTiset UnioN  я╝И ти▒ я╝Й  aT LocaL          я╝М *   As ""     reTurNING cOntenT я╝Й            AS "Ёй╛д"    RiGHT  jOiN  "" @ ""   .  :45    ""    PartiTIon bY я╝И ти▒  я╝Й  JOin  ти▒ usInG я╝И "" @ "уГЫ"   .  *  ( + я╝Й  )   On ти▒     COnNect bY ти▒  havING ти▒  grouP by я╝И ( ( ти▒ )   я╝М roLlUP ( ти▒   )    )   , я╝И я╝И ти▒ )   я╝Й   я╝Й   , cube я╝И ти▒   я╝Й         wITh CHeck optIoN  COnStRAint eDITioN  @ ""  ( ти▒ , ти▒  )      )   NaTurAl Join  TRANslatE  @ :43  @ ""   .  leFt  @ :р╝К  @ #     SUBParTitioN ( coMPOUND  @ "ЁгЮЖ"  ( DiStInct )   я╝И alL ти▒ , ти▒  )    )  SaMple bLOck я╝И ти▒ я╝Й  SEed ( ти▒ я╝Й    "ЁзЗР"    PaRTItIoN by ( ти▒  я╝Й    piVot я╝И ти▒  FOr ( "ЁлХ╢"  .  *  я╝И + я╝Й   я╝Й    in я╝И я╝И ти▒ я╝Й  MinUS  я╝И ти▒ я╝Й  fOr UPdATE nOWait   orDeR By ти▒ deSc  NuLls fIrsT      )   )      wheRe ти▒  StaRt WitH ти▒  conNECt By NOCycle ти▒     я╝Й  FOr UpdatE OF  "" @ "ЁШЬ╢"  я╝И )      ORdEr SiBlIngS By ти▒ nUllS fiRsT      )    AnD *   not MEmBer OF - u'ржХ'     mulTISEt INteRsECt ALl  cHR ( ти▒ usINg NCHar_cS я╝Й  aT tiMe Zone seSSioNTiMEZoNe     ** CUrSOR я╝И wITH :4  @ XMlTaBle  . ""   .  "уБл"   as ( wITh ""  .  LEvElS    aS я╝И я╝И ти▒ )  Order BY ти▒ nUllS firsT   я╝М ти▒    For UPdAte WAIT 0X4     wITh read ONLY    )  cyCle :4     Set "ЁоЖ┐" @ "ЁбЮД" . FiPsFLaG    .  _  @ GROUpIng      to false    dEFAult ''      я╝М :я╣Х0  @ "р▓Ш"   .  "" @ ElemENt     as ( selECT ти▒ , ти▒   iNtO "ЁШам"  я╝И + я╝Й    FRoM The ( ти▒ я╝Й  uNpiVOt ExClUDe NULLs я╝И я╝И rEsULt  @ "ЁШСЦ"   я╝И ти▒ , ти▒  я╝Й   я╝И + )  , :40  ( UnIqUe я╝Й   .  *    )   FOr я╝И "ЁЧвб" @ "" . ""  я╝И )     )    iN ( :85  @ DeferrabLE      AS ( DatE ''   я╝Й     я╝М ( "" ( ALl ти▒  я╝Й     )   As $.3     )   я╝Й    versioNs PErioD fOr "ЁЧЫС" я╝И aLL )   ( + я╝Й  ти▒  cASE when ти▒ tHEN ти▒   eNd   muLtISET uniOn DiSTincT  "ЁлЭм" @ :сКи   ( ти▒  )   я╝И diStInct )   ( + )  % Bulk_EXCeptIoNS ( ти▒ )  . erRor_cODE   aT LOcAL         anD *        PiVOT Xml ( ти▒  fOr :т╖Х  @ "ЁЧбЛ"   .  *  я╝И + я╝Й    iN ( ти▒   , any   )   я╝Й      WHERE ти▒  conNEcT By ти▒  sTaRt wItH ти▒  gROUp By ти▒        FOR upDAtE waiT Q'??'     wITH reaD oNly  COnSTrAINt NATioNAL      я╝Й  CyCle :8  @ :9    ( ти▒  я╝Й   ( + )   SEt ""    TO UQ'&&'    DeFAuLT 0      я╝И sELeCt uNiQUE ти▒ , ти▒   fROM tAbLe я╝И ти▒ я╝Й  As oF TImEStAMP  ти▒    PIvOt xMl ( ти▒ я╝М ти▒  foR "" @ Logoff  . #    .  GLobaLLY  ( uNique ти▒ , ти▒  )      iN я╝И ти▒ )   я╝Й      naTural LEft Outer  jOIN  XMlTABLe ( 8f    )   pArtITiOn BY я╝И ти▒  )  fULl  JOIn  ( ти▒  ) VERSIONs pErIOd fOr "" @ "" @ "ЁбЪХ"  я╝И aLL я╝Й   .  "ЁйНК" ( ALl )   ( + )  ти▒  *   And nUll    ** triM я╝И ти▒ from  ти▒ я╝Й  aT TImE zoNe ти▒           UNPivOT ExclUdE nUlLs ( ( ""  ( ти▒  я╝Й    , INnER  @ zoNE    я╝И + я╝Й   я╝Й   For :9  @ SEt   я╝И dIStiNCT )   я╝И ти▒  я╝Й      IN ( "ЁТУН"     , я╝И :_  я╝И я╝Й   ( + я╝Й   )   as TiMesTAMp ''''      я╝Й   я╝Й      CroSs JOiN  ти▒  USing ( :уБД  @ "ЁдЦС"   я╝И + я╝Й  я╝М "ЁмаФ" @ "" @ "ЁТУд"  я╝И ти▒ , ти▒  я╝Й    )     я╝М ( ти▒ я╝Й  #╞╛     pArtiTiOn bY я╝И ти▒ я╝М ти▒  )  INNEr JoiN  ( XMlTabLE ( XMLNaMESpAcES ( ти▒  )  я╝М INteRVAL 'ЁжГЬ' monTh    PASSiNg bY vAluE ти▒ я╝М ти▒   CoLUmns ти▒ ref "ЁгЗЕ"  я╝И + )   CHarActER seT ти▒     я╝М ти▒ FOR ordINalITY   )  aS of pERIoD FoR MEDiUm  я╝И AlL ти▒ я╝М ти▒  я╝Й    BETWEeN      innEr Join  ти▒ ON ти▒   Pivot я╝И ти▒ я╝М ти▒  FOR ( "" @ elEmENT   ( )   .  :9    , "" @ ""  ( ти▒  )   я╝И + )   я╝Й    IN я╝И я╝И ти▒  )    я╝М any   я╝Й   я╝Й     я╝Й  pARTiTIOn bY ( ти▒ , ти▒  я╝Й      groUP BY ( grOupINg SEts ( я╝И )   , я╝И ти▒ я╝Й    )    )      haVINg ти▒    inteRSect  ( ти▒ я╝Й  WIth REad ONLy    я╝Й  oRDEr bY ти▒ DeSC     foR UPDATE of  seTS   .  *    SKiP lOcKeD    )  SeaRcH dEpTh fIRst by ти▒ aSc  NUlLS FirsT    set ""      , "" @ :6    .  lEfT  @ "ЁЫКВ" @ new_nameS     я╝И "" @ :7      )  aS я╝И select ти▒ я╝М ти▒   InTo :р▓Ъ9  ( unIquE )   ( + я╝Й    fRoM JSON_tABLe ( ти▒ foRMAt json CoLUMNS я╝И UNBoUnDed   .  "ЁУРУ" @ "" @ "р╝Э"    fOR ordinAliTY   я╝Й  я╝Й  UnpiVoT iNCLUDe NUlls я╝И WItHiN  я╝И dIstiNCt я╝Й   ( ти▒  )   ( + я╝Й   fOr "ЁзЦд" @ "ЁдМ╝"      In ( ( "" @ :31  . rElAtIoNal     , NaTIOnaL  я╝И All ти▒ я╝М ти▒  я╝Й   ( + )   )   AS ( inTErvaL '' MoNtH ( TimEstaMP ''   , FalSE   )   tO MoNtH я╝И timesTAMP 'Ёе░▒'   я╝М .5E7F   я╝Й     я╝М 0x   я╝Й     , ( #  я╝И )   ( + я╝Й  , "" ( )   .  :74  @ ""     )    я╝Й   )       PIvot Xml ( ти▒ я╝М ти▒  for STARTuP  @ сЮ┤6  @ ""   ( + я╝Й    in я╝И WitH :т╛н    ( "Ёап╝" @ "" . roW   я╝И DISTInCT ти▒ я╝М ти▒  я╝Й   я╝И distiNcT я╝Й    я╝М reLY  я╝И ти▒  я╝Й   .  *  ( + )   )  aS ( ти▒ )  sEArCh DeptH firST By ти▒  я╝М ти▒   SeT :7  @ #с╕║         SELECT aLl ти▒   FROm ( ти▒ )  uNPiVOt iNCluDe NULLS ( ( "свЖ" @ OpAquE  @ ""   ( UNique )     я╝Й   fOR ""     In ( я╝И "" ( ти▒  я╝Й   я╝И + я╝Й   я╝Й    я╝М :53   ( + )    )   )      ParTItION bY ( ти▒  )  nAturAL INNER jOiN  lockING  @ "╧и" @ pOlYmorPhic        piVOt xml ( ти▒ я╝М ти▒  FoR я╝И "" @ :_    .  "" @ "ЁиДУ" . noNscHeMa    я╝И + )   )    IN ( ти▒  ""    я╝М ти▒  As :59  @ ""     )   )     я╝М я╝И XMLTabLe я╝И XMLNameSPacEs ( )  я╝М uQ'@@'   paSsing ти▒ я╝М ти▒   cOLUmnS ти▒ FOR ORdINality  я╝М ти▒ inTervaL я╝И diSTInct ти▒ я╝М ти▒  )   PRecEDING  ( я╝Й    to я╝И ти▒  я╝Й   :7  @ BegiNniNG  . "Ёж┐а"      PATH InTERVal '' seconD  To MInute я╝И ''   я╝Й     DEfaulT ти▒   я╝Й  As oF ScN  ти▒ , ти▒      PArtItiON by ( ти▒  я╝Й  CROsS joIN  TablE ( ти▒ я╝Й      я╝Й  ParTItIOn BY ( ти▒ я╝М ти▒  )  RIGht  joiN  ( ти▒ )  VersIOns betwEeN TimeSTamP  *   and cOnnECT_By_roOt ти▒  At tiME zoNe ти▒    mulTISeT exCEPt  TrEat ( ти▒ as ""  .  _     )      MOD  Nchr ( ти▒ )  at lOcAl    MultISET iNTErSECT  + ти▒   ** ?  AT locAL    MUlTiSeT ExcePT All  xmlAgG я╝И ти▒ )  at LoCAL       ||  nuLl   MultIsET INtErsECt dIsTInct  cuRsOr ( ти▒ )  At TiMe zONe dBTimEZONE     ** TrEat ( ти▒ As "" @ "Ёк╝О" . TRUe      )  . "ЁаФ╜" @ :роЩ  @ "ЁбЕ║"  я╝И dIStiNCT я╝Й   .  *  я╝И + )            UnPiVoT я╝И я╝И keeP  @ "ЁЧСи" . :11    ( dIsTinCt ти▒  )    я╝М decODe  я╝И )   ( + )   )   fOr "" ( UNique я╝Й      in ( "ЁнбГ" @ :9  @ "ЁЧЫ╕"   я╝И ти▒ , ти▒  )     as я╝И N''''   я╝М 0  )     я╝М я╝И "ЁбФ╗" ( diSTINCt ти▒ я╝М ти▒  я╝Й   .  ScaLe   я╝И + )   )    я╝Й   я╝Й     AS ""     On ти▒   unPIvOt inClUDe NULlS ( ( :т╝Ы  @ :т╝Л3  @ "Ёж░Г"  я╝И )   ( + )   )   FOR "" @ "ЁбКЬ"  я╝И ти▒  )   я╝И + )    in я╝И DaTA  ( unIqUe )   ( )   ( + )   AS 0X      я╝М я╝И "ЁаР▒" @ _т╗п  . :5     я╝М rEAdS   .  :6   я╝И + )   )   AS ( DATe ''''   , FAlsE   )     )   я╝Й      WHEre ти▒  cOnneCt BY ти▒  StArt with ти▒    OrdER bY ти▒ ASC   , ти▒ dEsc  nulLS FiRsT     wItH ChEcK opTion  cOnSTrAINT "" @ "ЁЧАн" . ""  я╝И DIStinct ти▒ я╝М ти▒  я╝Й      я╝Й   я╝Й     я╝М pReBuiLt   .  "" @ lOGOff  @ :37     parTItIoN ( :_   ( я╝Й    я╝Й  PivOT я╝И ти▒ я╝М ти▒  fOr ( "" @ FoReIGN   ( aLL ти▒ я╝М ти▒  я╝Й   ( я╝Й     я╝Й    iN ( ANY   , AnY   )   я╝Й    aS of peRIod for "ЁЧЯИ" @ ""  ( DisTinCT я╝Й   .  *   BetWEeN      paRTitION by я╝И ти▒ , ти▒  )  JOin  Json_TABLe я╝И ти▒ FOrmAT JsoN ERrOr ON  emPtY  CoLuMNs ( NEsted Path 3E8D    ColuMns ( "тОБ" @ ""    dOUBle pRECISion  RAnge ти▒ ..  ти▒    tRUnCAte FOrmaT jSon witHOUt arrAY wRAPpER  PatH TImesTAMp ''''    ErRor ON  eMpTy    я╝Й    , jOin   .  EnForCEd    OPaQue fIXed я╝И All ти▒ , ти▒  я╝Й  UsInG LIBRAry PROceDure    ти▒ , ти▒  я╝Й    ;   trUncAtE FOrMaT JSon NulL ON  EMPTy    )  )   pARTItiOn BY ( ти▒ я╝М ти▒  я╝Й   uSiNg  ""  .  *  я╝И + я╝Й  я╝М :3   )    я╝Й     STArT wItH ти▒  CoNNECT by ти▒    unioN   wITh "" @ DECrYpT    .  ""    ─Н  @ ""    я╝М :1   ти▒ , ти▒  )   .  "" @ "ЁдбЩ" @ :#    unIque ти▒      +      aS  ти▒   cYclE "" @ "ЁЧМп" . ""    + )  , #╤╗  @ stRiNg    ти▒      +    sEt DemAND  @ р╕Кс╜▒  @ "ЁдИ░"   .  "" @ LiKe4  @ "Ёж▒к"     to INTeRVAl '' SeCoNd     DEfAuLT dAte 'ЁРКМ'      я╝М RefeRENCinG  @ "р░З"    aS  ти▒   search bReADTh firSt By ти▒  , ти▒ DESc  nuLLs Last    sEt :15   .  ""     CYClE ""   +    seT :7   .  "" @ SETTingS  . at      tO q'/ЁжЮд/'    DEFaUlT n''       seLEcT UniqUE ти▒   BULk COllEcT into сВЩ  @ ""    AlL       FRoM  TAbLe  ти▒   as "" @ ""         ParTItioN BY  ти▒ , ти▒      я╝М  ти▒   unPIvoT ExclUdE NULls  "Ём╜б" @ :26         +    For :96   uNique    .  "ЁвШТ"  All ти▒ , ти▒        IN  "" @ "" @ olD    ти▒ , ти▒      DIsTincT       я╝М  :48   DistINCT     +   я╝М "" @ "" . ""                  joIN  JsON_tABLe  ти▒ Null ON  empty  coLUmns  keep   .  RePLaCE    REF cOnDiTIonal   .  *   +     exIStS PAtH :#2  @ #    .  ""    TRUe on  EMptY    , "я╣Ъ" @ AFter  @ :95     EXIstS FALSe on  EmPty        VeRSIOns betWeEn TIMesTamp  *   aNd pRIOr ти▒  aT LoCAL     ** eXtraCt  ти▒  , ти▒       *  :_   uNIQUe ти▒ я╝М ти▒     .  "тпЧ" @ :ркЬ$     +       +  CAsE ти▒ WheN ти▒ THEn ти▒  ElSE ти▒   enD  at TiME zoNe dBtimeZoNe    mulTiSet INTERSECT  xmLqueRY  ти▒ PASSiNG ти▒  я╝М ти▒ AS "ЁлмД" @ "ЁбЭ╕"    ти▒ , ти▒      +     rEtuRNing CONtEnT             uSAgE     cross JoIn  thE  ти▒    partItiON BY  ти▒    crOss joiN  ти▒   on ти▒   PIvot XML  ти▒ , ти▒  fOR  bINary  @ EDItions    ти▒ , ти▒      , "ЁкММ"        in  ти▒          HavInG ти▒  grOuP By ти▒        UNiOn aLl   ти▒      FOR UPdaTE  WITh rEaD onlY      CyClE ""   +    SeT "" @ "Ёж╜░" @ DIsassocIaTe    .  :44  @ ""     TO ''    dEfAUlT tRuE       sElECT ти▒ , ти▒   INTo рж░  @ ""       +   , NOCAcHE   dISTIncT    .  *     frOm ""  .  :2  @ KeEp  . "ЁжЬЫ"    sAMPlE  ти▒   sEed  ти▒         WhERE ти▒  STArT with ти▒  cOnnEcT by NOcycle ти▒  Group by   cuBe   ти▒ , ти▒         ,  ти▒               INtErSect  select ти▒ я╝М ти▒   buLK COllECT iNTO _#         FRom  WITh "ЁвЬС"   As   ти▒   MInuS  SELecT DisTIncT ти▒   inTo "ЁбАа" @ oiD    All ти▒      +     fRoM xMltAblE  XmLnAmespAces    , 6.1D       paRtItION BY  ти▒     pIVOT  ти▒  For "Ёи▓н"   +     in  ти▒          wHeRE ти▒  haVing ти▒    FOR UpDAtE OF  :8    UnIque     , "" @ ContainEr  . ""   ти▒       skIP lOCKed   ORDer SIBlIngs By ти▒ aSC   , ти▒ NUlLS LAsT     WITH READ ONLY       , StoragE  @ ""     :6  @ ""    +   я╝М :сЬй   DIStInct     ти▒      +      as   ти▒   uNioN   ти▒      sEarCh BrEADtH first By ти▒ ASc  nuLLs lASt   я╝М ти▒   sEt ""       SeLEct UNiQuE ти▒ , ти▒   fRoM JSON_tAble  ти▒ , 3.4E+8   cOLumNS  nestED uq'тАбтАб'    colUmNs  TruncatE  @ :37  @ роит│л    .  SUBmulTiSeT    FOrmAT json WitHOUT WraPPeR  paTH "Ёв╣и"  .  "" @ WaIT            я╝М hIGH   .  "" @ "" @ :8     tRUNcaTe DefaUlt .1f   ON  eMpTY        vErSIoNS BETWeeN tIMEStamP  *   AnD Cast  ти▒ As iNTervaL  all ти▒ , ти▒     сВ╕  @ "Ёж╜Щ"      .  *   to  "" @ :_      cHarAcTEr seT ти▒ % cHARSeT           ||  CurSor  witH "Ёби┤" @ WraPPED    .  LEFT  @ :6  @ "ЁлЯТ"    aS  ти▒   seaRCh breaDth firsT By ти▒ ASC    SEt ""  .  dupLicaTEd      cYcLe :19    +   , "" @ "ЁзЩР" @ ""   UniqUe     ти▒ я╝М ти▒       sET :_  @ "сЖК"   .  sUSpEND     tO N''''    DeFaULT ''      , "с╢╛"    "" @ COnStRaInTS  @ :1         +      aS  ти▒   sEARch breadth firSt by ти▒  , ти▒ desc  NullS fIRSt    Set "" @ frEelIStS  . ""   .  OPaQuE  @ "" . ъТЭсЮ▒          ти▒   UnIon aLL   ти▒   wIth cHeCk OptIoN  cOnSTrAiNT :90        aT timE ZOnE seSsIONtIMEzoNe     ** "ЁвнЛ"  ти▒ я╝М ти▒     .  purge   all ти▒ я╝М ти▒      % NOTfOUND  AT tIME ZoNe ти▒    MuLTISEt UNiON  DECoDe  ти▒      Mod  "" @ :94  @ LesS    uNiqUe    .  "ЁзНз"   % FounD   MULtiseT UNIoN DIstINct  - ти▒ at LOCAL     ** nULl  aT tiME zone ти▒    mUlTIsET UNiOn DiSTiNCt  SYS_cONnect_by_pAtH  ти▒     aT LOCal            as "Ёджб"    PArtitION bY  ти▒     unPIVOt iNcLuDe nuLlS  TImEsTaMP  @ "ЁкЙР"   distInct      For  #сМн  @ "ЁлДз"    ти▒ , ти▒      +        In   ""   all     я╝М "ЁШЪ│"  AlL ти▒ я╝М ти▒      +       AS 0X              , Table  wITh exCLuDE  @ :#8  @ FLaSh_caChE    .  ""   AS  ти▒    , "си╕"  .  "" @ :#      cOmpOUNd  @ "Ёд╣▒" . ""   .  *      As  ти▒   SeaRcH BreADth FiRSt By ти▒ aSc   я╝М ти▒ NULls lAsT    SET я░╗  @ "ЁРЗХ" @ ""      cyCLe aGEnt  @ OVeRfLOw       .  "" @ ""    +   , "уД╜"  disTInct ти▒          +    sET :2   .  "Ён╕╖"    to datE 'уКМ'    DefAult TIMEStAmp ''''       seLEct ти▒   BuLK ColLECT inTo :3    +     from the  ти▒    rIGHt oUTER  JoiN  ти▒ USing  ROW  @ :с╜Б6     +   , ""  DiSTINCt    .  *        CoNNEct By NOcYcLe ти▒    uNIOn  SeleCt ти▒   From  ти▒   uNPiVoT  "Ёкаг" @ ""         fOR  ddL   UnIQue ти▒      +        iN   :9  @ :11     ти▒      я╝М "тПН"        я╝М  OnLINE  @ nOrEly    ALl    .  "ЁлЗ╣"  ти▒ я╝М ти▒      +   я╝М ""  AlL         AS  daTe ''   , falsE               AS oF SCn  ти▒ , ти▒      pArTiTIon by  ти▒ я╝М ти▒    NatURAL LEft OuteR  JOiN  ти▒  PIVOT  ти▒  FOR "" @ ""   .  *   +     IN  ти▒         , xMLTABle  U''   pAssing ти▒   ColuMNs ти▒ DOubLE PrecISIon  ти▒ я╝М ти▒       , ти▒ intERval  :69    ти▒ , ти▒      +   to  :с╣Ю  @ _  . ""   .  dBTimezOne   ALl      % ROwTypE    pATH InterVal '' dAy  0x      to second    dEFaUlt ти▒     AS of TIMEsTAmp  ти▒      naTural iNNer JOIN  ти▒    sTarT WiTH ти▒  COnnect by NoCYClE ти▒    fOr UpdaTE  ordeR bY ти▒ nuLlS LasT        UNPIVOT  "ЁвСЬ"      dIstiNCt ти▒      +    FoR gLoBalLY  @ ReLy    uniQUe ти▒     .  "" @ ""      in   :4  @ "ЁаАГ" . сЗШ4    .  *               VERSions periOD FOR "" @ "ЁЦ╝╝" @ ""    aLL     ти▒  *   And TrIM  ти▒    MultISEt iNteRSect  XMlcaSt  mUlTiSet   ти▒   iNtErsect   ти▒      aS TIme   CHaRActeR sET ти▒        ** caSt  ти▒ As OPAque FIXEd  ти▒ я╝М ти▒    using LibRarY puRGE      .  *   +   ;         -  $4.8  aT timE Zone DbtimEZone      MoD  + ти▒ AT LocAl    MuLtIsEt InTerseCt ALL  XMLcasT  mULtisEt  WITh UNLiMiTEd  @ :87  @ :74     as  ти▒     SElEct ALl ти▒   bULk ColleCT INTO ""  ти▒     .  coaLESCe  @ "Ёаб╣"    +   я╝М "ЁбНо" @ N3     all ти▒        froM ""  .  :#  @ ""    sAMPLE bLOck  ти▒    "ЁС╢е"    ParTitIOn BY  ти▒    InNeR joIN  ти▒  PIvOT xml  ти▒ , ти▒  For  "Ёквп"  uNiQuE     ALl ти▒ , ти▒      +        IN  AnY           я╝М  ти▒  vERsIonS PERIOD FOr ""     .  *   +   ти▒  ти▒ AnD ти▒   PivoT Xml  ти▒ , ти▒  FOR ""            in   ти▒                unPIvot exclUDE NullS  OrdInAlIty   DIStINcT     +    for  KEeP_DuPLICATEs  @ :_  . nAmE    .  PERCenTILe_disc  @ "я▒Ы"    +   , ""        in   :95  @ с╛Х     я╝М ""  UnIQUe ти▒          As InTErvAl 'Ёв▓У' HouR  tO HOUr                hAVInG ти▒    ordER sIBlIngS By ти▒ nUlls laSt   я╝М ти▒       aS ReF USage  @ "" @ ""   uniQUE ти▒ , ти▒      ти▒ я╝М ти▒      +    % RowtypE                paRtITIoN bY  ти▒       wHEre ти▒  coNNECT by ти▒  starT WITh ти▒  HAviNg ти▒  Group By  CUBE  ти▒  ,  ти▒                 miNUS  SEleCt All ти▒   FRoM jsON_tabLe  ти▒ fOrmAT jsON я╝М :59  @ cLOb    .  NoKeep     CoLumNS  :66  @ "ЁвФЙ" @ ""   .  "ЁекЛ" @ saMPlE  . _сДМ     PaTh ""  .  "р╜л"    ERrOr on  EMpty        aS :57  @ INtErFaCe      rIghT OuTER  JoIn  xmLTablE  U''       NATuRAl iNnER JoiN  ти▒     wHERe ти▒  StArt wITH ти▒  CONNECT by NoCYCLe ти▒  GROup By ти▒   я╝М         HavInG ти▒    ORdER sibLingS by ти▒ DeSc  nULls FiRSt   я╝М ти▒ aSc     FoR uPdatE of  :_           , :42  @ ""    +     with cHecK oPTION  coNstrAint ""        ParTitiOn By  ти▒     pIVot  ти▒  fOr :6  @ reADS    UnIque ти▒      UnIQUE ти▒ я╝М ти▒        in   wITH bREadTH   .  "" @ "ЁкМП"     ""     .  *   +      AS  ти▒   cYCLe sTatiC  @ "" . "Ёжм▓"    , :р║░5   .  *   +    sEt NocoPy     To 0X    defAuLT tIMeSTamp ''       seLEcT ти▒   intO "" @ :#сиЙ    ти▒      all     +   я╝М ""      UNIQUe ти▒        FRom   ти▒  AS Of PErioD fOR "Ёггг" @ "Ён╛Э"    +   betWeEN    UnpIVOT exclUDE nuLls   "Ёб║Р" @ "ЁШЕд"   .  *       FOr "ЁаЯШ"  aLL ти▒ я╝М ти▒     .  Byte  @ ScAlE  @ ▌Зя▒Ф       iN   vAluE      .  :92   ти▒      +   я╝М "" @ "ЁллЩ"    all          ,  buIlTin  @ "Ёз╛П" . ""    disTINct ти▒ , ти▒      +   , ""  ти▒      +                "█Щ" @ :16  . _сЮП      PartiTiOn bY  ти▒    crOss JOIn  "ЁеЮ╛" @ "" @ DePTh    .  :3    UnPivoT INCLUDe NUlLS  ""  DIsTiNct      fOR TReAT  @ :я▓Ф#     +     in   "Ёз╕Ф"          aS uq'\Ёдо╝\'               Join  ти▒ oN ти▒    UNPiVot  ReLieS_ON    +    for roW  @ "ЁиНВ"   .  *     In  "ЁгЬа"  ти▒ я╝М ти▒      uNiqUE     +    as  FALSE   я╝М ''                  paRTiTIoN bY  ти▒      , jSOn_TAblE  ти▒ forMaT jSON я╝М 3.e+8F    COLumNs  sYNonYM   .  "Ём┤Ъ" @ :_     foR OrdINaLiTy       VERSIONS betWeEn TImEStAMP  *   aNd rEFEREncEs  @ "" @ ""   uniqUE    .  с╜Г8  @ :68     kEEP  denSE_ranK LAsT oRDer SIblinGS By ти▒       at lOCAl       -  ""   % bUlk_RowCOuNt  ти▒      muLtIsET uNiOn  exTraCT  TiMeZone_hOuR frOm ти▒      ** xMLQuEry  ти▒ pASsing ти▒   ReTUrnIng CONteNt    AT TIme zONE sesSiONtimeZoNe    mULtIsEt UNioN dISTINCt  xmLaGg  ти▒   aT TIme ZOne seSSiONtImEzoNe             NATUral InneR JoIN   ти▒   PIvOt xml  ти▒  FOr  :2  @ righT    unIQUE ти▒ я╝М ти▒      +   я╝М "Ёваб" @ :рдл0  . :7     +        In  ти▒          PArtiTioN by  ти▒ я╝М ти▒      UNpiVoT   "ЁоМФ"  ти▒ я╝М ти▒      я╝М "ЁСЛШ" @ "ЁУЙТ"   .  *       FOr  ONlY  @ "ЁбЛл" . "ЁбКЖ"   ALl         +        in  ""  ти▒      ALl      aS  Q'*тЯД*'        я╝М  anAlYZE    +   , "" @ "" . "тмП"   .  purge  @ :#я░А  @ OPaque                   HaViNg ти▒    inteRSeCt   ти▒      oRdER BY ти▒ aSc  nULLS fiRst     WIth REad ONLy             WHERe ти▒  cOnnECt bY ти▒  gRoUP By        ,  ти▒ , ти▒          , GrouPIng seTs   ти▒ , ти▒    , RoLlup   ти▒ я╝М ти▒                   FoR Update OF  ""  ALL     +   я╝М ┘в   ти▒      +    wAiT InTerVAL '' yeaR  DatE ''''                MOd   ти▒   MULTIsEt EXcepT aLl  NuLL  At LocaL                aS "ЁжЬЩ" @ :8  @ SaMplE      , DEfaulT      noT  iN   ""  ти▒    =>  DefaulT  ""              , exTRAcT   =>  nOt EXIStS    SElect "" @ :4  . nologgING    =>  DeFauLT  LoGon  @ "" @ "т╕Г"     я╝М DEFAuLT     Into prEserVE  @ :33     я╝М "ЁдЙМ"  DisTInCT         +     FRom :#    sUBpArTitioN  _  @ "ЁЧШ▓" @ "ЁмЩЫ"    +      PARTiTIoN BY  SHuTDown  @ :49    ти▒    =>  DECOdE  ти▒ , ти▒    mUltIsET intErSeCt  "ЁидИ"  all ти▒     oveR  OrDER By ти▒ nUlls FiRsT   я╝М ти▒ DeSC  nUlLs lAst          ** XmlAGG  ти▒ ORdER siBLINgs by ти▒      At time zone ""  .  *   AT Local       MultisET InterSEcT DIsTInCt  _я│Щ  @ coLLaTion    .  "ЁЯЧЛ"  ти▒     kEEP  dEnSE_raNk lAST oRdeR By ти▒ Asc   я╝М ти▒ nUlLs lAst       over         -  cASe ти▒ whEn ти▒ tHEn ти▒   ENd  At lOCAl     ** TRaNsLatE  ти▒ usIng nChaR_Cs      /  NEw ""  ALL ти▒    .  :7  @ "Ёвмж"       +    aT LocAl         > =  *        As EMpTY        iNNeR jOiN  tHE  WitH "ЁТЕО" @ ""   .  "" @ oveRRiDING     As  ти▒   cyCLe "ЁеКЛ"    set :69     to 0Xb    DeFaULt 6e2D        ти▒   for UpdAtE SKIp LOCKed   witH CHECk optIOn  cOnstRaINT geNeRAtEd  @ ""   ALl         pivOt  NoT EXtrAct  ти▒  я╝М *      AT tIMe ZONe DBTimeZone         iS NOt EMpTY          FOR _  @ "ЁжЯо"      In    AlWayS   UnIquE ти▒     =>  dEFauLT  :48        > =   SELeCT dIsTINcT ти▒    bUlK COllEcT inTo "Ёз╝Ж"   +     frOM xmlTaBLE  9  COlUmnS ти▒ fOr ORDiNALiTy         whERe ти▒  COnNecT by ти▒  StaRT WiTH ти▒  GRouP BY CUBE  ти▒          HaVing ти▒    OrdEr sIBLinGS BY ти▒ DESc     wiTH check opTiOn  ConsTraiNT "Ёб╝╛" @ :27                as arrAy  @ ""            as oF Scn  NoT CURRent Of  oBJECT  @ RoWid    ти▒     +             aS "ЁЯГШ" @ :р╕Р      CrOSs JOin   ти▒   pIvOT  "тП╗"  AlL    =>  dEfaULt  AS ""     fOr  :ре╖т╛л            IN  WItH "ЁзоЛ" @ "ЁоЙ┐"     "" @ "ЁлПЖ"       as  ти▒   SeARCh BrEADtH First By not EXistS   ти▒        NUlLs fiRSt    set ╧░9        selEct ALl DEFAULT  "ЁзДо" @ NoROWDePeNDENcies        from ти▒   sTArt WIth  NChr  @ :4    =>  DefauLT      OVERLaps  ти▒ :#╬д                connEct By nOcYCle *   BetWeEN  DECodE  ти▒         AND  SyS_conNEct_BY_pATh       ** ""  aLL liMIT  @ ""   =>  ти▒ ""         +   wiThIN GROUp  oRDER siBliNgs BY ти▒ asC       ovEr                               UsinG  :92   NoT *   is  NulL                 unPIvoT incLudE NuLLS  "" @ heAp    ALl     +    FOR "" @ ""   .  *   +     IN  "ъЩ╢" @ "ЁеДЮ"    DeFAUlt  AS PREceDINg  @ :50           +              WhEre NOt *   nOT  in  *          ConneCT By cUrReNt oF  :97   .  *           OrdeR bY noT xmlCasT  mulTIsEt  seLect distiNCt CompounD   UNiqUE    =>  DEfAUlt     inTO ""   ти▒ as SESsiOn          +     FroM xmLtaBle  TRUE   PaSsINg bY vALUE defAULT        "" @ :я▓╡9      joIN  json_TaBle  ти▒ CoLumns  NeSted PATh uq'{}'    COLUmNs  VAlUe  @ ""    _   uniQue     +   RanGe ти▒ ..  ти▒    FoRmAt JSon pAth ""              PiVOt xmL  PACkaGE   ти▒    =>  DeFAUlT    fOr  "ЁЦва" @ ""         In   sEed  @ :82    uniquE    =>  ти▒               я╢К     PARTiTIon By  ти▒ "" @ ""        cRoss JOin   ти▒    PARTITIOn BY  "" @ ""   =>  DeFauLT      NaTuraL JOIn  ти▒   oN ти▒   PivoT  dEfauLT  AS "ЁбЭТ"     fOR ""   unIqUe       in  ти▒          sTaRT wIth ти▒  coNnECt BY ти▒    fOr UPDAtE Of  daTA  @ :╨Р    "ЁЧкУ" ти▒  =>  ти▒ AS ""         diStiNCT ти▒ As :20  @ ReaDs            Skip lOckED   ORDER by ти▒ DEsc        As reF metadATa  @ "ЁШНЩ"   .  :13    +       At tiMe ZONE ?       ** eXTRACt  hoUR FROM DATE  ти▒    At tiMe zonE SeSSIoNTiMEzone         liKeC  trIm  TRaIliNG ти▒ From  ти▒   AT tiMe zONE dBTImEzOnE         EsCAPe ти▒       nULlS lAST     FOr uPDaTe  wITh ChecK opTION      orDER SIblIngs BY cURRent of  "Ёг╜Ш" @ ""       ALL "ЁиГп" ти▒  =>  dEFAuLT  _╚У                  With ReAd oNly                 +   WiTHIn GrouP  orDEr SiBLInGs by Not exIstS    With ""    TrAnsActiOn    +      AS  WItH :_#  @ "ЁзбС"    as  ти▒   SeARch bREaDth fIrSt By xMlQUeRy  *   paSsINg By VALUE *   AS "Ёи▒д" @ DatabaSe        +     reTurNiNg CONTenT    AT locAL     ** XMlcASt  ти▒ As sTrING cOLLaTe ""              iS of tYpE  oNLY "ЁдЩ╝"           NULLS LASt    Set :2  @ UnUsABLE         selecT freepOoLS  @ уЗА#       =>  deFAulT  "" @ "Ёг╗Е"       BulK cOLlect iNtO "ЁЯЯГ"  .  ъТ╝  @ wrIte       FROM :6  @ taBleS     SAmPle   ти▒     oveRlAps  dEFaUlT                 ParTITiOn by  "" @ bInARY    =>  DefauLT      jOIn  XMlTABLE  XmLNamesPACES  ""  =>  NOt  ти▒   At lOcAl     ** "ЁгРУ" @ "ЁгЧ║"   TREAT  @ "ЁЯУЭ"   distincT    =>  dEFaULT        +   % BuLk_rowCOUNt  ти▒     At loCaL         IS  INFinITE        "" @ :39       deFaUlT .5E+1    , TIMeSTamp ''''   COlUMns CuRRenT of  :9   ALL ти▒ aS "ЁдДЖ" @ dENSE_rANK           ти▒            FoR orDiNalitY     as of PeRiOd For ""  .  :#т▓о  @ "тШЕ"    BETweEN    uNPivoT   _        fOR ""  aLL     *        WRApPEr          +     IN   "" @ ""    ALl     +       aS ''                   gRoup by  GrouPiNg SEtS                 HavInG NoT :96  @ VarChar    ALl     % nOtFounD        nOt  bEtweeN  *   anD  ""  REPLAcE  @ ""   =>  defAULT       .  *   +   wITHiN grOUp  oRDER SiblIngS By ти▒ aSc                      FOR UpdaTE nOwAIt   wiTh check OptION  cONstRaInt ReFRESH   UnIquE            wITh "ЁиЩЧ"    "ЁмОк" @ :#        +      As  ти▒   seaRCh bReAdtH firsT by NoT -  ти▒  At tIme zoNe DBTIMeZoNE      ** CuRsoR  ти▒   At lOCal         not  LIKe4  *        NUlLs fIrsT    sEt :11  @ "ЁлнЧ"      CyCLE noExTeNd    All invaLiDATe  @ :ркг    =>  noT  :55   ти▒    =>  DefAult  As nOPARalLeL        OVeRlAps  DEfaULt             _6  @ "ЁеЦп"           SEt ""    tO 2e-4   deFauLt n''        ти▒   FoR upDaTe skIp lOCkED         orDer siBlingS BY EXiSts   SELeCT ти▒    fRom Json_taBlE  ти▒ ColUmNS  "ЁаИЦ" @ рм▓рмЙ      tRUe  , tRuE   CHaracteR seT ти▒ % chARseT     eXiSTS       VerSiOnS PeRIOD fOR "Ёг╗│" @ "ЁЧЩ▒"    BetwEen  nULlS      .  *   KeeP  DenSe_Rank firsT ordeR bY ти▒ ASc       OVer  PaRTITiON BY ти▒ AS unusEd       OrdER By ти▒ NUlLs fIRsT     RaNGe CuRrENT roW       at TImE ZONE DbtimezoNE     ** "ЁамС"   +   % buLK_excEpTIOns . Count         AND *       FulL  JoIn   tabLE  SelecT All "ЁЭЮЙ"  unique DeFAUlT       =>  ти▒ :9  @ :4        bUlk cOlLEct iNtO "" @ "ЁЧ│й"   .  FrEepoolS   distInCT     +     from ти▒   wHerE ти▒  HAvING ти▒  gRoup By  ти▒           foR updATE Of  "ЁШЯе" @ :╤Й    :92  @ SHUtdOwN    =>  DefauLt  aS "ЁШЦФ"         eRrORs   uNiquE    =>  DeFaULt         wAiT ''     orDEr SIbliNgS bY ти▒ DESc        "сБЩ" @ "ЁнЗБ"     paRTITIOn BY  deFaulT  As ""        pivOT xmL  ти▒   FoR  :52  @ "ЁгЪй"    aLL "ЁгНС" @ ""   =>  ти▒ "ЁЧб╛" @ ExcEpT                IN  AnY              on ти▒     sTARt WiTh ти▒  cOnnECt bY nOCYcLe ти▒  groUp BY  CuBE   ти▒               HaViNG ти▒    orDeR By ти▒    foR updAte OF  :5   ALl "т╢м" @ ""      =>  deFauLt       .  *    skIP LoCkED   wiTh ReAD onLY           desC  nullS laSt     FOr upDATe of  "Ён╕Ь" @ BuLK_EXCeptIOnS     +             nuLLS laST       OVEr  PartItIon by not current of  leVeLS    DefaULt  aS ╤Ъ  @ :р╢д                        ** "" @ ""   UNIQUe ""     =>  DEFaulT        +              _           subMuLTiseT   nOCoPY  OpaQUE FixeD    uSiNG LibRARY ""  .  moniToRINg   disTINct      RANgE ExISTs   With :2     bOdY  @ SEeD    all nOT - SyS_ConnECt_By_path  aLL    AT locAl          In    "ЁжХа" @ "▐В"   =>    sElecT ти▒    BuLk cOllECT INtO :54    +     fRoM  ти▒   aS oF period For "ЁпжЛ" @ ""   MaP  @ :#    =>  DEfAUlt  "ЁСиВ"             +   ти▒    unpiVoT iNCLUdE nullS   "ЁбЫ╣"  unIquE     +       FOr ""     .  PERCenTiLE_DiSc  @ ""      In   :#2   all deFauLt        deFaULT        +       As  timesTamp 'ЁкНС'                 CrOss joIn  XMlTABLe  XmlNAMEsPACEs  :2  @ ACcOuNt    =>  dEFAult  :рйМ╚М      dEFAUlt fAlse     , uQ'.ЁЧЭИ.'   PASSINg by ValUe ""     =>  ти▒ "" @ sCOpe            partiTiOn BY  "" @ LoGoFF    UNIQUe ти▒    =>  ти▒     JOin  tABlE  ти▒    pARtITIon By  :57   =>  ти▒ as dEnse_rANK  @ ""           unPIvot Include nuLls   "ЁмйЦ" @ "ЁФШи"    UniQue         For ""  dEfAuLt       .  *     in   :7  @ "Ёк▒п"      .  *   +                 coNNeCT by NOCYCLE ти▒  sTarT wItH ти▒    wiTH REad ONly  CoNStRaint ""          AT TIME ZONE SESsIoNtImEzONe         noT  lIke4  *        AS "тДБ"                  +      aS  WiTH т╜╛9  @ MappINg     as  with ""   aS  ти▒   cYCLe :_  @ "ЁкЙТ"     seT TIMEzONE_mInUTe  @ "ЁЭШС"     To DAte ''''    default U''''        ти▒   OrdeR bY Not *        dESC        CYcle ""   ALL      SeT "ЁбСУ"    TO iNterval '' hOuR  1.f   я╝М TIMESTaMp ''         dEFAULt 0d       SeLeCt UnIQUE   "Ёи╕╜" @ :3    уБмт┐Н  @ ERRoRs    dISTINCT ти▒     =>  *   >  *        aS suPplemENTAl  @ DECrYPt          =>  dEfaUlt  "ЁЦгй" @ ""        nOT  in   DEfauLT               inTO "тЦР" @ :2    EditIons   =>  NoT EXisTS    ти▒   FOR uPdatE NoWaIT   order sIbLINgS By not cONNecT_By_root CASt  ти▒ As _╙А  @ ""   UniQue    .  *   +      aT loCaL           bETwEEN  PRioR - nchR  ти▒   at tiME zOnE ти▒        ** tRAnslAtE  ти▒ UsIng CHAR_cs         aNd  "ЁРШ╣"  .  :сМ╡    +   oVer  OrDeR by ти▒ ASc  nuLls LASt        aT loCal     ** + XmlaGG  ти▒ orDEr SibLInGS BY ти▒ NUllS LaSt       at TimE ZOnE nEw "" @ "Ёе▒г"   diSTiNct ти▒ As PiPeLined          defaULt        +    aT TIme ZonE dBTimEZOnE                  dESc     wITH read OnlY           ""         UnIQUe       fROM JSON_taBlE   *   is nOt Of  "ЁЦг╕" @ :2                 oVErLaps  DEfAULt  SPLiT               FORmAt jsoN я╝М 0X    COLuMns  :41    lONg   CHARActEr Set nOt *   in   WItH mEMBer  @ #$      ""   loGofF  @ "ЁТЖа"   =>  defaUlT           as  ти▒   SeArcH dePTH fIRST by cuRRENT of  "Ёз░Д" @ :78    DIStiNcT    .  :25            dEsC    seT "" @ "сГА"        SEleCt ""  unIQue    =>  NOt eXiSTs   ти▒        aS "ЁдЩ╜"      frOM  ти▒   piVoT xmL  New_nAMeS   DefAuLT  As NoEXtENd  @ "Ёв║В"         =>  TRiM  ти▒ FrOm  ти▒   aT TimE zOne consTraINtS  @ ""    +   KEEp  deNSE_rAnk fIrSt ORDEr SiBLingS By ти▒ NULlS FIRst       OVEr              IS NOt Of tYPe  ONly "╘п" @ IDEntIfier               For #   .  *   +     IN  ти▒         as рдЮ╬║  @ :#      parTiTIon bY  "" @ :5    =>  dEFAUlt         WhERe *   IS a set         CONnEct By nocycle nOT   ти▒ aS exCepT        <     GenERaTed  @ ""   ALl    =>  dEFAuLT                 StARt WitH NOt eXtRaCt  MInUTE FrOm ти▒          NoT  BETween  ExtRaCt  "рав"  =>  ти▒   я╝М *    я╝М *        ** caSE ELSE ти▒   end  AT LocAl         AND  ?  aT lOCal     ** tREat  ти▒ As REF :93                    HavInG nOT CuRrENt of  "" @ PARAMEterS    DisTinCT           GrouP by   *   ~ =  Some   ти▒                     WItH CHECk opTiOn              exiSts       vERSIonS bEtweeN TimEstAMp  ''''   At tIMe ZoNe SesSiontiMEzonE         AND CONnEcT_BY_RoOt NEw ""   +    AT loCal       ** :19     DefAuLt  "" @ "ЁЯАС"        In    ти▒   FoR uPdate oF  noExTeND  @ "ЁТЗм"    DeFaULt  AS ""           With cHeCK OpTIon  ConSTrAiNt :сЕ╕              "" @ reduCed           +   % nOtfOUND  aT LOcAL           UnpiVOT ExcLUDe Nulls  "тЮЖ" @ ─Э    aLL      FOR  :4  @ "ЁзЖб"    REtEnTioN   Not *   IS oF tyPe  OnlY "ЁдСР" @ "ЁоЬК"                 =>  deFauLt  As :_               IN  "ЁФСз" @ uSABLe                PArtiTioN BY  "" @ ""   AlL    =>  NOt CURrEnT OF  rePlacE       +            inneR JoIN  pASSwoRD  @ :1     VersiOns beTweEn sCn  *   And  eXISTS   witH ""   As  ти▒   cYCLe "" @ "ЁиЫЖ"    +    SET inNEr     TO U''    DefaUlT dAte ''        ти▒                        piVot  NOT cUrrEnT OF  ""  unIqUE :90   =>  dEFAUlT       .  "" @ "ЁмБМ"   ShARD   all    =>  *   is  nan        "ЁЭН▓" @ ReLy           +        уГ╗  @ :#       for  :67  @ :86          in  SELEcT aLl "ЁбДР" @ ""   =>  not *           FroM  XmLTABle  XmlnAMEspAcES  DefAulT  as "ЁзЗД"     DEfAuLT IntERvaL 'Ём╣╝' mINUTE  To yeAR  falsE   , $.1         , 'Ёй╢Р'   pASSINg By vALUe exClUDE  @ ""   All COALeScE   =>  deFAulT       =>  curSOR  ти▒   at TiMe zOnE dBTiMEZoNe         =  Any     DeFAUlt               AS :3       coLUmNs not Exists   ти▒        fOr ORdINALiTy         pIvOT  DEFAUlT    FOR  "ЁЧз│"      +        IN   currEnT oF  "ЁЯГп" @ "ЁйРи"   .  ""  DiStiNcT     +        ""        as :#  @ eDITIon             VerSioNS PeRIOD For bLOck   diSTiNCt "╦Ц" @ aNYScHEMA    =>  EXiStS   ти▒        as "Ёй▓╕" @ "Ёг╢Д"          noT *   < =  treat   ╬е   =>  ти▒     oVeRLaps  dEfAULt             as :9  @ CALL           **  ти▒               *   aNd FoRCe   "" @ "сУЦ"      =>  noT EXtRact  minUTE fROm DAte    DefaUlT  AS :4        =   deFAult               AT LoCAl         NoT  iN  *         ""         % rowCOunt    ** CURSoR  ти▒   At tIME zoNE seSSIoNtImezONE             naTurAl FULL  joIN  jSOn_tAbLe  nULL    ** "ЁазТ" @ "ЁжЛЧ"   .  *   +   oVER  partiTion By DeFauLt     OrDer sibLINgs BY noT *   like4  :_  @ iNsTAncE     "ЁЯМЛ"     =>  ти▒ "ЁЭйЦ" @ :╨║т╛Д           +   OVer  orDER siBLiNgs by ти▒    raNgE BeTweeN uNBouNDED PReCedING  aND UNboUndED PrecEDing       At lOcal         escaPE ти▒       dESc  nULlS fiRST        AT TIme zONE Q':сЬд:'            NOT suBmulTISeT OF *          cOLuMnS  nesTeD SEgMEnT     ColuMnS  "" @ "ЁЯЬ╜"    doUbLe PReCISion  DISTincT   ParTIAl   =>  DEFaulT  eACh        in   ти▒              % Type    path .3d              As "" @ :66      pArtItioN by  nOT cUrRENt of  :1  @ ""   .  *              UNPIvOT exclUdE NULLS  ""       For #_   unIQUE "Ёакб" @ KEEP    =>  DEfault  с╜и  @ tRUe           +     IN  "єаДЬ"  UNIQuE :_    % bulK_ExcepTions  Not *   not  in    raiSe  @ ""   unIqUe    =>  ти▒ aS ""              . ERRor_cOde         nOt  bETwEen  cHR  noT  deFaULt      oVeRLaps  "ЁбЬК"  =>  DEfAulT  "ЁйкР" @ "с╣о"               UsiNg nChAr_CS   at TIME ZoNe sesSiontImezonE     ** + trAnslatE  nOT CURrent OF  :2  @ ""         usiNG CHAR_cS    At LoCal         ANd  *             .  "ЁдУ┤" @ naTionaL    deaLlOcAtE  @ рй╡    =>  DEfAULT        +    As 0xa               wHEre *   lIke4  *         HaVinG not Sys_cOnNeCT_bY_paTh                 gROup by EXists   ти▒               ORdER BY CuRrEnT oF  diSallOw   ALl          NULls fiRst     FOr updAtE Of  "ЁбЕХ" @ :93    uniQue     +    WAIt date ''     WITH ReAd only  cONstRAint "ЁеПИ"              where not chR  NOt nUlL  aT LOCAl     ** NChAR    +   WIThin GROUp  orDer bY ти▒       AT lOCAL         bEtWeen  exTrAct  MINUte froM ти▒          aNd  *        usInG NCHAR_cs     ** eXTRACTVAlue  NoT ExISts   with :58    as  ти▒      ти▒           As _      , *    я╝М "" @ ""   exIsts   WIth :_╓б  @ ""     "Ёк▒И" @ mATERIALiZED     UniQuE REferenCes      =>  DefaulT           As  ти▒   sEArCh DEpTH FirST bY ти▒ desC    set "ЁгЯз" @ "уПС"        SeLEcT ти▒ AS "Ёа▓Й"      InTo SeSsIoN   all "" @ ""   =>  deFauLT            +     FRom thE  ти▒    leFT  jOin  :сЯз    pArtItiON  dEBuG         saMple bLoCK  ти▒   seED  ти▒     UNpIvOT   "Ёд╗В" @ pERCentiLe_DiSc    .  *       FOr  ""   +        In   :72   deFAuLt  ╧Щ5  @ INvaliDatE           DiStiNct :66  @ ""   all    =>  ти▒           aS TIMesTaMp ''             vErsIoNS PErIod foR "" @ PiPe     ти▒  *   ANd SeCUrefILe   unIqUE deFAuLT        +   % buLk_rOWcount  ти▒     AT TiMe Zone dbTiMEZoNe     ** sYs_conNecT_by_PatH  "ЁежТ" @ :─в#       =>  deFAult  aS UNLOCk                    UsinG  :74  @ ""    UniQUe     +      pIVOt  "" @ ""   =>  ти▒ AS "Ёлй╕" @ :7       For #   .  ""     IN  ти▒  AS "уЕл"             CONNeCT bY nOcYCle ти▒    ORder sIBlinGS BY ти▒ DESC  NuLlS lAst                   +   keep  DEnSE_rAnk laSt OrDER by NOt UQ';ЁввЕ;'         Is  NoT  NULl              at TIME ZOne casT  mulTiSEt  WiTh rEsUlt    aS  ти▒   SEArCH DEpTh firSt by  deFaulT      OVErlAps  ти▒ "" @ ""               DEsC    set :37      CYcLE :_р╢╖  @ dEBuG    AlL OptimAL  @ ""      =>  *   noT sUbmuLtiSet Of *                ""  alL    =>  NoT ти▒  ** ти▒      is of  "" @ "тйЦ"            lobS          +    sET "" @ :29      To 0.4e3F    DEfAUlt 9.3       ти▒   ORdER by  ти▒ enfoRceD        oVerLaPs  deFAult             nullS fIRST     WIth read oNly      as tIme  aLl        at lOcAl               At TIme zonE Sys_CONNecT_bY_pATH  ""  =>  defaULT  As :96  @ ямй                   Is  Nan         HavINg nOT New EXteRnaLLY  @ RElIEs_on    All CURrENt oF  ""  .  *              +      ** CoNNecT_bY_RooT ?  aT LoCaL                   FOr upDAtE skip loCKEd   OrDEr sIBlIngS BY nOT EXISTS   SeLecT DIstiNct ""     =>  DEfauLT  "ЁийВ"      frOM "" @ :#     saMPle  noT *   BEtWeEN  TranSLatE  ти▒ uSiNG NChAR_Cs         AND  *           As oF SCn  *   ^ =  - caSe ти▒ elsE ти▒   End  aT TIMe zOnE SESsIOnTiMeZonE               exCEpT          PaRtitIOn bY  "" @ ""   =>  dEFauLT         GROuP BY         HAviNG CURRENT of  :4  @ "ЁзЖШ"    uNique             For uPDAte oF  _с╕м       DistInCt assoCIate   =>  *   MEmbER OF *                +    SKiP lOCKED   witH CheCk oPTioN  cOnstRAInt "уЕд" @ "ЁоЯг"                DEsC  nuLls LasT          sElECt DiSTinCT NOT XmlcASt  MuLTisET  WItH ""    "Ёй▒│" @ :7    .  period   ALL DEfAulT           AS  SeLEcT ""  =>  DEfAUlT  as "ЁиМС" @ CreAtioN        BuLk ColleCT inTo сб│6         FROM xmLTabLe  Q'`ЁУЗХ`'   CoLumNS NOT ExistS   ти▒        dOUble pRECision   patH U''   DEFAUlt   cOmPlETe  @ ""   ти▒      =>  DEfAuLT  "" @ "ЁйХМ"        < >   ти▒              parTiTIOn bY  "" @ NOCachE    =>  cURrENt oF  "Ёи╝Ш"   +        :90  @ ""           stARt WitH EXiSts   ти▒         connecT by nOT + XmLQUeRy  ти▒  ** ти▒      PaSSIng BY ValUe *     rETurning CONTEnt    aT loCAL    AT tIME ZonE dBtIMEZONe               HAviNg *   iS Empty           oRder bY NOt   :7   dIStiNCT DefaULT       =>  DEfAuLt      < =   ти▒ AS :_  @ rEWrITe                  fOr upDAtE SKip lOCkEd      cYcle "" @ ""   .  *    SEt "Ёмк╢"    TO TRUE    Default daTE 'Ёдк▓'        SeleCT dEfAUlt  "" @ :6        INtO AlWaYS   UNiqUE #  @ "Ёл▓Т"   =>  pRior XMLagg  ти▒     at tIME zOnE NUll  AT lOcAl        ** sEsSION  @ :┌Ч2    uNiQuE     +   kEEP  deNse_rANK lasT oRdEr bY ти▒ asC       OveR  paRtiTIOn BY deFAUlt              iN  dEcOdE  ти▒     ** tRiM  ти▒   aT TIME ZonE SeSSioNTiMeZONE               as :1         .  *   +     FROm thE  ти▒   as FilesyStEm_LikE_LoGginG     PARtition By  ""     =>  nOT *   lIke2  PRiOR XmLCasT  ти▒ AS tImeSTaMP  WITh  tIME  DistINcT mOnitOring  @ AtTribuTE    =>  dEfaUlt       zONE      at LocAL     aT TIme zOnE SEssiOnTImezone         EscAPe ти▒       "тХе"        uNPIVot  "" @ "ЁйПи"   DeFAULT         FoR "Ёйгб"     IN  "ЁкЬБ" @ ""       +              wHEre NOT curRENt oF  ""   +         ConnEct bY Nocycle *   ! =  aLl     ти▒ AS :91                  STaRt wItH NoT  lEadINg   =>  ти▒     OverLApS  lOCal  @ :уЕФ    diSTINct ти▒ as "Ёак║" @ :я╢асИФ          =>  DEFAULT  AS uSer  @ "сА╣"                  WITh rEAD only      With CHECK OptIon  ConsTRaiNT :59  @ AuTo         as LONg RaW   with DeDUplICaTE     "" @ "ЁЯПК"           As   ти▒   fOr UpDAtE NowaiT      searcH DEPTH FIRSt BY ти▒ asC  NUlLs firST    SET "" @ :9          SeLecT dEfault  ""      From   ти▒   piVOt XMl  :6   aLL    =>  deFAULT    FOr "ЁЫ░г" @ ""   .  "ЁдЖГ" @ :т┤Ш6    SecuReFilE   all    =>  DeFaULt  debug  @ ""          +     iN  aNY               UNpIvoT excLuDE nuLLs   _        fOR  "ЁеВК"  dIstiNct    .  "Ёк│┐" @ ╘╣8    ""  =>  ти▒ AS ""              in   fIXED    DisTincT                 as oF PErioD fOR SHriNk  @ xML    ти▒      .  *   +   ти▒      CroSS JOIn  xMlTablE  xmLnAmeSpaCES  :40   all    =>  ти▒     я╝М 0xD      As _4  @ ""     PArtITioN bY  defaulT      naTUral INNER jOIn  THe  ти▒    PARtItiON By  "" @ "ф╖┐"   UnIque    =>  ти▒          WHeRE ти▒  ConNEct By ти▒    FOr uPdate oF  "ЁЧ╖Й"   :4  @ ""   =>  dEfAULt  disaSsociaTE  @ ""          +     OrDeR SIBLinGs bY ти▒ NULLs LAST     wITH cHECk OPTION  CoNStrAInT "Ёпв╜" @ cubE    #   =>  ти▒ aS "ЁШйВ"                      iS  NOt  iNfIniTE               Range *   NoT  like4   ти▒  At LOcaL     ** TREAt  ти▒ aS :4  @ rElIEs_on        . "" @ :8                eScapE ти▒       ..  NOT exISts   WItH Medium     _я╜и    +      AS  witH "ЁЧ╡П"   aS  ти▒   SeaRcH bReaDTh fIRSt by ти▒ NUlls LasT    sEt ""     CYcle UsinG   DisTinct      sET "ЁЯОп" @ ""     tO DATE ''''    DefaUlT N'Ёв╕Е'       SelEct DIstiNct dEFAuLT  "ЁзМЕ" @ ""       BUlK cOllECT INto ""     FrOm   ти▒    cROSS joIN   ти▒ unPiVOt EXcLUdE nUllS   "" @ :71     DefAUlT        +       foR iDEnTifier   UNiqUE ти▒       diStInct       In   "ЁгбН" @ ""   .  *   +                 As Of PEriod foR :сжля╜Ю    +   beTWeen        pivoT XMl  DEfAult    fOR "" @ ""   NEW_naMes  @ rEJecT    defAUlT  As с║Я6  @ DecoDE          =>  dEFAUlT  aS :60  @ :сАа          .  freepOols         In  ти▒          VErsioNs beTweEN scN  :4  @ "Ёаий"    +         aNd *     uNpIvot iNcLudE NULlS  "Ёб╛Г" @ "ЁиЗа"    uNiqUe ""  alL    =>  ти▒ PRIVAte          +    foR aGEnT  @ я╣ЫржЮ       .  *   +     In   "ЁШСж"       aS IntERvAL '' YeaR                pArtItIOn bY  ти▒        groUp by                      sEaRCH bREADTH FIrst By ти▒ asC    SET ""         ти▒   For UpdATe  orDEr sibLInGs bY ти▒ AsC     wiTH REad ONlY      FoR UpDATe Of  :15  @ DATabasE     DISTiNCt ""  =>  ти▒        NowAIT   ORDER BY ти▒ DESc  NUlLS fIRSt                    ** ""  :51  @ AfTEr    uNIQue    =>  DEFAUlT  As bulk_eXceptIONs  @ ""          WIThIN gRouP  Order BY nOT CuRReNT OF  :_  @ ""              oVEr  PARtitION bY DEfauLT  ""         AT tImE ZoNe new ""     .  "ЁлЧК" @ EMpty    dISTiNct     +    At loCaL            in    wITh ReF  @ :_     AS  ти▒   SEarCh dEPtH FiRst By ?             nUlLs fIRST    SEt ""     CYcLe :5  @ "Ёг▒│"   .  :5   Not   "свЬ"  all ти▒     =>  ти▒     ^ =   ти▒         "ЁнРж"         +    Set a  @ "ЁТВМ"     To Date 'ЁнкЬ'    deFault .9f        ти▒   ORdEr bY Not *   Is nOt oF TYPE  oNLY "Ёжк║" @ "Ёз╗Ц"            ASc  NULLS FiRST     FoR uPDaTe WaIT iNtErVaL '' houR  uQ'"с╝Р"'             wITH REAd onlY  cONStrAiNt "ЁШБй" @ "ЁжПШ"                fROM jsOn_tabLE  cuRreNT of  :_5  @ :17     aLL "ЁФФЪ"  =>  DEFAUlT  As LOw          +        FORmAt JsON я╝М я╗к  @ ScaLE      cOLUmNS  "ЁжвЯ"   TruNcaTE fORMat jsOn wiTh WrAPPeR        PiVoT XML  *   Not  lIKec  coNnEcT_bY_ROot INSTeAD             aT LoCal     ** dECodE  NOT exISts   sELECT distINcT ти▒    bUlK colLecT iNto LiKE4         frOM  _  @ ""     partiTIOn By  "я║Ь" @ :55    =>  dEfAUlT       PIVot  DEFault  AS pArAMEtERS  @ sHriNK       For  "" @ "ЁеРЛ"    +        In  Any            PIVOT xmL  :сВИ   aLL :9  @ LanGuagE    UNiqUe ти▒    =>  dEFauLT       =>  ти▒ As "ЁнЯВ"     fOr  ""        in  wItH "ЁвРЗ" @ "ъЬЦ"    as  ти▒     SELECt uniqUE ти▒ :6  @ IsOPEn        inTO #роо   DistiNCt "" @ "ЁбзЗ"   alL ти▒ aS ""        =>  DEFAUlT        +     FROm TAblE  ти▒    innER JoIn  ти▒ UsiNG  DEaLLOCaTE  @ cASCAde     +        wHERe ти▒  StArt WItH ти▒  CONNEct By NocycLE ти▒  HaVINg ти▒    OrDeR sIbLinGS BY ти▒               unPivoT INcLude NuLLs  ""    FOR :с┐У  @ gLOBAl          in   ""   +       aS  tImEstAMP ''                 StArT witH ти▒  ConnEct BY ти▒    ordER By ти▒ nuLlS LASt     wiTH chEck OptIOn             at TimE zonE dBtimeZone                for  ""            In  ANY           ""    PartiTioN bY  Not *            JoiN   With :1     hash  @ ""   DIstInct maTERiALIZeD      =>  not  DeFAuLt      oVeRLAPs  dEFAUlt  :с╕п4  @ ""               ""         +      as   ти▒   WiTh cHECK OPtiOn  coNstRAinT "" @ ""          SeLECt ""  =>  DEfAult  As ""      InTo "" @ ""    DisTiNcT :7      =>  exiSts    ти▒   FOr UpdAtE Of  #I  @ sUSpenD    DIstINCt    .  *    wAiT 'Ёики'     With check OPtioN                 +     fRoM tHe  wITh "" @ :3      :7       +      as  ти▒   cyCLe "" @ ""   .  "" @ EnCrypT    DiSTINCT ""  =>  dEFAuLt         SeT StATIc  @ :_т╢║      To u''    deFault trUe       sELeCT *   < >  alL   ти▒        ""      bulk coLlecT inTo spACe  @ я┐Ф0     alL ChAR  @ ""   ""     =>  DEfault       =>  nOT *   nOt  betweeN  cASe ELsE cUrreNt oF  READS   .  *   +          END  at LOcaL         anD  CAst  MULTiSEt  ти▒   as DoUble precIsion  ChArACteR seT noT *   Is  Not  NulL               ** xMLquERy  CAst  exISTS   ти▒        as REF forEIGn  @ ""   DIStINCt               PASSINg ConnECT_bY_rOOT exTractvaLuE  NoT *   noT  IN    DeFAULT  :╙Я9  @ low                , *      AT TIme ZonE SeSSIonTImEZOnE           as :7      ReTuRniNg conTENT               aS :4          +     FrOm ти▒ uNpiVOT  ""   UNiQue "" @ ""      =>  DeFAULt  aS ""          fOr "" @ ""   nOt   ""  =>  xMLQUerY  *   PASsING By VALUE + CoNNeCt_By_rOOt ти▒  At TImE ZonE SeSSiontIMEZoNe    at locAL     **  ти▒        As tYpE  @ :5     +     RETUrniNg coNtenT      ** _  @ :р╡╖9       .  *   +   WITHIn groUP  ORder SIbLIngS bY ти▒       at LocAl         iS NOt Of  cLOSE  @ #р╕╕                 In   DEfAult            :8         .  ""     in   nOneDITiOnaBle  @ ""    UnIqUe exIstS   ти▒              +       as INTERVaL '''' dAy  tIMesTAmp ''''      TO YEar                     WHERE NOt mApPINg  @ ""   DisTINCt       **         NOT  BetWEen  *   aNd  Column_vAlUe   ""  =>  DefAUlt  aS "" @ ""          ovER  ORdEr BY   DEFAUlt      >   ти▒         asC  NuLLs LAST     ROws betwEen currENT row  AND Not CuRreNt of  ""  DIsTInCT "" @ ""      =>  ти▒ ""               PReCEdinG       At timE zonE dBtIMeZONe               StaRt WIth *   ! =  *         cONnECT by NoT trIm  both CaSE ти▒  ENd  At TimE zoNe DbTiMezoNE     ** :7    uNiqUe ""  :я╛и  @ joiN    =>  deFAulT  CoMPAcT  @ timEstAmP          =>  defAULt        +   wIthIN grouP  OrdER by ти▒ desC       over  ORder SIbLinGS BY ти▒ NUlls fIRST              NoT  LiKEc  *        froM  Not ExIstS   ти▒          AT Time zONe cuRsoR  ти▒   AT loCAL            is not A SEt         gRoUp by             haVinG Not *   LIkEc  eXtRaCt   ти▒ As ""       oVERlaPs  ""  aLl    =>  dEfAUlt             :8  @ likeC       , *        ** TREaT  ExisTs   ти▒        AS rEf dbtimEzOnE       . "" @ ""   .  :8  @ _    resuLt_cAche  @ ""   =>  NoT nEw ┘┐    +    At locaL         iS  Not  infiNITe                              ordEr BY CUrReNT oF  ""  uNIquE     +        dEsC  NulLs laST        aS oF period for "" @ ""    *   iN  *         AS AgenT  @ EXpiRE           BETWeEN    pivoT  dEfAuLT    FoR :2       +     iN  sElect ""  =>  deFAULt  ""      buLK cOLlect iNtO DAtAfIle  @ :6       frOM ти▒   WHERe nOt EXiStS  ти▒       GrOUp BY   GrOUpiNg setS   ?  At lOcaL     ** cASE  EnD        IS noT a sEt                                     jOIn  ти▒ UsING  :_сОЗ   All    .  *   +        cONneCt bY nOt CurRent oF  "" @ ""               wiTH ReaD oNlY      pIVoT  DEFAuLT    fOR  ""   alL ExtraCtvAluE  *   NOT  lIkE2  - XmlaGG  ти▒          ESCAPE ти▒         я╝М "" @ ""    uSE   ALl    =>  DEFAuLt        +   % bUlk_excEptiOnS . CounT   at lOcAl          , *      AT tIME zOnE :#   :5  @ :8    =>  nOT  "" @ ""   AlL    =>  ти▒ a  @ ""        OverlAPS  ""  All    =>  dEfaUlt  As ""              "" @ seGmeNt          .  *   +        ** Nchr  nOT   ти▒     я╝Б =     ╬Щ  @ ""   DEfaULt  as ""        =>  ти▒                 at LoCAL         subMULTIseT of namE   .  "" @ WRappED     +   KeeP  DeNsE_RaNk lasT oRDER siblINgS BY NOT EXISTs    with "" @ :4     AS  ти▒   SearCH dEPtH First By ти▒   SeT ╨мя┐е      CYClE reCycle   .  "" @ ""   ALL dEfaulT  AS Mod  @ :_            SEt cOlumN_valUe  @ ""     TO 0x    dEfAult ''''       SeleCt distiNCt ╙Д   =>  ти▒    INto :#  @ PARenT        all       fROM ""   subpARtITiOn  "" @ ""   DEFaulT  UNcoNDitiONAL            SAMPLE  ти▒    As "" @ INViSIbLE      paRTItioN By  ""  uNiqUe :3  @ XMLNaMESPAceS    =>  deFAUlt       =>  deFAUlt  aS "" @ ""         pIvOT XMl  ти▒   FoR ""  .  *   +     iN  ти▒          HaVing ти▒  groUp BY  ти▒           For Update oF  "" @ PIPeLineD         +        oRdeR SibliNgS BY ти▒ dEsC     FOr UpDATe SKiP LOcked   wiTH chEck OPTioN  CoNsTRAInT :7   DiStiNct ти▒ :4                   dEsC  NuLls FIrsT                                in  wIth :р╢Эт╖Н    as   ти▒   FOR UPdATe sKIP LocKED   order sIBliNgS by noT priOr 0x   aT lOcal     at TimE zoNe SeSSiOntimezone     ** +  ти▒               nULls First     wITH rEaD OnlY         wIth "" @ ""     :6    +      AS  ти▒   Cycle :2        seT ""    to    defAulT TIMEsTaMp ''       seLECt "" @ ""   diStINCT    =>  defauLt     FROm jSoN_Table   "" @ ""   =>  *   IS  NaN            oVeRLAPs  noT *   is NoT Of  oNlY "" @ tRIM             as LONG  @ _                forMAt JSon , ""    COLuMns  profIlE    VarCHAr   % tYpe          As ExIt  @ ""     PaRtItioN by  "" @ ""   DefAULT       =>  DeFaULt  As ""          wHErE cURrent OF  ▐Щ    dISTiNCT           GRouP by  GROUPiNG sETs  nOT dECODe  Not ExistS   ти▒          At time ZoNE SessIoNtiMEZOne         ! =  aNy   ти▒                       fOR uPdATe of  "" @ ""   .  *   +     oRDEr bY cURRent Of  ExPiRe               orDEr BY *   nOT  In   seLECT UnIque DEfaUlT  AS :3  @ ELemENt        FroM XMltaBLE  xMLNaMESPaCeS    я╝М tRue   pasSiNg  :3  @ :_    ""  =>  ти▒      =>  defAuLT  ""       OVERlapS  overfLoW  @ INTERFaCe    ""  DiSTinCT    =>  ти▒ "" @ ""         =>  defauLt                   VERsionS beTWeen tiMestamp  EXtrAct  Hour frOM Not *   iS of typE  :9                 ** sYs_cOnNeCt_By_PATh  DISTincT    at tIme ZONE DbtImEzoNE         And xMlCASt  muLTISET ти▒ As OpaQUE fiXED  dEFAuLT  authEnTiCaTIon  @ рд░1         usinG LiBRary "" @ dEferRablE     +    RANGe NOT   ти▒     nOT  In  ти▒       ..  *   BETWEEN  *   and  :3   All    .  :_   ти▒ aS "" @ ""          +   Keep  dEnSE_rANK FIrSt OrDER siBlInGs BY ти▒ DeSC          ** "" @ ""   DistinCt "" @ xmLTYPe    =>  ти▒       aT loCaL                   aT time zone DBTImezonE           UNpIVOT exclUDE nULlS   USIng    +       for  уГгт┐П   erROr_codE  @ ""   =>  Not *   Not MEMbER oF nuLL    ** ExtRaCT  hoUr From dATe  ти▒    At LOcAL                           IN  ""       +               pIvoT xmL  dEfAuLt  as :2      FoR "" @ SUbtYPE    DefaulT  ""        .  *     In  nOT  ти▒    ** DEcODE  ти▒         <  *                   StART wiTH cuRrent oF  ""  diStinCT           CONNeCT BY NOCyClE nOT cuRrENT Of  сжк9  @ ""    +         hAvIng eXIsTS  ти▒         OrDeR By cONnECT_By_roOt tREAT  ти▒ As DeCODe  @ :3                      desc     fOR upDAte  wITh CHeck opTiOn  COnsTRaint ""               NulLs fiRsT     wItH reAd oNLy  CoNsTRAInT shArD  @ ""             As Of tImESTAMP  ExiStS   witH :9    As  wiTH "" @ ""     "" @ ADVaNCED    uNiqUe :#0  @ wrAPPEd    =>  dEFAULt  :1          +      aS  ти▒   CYcLe :_2   ALL      set "" @ ""     tO .   DefaUlt u''        ти▒      search brEadTH fIrsT By NoT *   beTWeen  *   aNd  ""       +   WIThIn GrOup  ORdER BY ти▒ nULls LasT       over  paRTITIOn bY ти▒       AT LocaL                seT "" @ ""      cYclE contexT    DIstinCt      SET "" @ :2      to ''    DefaULT q'тАатАа'       SELEcT "" @ ""   "" @ COnstRainTs    =>  DEFaUlt       =>  nOT curRENt of  MeMOpTImize   unIQuE     +        usAbLE       BULk COlLeCT INtO :┌БсЛп  @ _    ""  =>  DEFAULt  As ""        .  :8  @ #    All *   noT  In   SeLECt UNIQUE deFAUlt     IntO "" @ ""          from json_tAblE  ти▒ FOrMAt JsOn cOlumns  wraPpEd    FoR ordINALiTy        PArtitioN By  DEfaUlt  aS INTerFaCe         unPIvoT excludE NulLs  :6   "" @ pRECISIon    =>  deFAuLt       .  *    foR  :7   .  EXteND   UniquE ти▒            iN   ""      +       As  TRUE                 sTaRT WITh ти▒  CoNnect bY noCYCle ти▒  GrOup By  gRoUping sets                 HAVing ти▒    For uPdaTe sKIP LoCked   wiTH CHeck OPtioN           aS "" @ ""          +     frOM   ти▒   ORder by cuRSOr  ти▒   aT tIme ZoNe :5    +   % ISOpEN  at tIME zONe dBtiMeZOnE                 asC     FOR updaTe of  "" @ :т╗з_     uNiqUe noT   ""  =>  dEfaUlT      In  ти▒       VARchar           NOwaIT      UNpiVot exCluDE nUlLS   "" @ ""   unIQUE         for  fIRst_ROws  @ ""    +        iN  dATAbase   dIsTINct     +            vErSIONs pErIod For "" @ :_р╡Ш    ""  :4  @ PctversIon    =>   ти▒   OverLaPS  ти▒               =>  cAsT  mULTISET  with сБШ    As  ти▒   seARCH dePtH FIRSt bY ти▒   seT "" @ rOWtyPE          ти▒      aS  faLSE  , fAlsE      AT LoCAl     ** CASt  ти▒ aS AuTonOMous_tRANSaCTiOn             Is  NOt  NaN              nOT cUrReNt of  ""  alL           priOR sYS_coNNEct_by_pAtH  DistiNct DefAULt  As "" @ ""         aT timE ZonE Ed          ** TrAnslaTE  NOT EXISTS   with "" @ ""     "" @ ""       +      as  ти▒   SeaRCH BREAdTH fiRSt bY ти▒ Desc  nUllS FiRSt    Set :#  @ Shard       CYcle :6   .  *   +    SET #╓║     to 0X    DEfauLT DAtE 'тЗЗ'        ти▒   For UpDaTE SKIp loCkeD           USiNG NChAr_Cs   at LOcal         anD *          Where Not *   Is not OF  "" @ ""             cONnEcT by  dEfAult      OvErLAps  Error_iNDEx  @ :7    uNiqUe    =>  ти▒ LocKed                grOuP BY  nOT *   IS Of TYpe  onlY ""                     ordEr SibLIngs by EXTraCt  TIMEZONE_MInutE FrOm ти▒          >  aLl   "" @ PaCkAge    ти▒ AS :р╣Й┘Щ  @ ""         =>  deFAult  PRiOr  @ сК╜0              DeSC  NuLls LAST     wiTh rEaD onLY           AS bUiltin  @ ""          pArTItION bY  FInAl  @ :6    =>  eXISTS   SeLEcT DefauLt     INTo "" @ ""      FrOm jsoN_Table  Not CUrREnt OF  ""  .  dEalLoCAtE   "" @ ""      =>  ти▒       +        cOLumnS  ""   NchaR  DIsTINCT      ExistS PAtH n'ЁбнД'            PIVOt  deFauLT  ""     for :9    +     in   "" @ :1    =>  DEFAulT                 whErE *   iN    :╘Х1   ти▒ as сИЯ         =>  deFAUlt  "" @ ""              sTaRt wITh traNsLaTe  ти▒ uSinG char_cS   aT tIMe ZOnE SESsiontImezoNE     ** "" @ use    aLL    .  PaRtiaL    +   % bulK_rowCoUNt  ти▒     AT tIme ZONE DBTimeZoNe         Is  NULl         COnNEct By nocyCle nOt eXIstS    ти▒   FOR uPDAtE Of  autO  @ ""    ти▒        NowaiT              orDEr SiBLiNgs bY casE  end        noT  BeTween  *   And  ""   alL     +   WitHIn GROUp  oRdeR SibLIngs BY ти▒       aT lOCaL     ** cAST  MuLtISeT  wITh ""   as  ти▒   sEarCh bReADth firsT BY ти▒ DESC  NUlLs LAST    sET "" @ :1         SELECT dEfauLT     fRoM xMLtAbLe  iNterVaL '' day  tO hOUR    PAssInG GrOuPINg  @ ""   unIQue ""  DisTiNct ти▒    =>  ти▒      =>  DEfauLt  :1           naTUraL fULl OuTER  JOIN  ти▒  UNpiVOT iNclUDE NullS   pRoCEDuRE  @ :_        ""  =>  ти▒       +       for "" @ FReEpOoLs    .  *     IN  NOrELY    UniQUe     +    As  iNtErvaL '''' day  tO daY  0x   , F                        wITH ReaD oNLy  cONstRAINT _   DEfaulT  :5  @ :9               As cHar  ти▒ CHAR     ChaRACTEr sET ти▒ % cHArseT       At TiME zONE caSe eLsE ти▒   EnD                dEsC  nULLS LaST     foR UPdaTe  with checK OPtIon           aS bitmAP         ON NoT :8    ovER  PARtiTIon By noT eXISTS   WITH "" @ ""     "" @ ""          AS  seLeCT dIsTINCT ти▒    bULk COllECt Into logoN   AlL deFAULt        UnIqUE       fROM  ти▒   piVOt  "" @ :ро╡    All    =>  deFAULt  as ROwdepEndenciES      for  "" @ ""   .  *   +        In  ти▒         ""    PaRtItiOn by  ""  =>  ти▒ сНк  @ LObS         iNNer joIN  "" @ ""    SAMPlE blocK  ти▒    "" @ ""     NAtUraL INnER Join  ти▒  ON ти▒     WHerE ти▒  cONNeCT by ти▒    for UPdaTE oF  NaTIonal  @ :1    all "" @ BATcH    =>  ти▒      .  ""  dEFaULt         Skip LOcKeD         SEleCT diSTinCt ти▒ :#       from  xMLTaBLE       as Of tImesTaMp  ""  =>  DEFauLT  As "" @ ""          PArtitioN BY  ти▒            whEre ти▒  staRT wITH ти▒  ConnEcT BY ти▒  havING ти▒    WitH REad ONLY  CoNSTrAiNT fIPSfLAg  @ :_    WrapPer      =>  dEfAUlt  aS NAtuRaL  @ ""              oRdeR BY ти▒ nulLS lAst                     ** nulL        nOT  iN    *   <  somE   :7  @ TRUe    =>  ти▒          #рн╢                 whERE nOt   loCkInG   DiSTiNcT    =>  defauLT      NoT  IN   wIth :7    As  WItH "" @ ""     "" @ NUlLS        as  ти▒   CYcle ""   +    SET ""    To q'##'    DEfaULt Q'тАбтАб'       SELEcT DEFaULT     FroM  jsoN_tAbLE  *   liKe2  + TrEaT  ти▒ aS rEF UNBOUnded  @ ""        at TiME ZonE sesSiontImeZone               , u''    COlumNS  :4    FOr OrDinaLIty       AS OF SCn  NOt CURrENt OF  "" @ :сАз╓в    UnIQue          ""         partitIoN BY  FalSE  @ :4    =>  dEFAuLT  aS TimeZONE_MINUte  @ ""         unPIvOt   _5    +       FOR "" @ nosoRT    dEFAUlT  As ""         _3      =>  not *   not  LikE2  XmlaGg  ти▒ oRDer siblings by ти▒ deSc       AT LOcaL     ** tRiM  ти▒   AT locAL         eSCapE ти▒               in  "" @ ""   DIStInCt DEfAUlt        +               CROSS joiN  TABlE  curRent oF  :2  @ ""           unpiVot   ""   +       fOR  COLlaTIOn       +        in  "" @ ""                 uNPIVoT INcluDE NulLs   :2   DisTiNct         +       foR :япЦ  @ biTMAP    aLl dEFauLt  aS "" @ each          .  ""     In  сЬЗ   .  *   +    AS  timEsTAmP ''''                 havINg NOT *   suBmulTISET OF *           GrouP By  cuBE   "" @ ""   aLl ""  aLl "" @ nokeep    =>  ти▒ aS :я░Ъя┐Ф         =>  dEfAUlT  "" @ :3          =>  ти▒     oVerlAPS  ти▒                             sEarCH BrEADTh First by   tRuE      =>  ти▒ BUiLD        IN     ти▒               set ""        witH :1  @ ""    aS  ти▒      ти▒   ordEr bY cHr  ти▒ UsIng Nchar_CS   AT TImE zOne seSSIONTiMezONe         ^ =  Any   ти▒           wITH rEaD onLY      ORDeR SibLInGs bY Not CURreNt of  :#6         deSc  NuLLS lAst     foR updATe wAIT TRue               ConnEcT By NOcyclE *   Is noT EmPTy         stARt WiTh Not "" @ ""   all     defaUlt        % ISoPEN        LIKE4  "" @ ""        +   oVer  orDEr siblINgS bY NoT exists    wIth :1  @ ""     pCTUsed   ти▒       +      AS  ти▒   SEaRCh breadth fIRst bY ти▒ NuLLs fIrsT    set ""     CycLE NATuraL  @ cUBe    ти▒ "" @ р▓Я┘Я          .  iDeNTifIeR     sET ""    TO iNTERVaL 'ЁзПп' minUtE     DEfaUlT TImEstAMP 'Ёа╣Я'       SeLECT ти▒ aS ""      INtO "" @ :2    ALL     all     +     FrOM :9  @ ""    т╝п0     PaRtitiON by  "" @ PrImARY    =>  dEFaulT       unPIvoT InCLudE nULLs   LocKing    dIStINct unCOnDiTIonaL  @ ""   ""  =>  DEfaulT       =>  DEFAulT  VARChAR2  @ :4               For  ""  DIStInct "" @ :сЗ▒сОЧ    =>  ти▒      .  *   +        in   pARaLLeL  @ ""   .  "" @ ""                     coNneCT by ти▒  gRouP BY cUBe   ти▒            hAvINg ти▒    oRDer bY ти▒ Desc        wiTh Read OnLY  COnsTraiNT :5   DiSTInCT              deSc     ROWS CURrEnT Row             EsCAPE NOt XmLqUery   wITh "" @ ""     ""  alL ти▒ aS "" @ ""             As  WITH oPerAtions     :2        +      aS  ти▒   search bREaDTH firSt by ти▒ NULls LasT    Set "" @ NorowDEpendeNciES       cYClE _  @ beFOre    .  *   +    SeT paraLlEl     TO .d    DeFAult ''        ти▒   with cHEck optIoN        SelecT uNIquE dEfAult     iNto "" @ _    .  LIBraRy  @ ""   aLl DEFAult  as :#т╜в  @ :#9             fRom  sElEct ALl :5   =>  ти▒ ""      INTO ""   +     froM isOLaTiOn    sUBpaRTiTioN  "" @ ""         saMple block  ти▒   SEeD  ти▒     vERsioNs PEriod for :1   vaRRay   alL    =>  deFaULT        ти▒  *   AND *     PIvOT Xml  ти▒ "" @ ""      FOr "" @ ""        +     iN ти▒        PARTitiON by  INdICes   ALl "" @ :я╡Щ4    =>  DeFaUlt       =>  ти▒ as ""       CroSs jOIn  XmltABlE  N''   paSsiNG DEfAult  As "" @ _        coluMns ти▒ RaW   % rOwtYpE    DeFauLt ти▒      paRtiTion by  "" @ Like2    =>  DeFauLt      Full  join  ти▒ uSinG  ATTrIbuTES  @ ""   diStInCT ти▒ :8  @ ▌й                 WheRe ти▒  sTART wItH ти▒  CoNnECT by ти▒    FOR UPDATe of  ""  .  *   +     ORDeR SibliNgs BY ти▒ deSc  nULls FIrSt     wITH ChECk OPtion  cOnstRaINT consTRUCTOr        PIvOT  SEt   ALL    =>  deFAULT    for ""  ти▒             in  AnY          As of PERiOD fOR :5  @ ""    +   betweeN         HavINg ти▒  grOuP BY           fOr UpDAte skiP lOCkeD   oRdeR sIBlINgS by ти▒       AT loCAl     ** xmlQuerY  *   PAsSing *     rETurnINg cOntent    At tiMe Zone DbTImEzoNe         paSsInG by valuE prioR EXtRact  ""  ти▒ AS :2         =>  dEFaulT    , *          ** XmlcAST  ти▒ As iNTeRVAL  syStEM  @ :3    diSTInct     +   tO  NOnE  @ ""   .  ""               reTurNing coNTent          iS EmptY               GRoUP By               WiTH ReAd oNlY  CONSTRAiNt "" @ ""             ..  not  :_   DIstiNCt delete   =>  DEFAuLT  aS ""        =>  "" @ decoDe       .  *   +   % bUlK_EXcePtIOns . cOuNT   At lOCaL     ** cUrsoR   SElECt ""  dIStINct CUrRenT OF  с╕Ир╝в  @ ""   ALL ти▒     +             =>  dEFAult     inTo "" @ forCe           FRom    ти▒   ORDer bY NOt *   Between   ти▒  At TIMe zoNe :т┐╢5  @ ""        +   % ROwcOunt           aND  *        aSc     For UPdaTE oF  ""  .  LOCAl  @ :6    DiSTincT           partiTion BY  dEFaULt  priVatE  @ pERIod            aS Of SCn  DEfaULt  as :8  @ ""          iNNer jOIN  jsoN_taBLe  *   IS noT of  ""           FoRmat jsON я╝М Date ''    CoLUmns  nEsTeD ""    colUMns  сИ╢5  @ :6     FOR oRdINALiTY           UNPiVOT   OVeR  @ ""   disTinct nOT eXisTs   SELecT _3   =>  ти▒    FROM XMLtaBle  XMLnaMESPAceS    я╝М ''   ColUMns ти▒ nVaRchaR2 CoLLatE ""      pATH ''''       VersioNs between sCn  nchr  ти▒   at lOcAL         anD - ""  ти▒           AT Time ZONE sESsioNTimEZOnE    at lOcAl     ** nulL          piVoT xMl  "" @ reJEcT    DIStinCT ти▒    =>  DEfAUlt    for ""  .  *   +     In  AnY           aS :1  @ ""     JOIN  ти▒  pIVot  "" @ DataBASE    =>  ти▒ dATa      foR  ""      +        In  ти▒          gRoup BY    ти▒             hAVing ти▒    For uPdate oF  :3   dIStiNcT dEfault  "" @ ""               WaIT FAlse     OrdER BY ти▒ NuLLs FIrSt             ""             fOR "" @ ""   ALL     +     in  :8  @ ""    ALl :#с╕Л  @ INDExING    =>    eMPty   =>  ти▒ aS ""       Not  In   ""     =>  DeFAulT            As :сбия░┤  @ ""           aS $.              PArtItIoN BY  DefAuLT          WherE NoT exiSts   wiTH ErrOr_COdE    As  ти▒   seArch BREadTH FIrST By ти▒ nULLS LASt    SeT "" @ rOWcOuNT          ти▒   WiTh ChECk oPtion  coNSTRAint ""             cONNEct BY NocyclE exisTs    ти▒   FOr Update Of  #7  @ pRImARY    UniqUe ти▒ :8  @ ""         .  *    NowaiT   wITH CHECk OPtiOn            StaRt With *   IS  noT  inFINITE         haVINg Not cUrReNt OF  ""  .  STORAGe  @ :8    DefaulT        +         gROUP By GRouPiNG seTs  extrAct  timEzonE_mINuTe FROM daTE  ти▒      ** - null         noT  BETweEN  *   ANd   WITH ""    ""          +      AS  ти▒   cyCLe MediUm  @ :#      sET "" @ ""     to FalSe    DefaULt TimestamP ''''        ти▒   Order sIBLInGs bY ти▒    FoR uPDatE wAit IntErVal 'ЁдЧо' HoUR  0X             aT lOcAl                          oRDEr BY Not exiSts   WitH :8  @ ""    as  ти▒   SEaRcH bReadtH FIrsT by ти▒   Set ""        ти▒   FOR UPdaTE  ORdEr sIblInGS By ти▒ AsC  nULlS firsT     WitH CHecK OPTiON  CoNstRAINt PROfilE  @ ""   UnIqUe              DESC  NuLLs LaSt     wITH REAd OnLY      For updatE oF  ""    sKIp loCked      AT lOCaL         iS  nan            OvErlaps  sYs_connecT_By_PATh  сЖН▌й   diSTInCT    =>  NOT *   IS  nuLl                   Is oF TYPe  OnlY rEBuilD            "" @ purge                   := NoT cuRRENT oF  "" @ ""   UnIQuE DEfAuLt        сАл  @ INdIcEs    =>  nOT cUrRENT OF  "" @ ""   .  *   +        as maxTrANS                    return IntERvAl  DIStiNCT ""     =>  dEfauLt  as "" @ inDiCEs          ""  ALl ""  =>  deFAuLt       .  :5  @ :т║Я     tO  *        ""        :8  @ ""   uNIQue     +    rAnGE dECode  NOT  KEep   =>  TRAnslATE  ти▒ usING cHAR_Cs   aT LOCal     ** ""   oVeR  pArTItIOn by default        at tiMe ZOnE nchR  ти▒            NOt  IN   SelecT All DEFAuLT     bulK ColLECT Into :2  @ :2    NopAralLEL   =>  dEfaulT        +     FrOm TAblE  SElect uNIQuE ти▒  @        bUlk CoLleCt IntO "" @       FroM  xMLtABLe  .E-F       crosS JOiN  ти▒  UNPivOT include NUlLs   "" @ ""       DistinCt     +       foR   DiSTINcT dEFauLT           +     IN   "" @ ""       +       AS  uQ'~~'                  ParTition bY  ""  =>  ти▒ As ""        pivot XmL  ти▒   FOr  @    .  *   +     IN  aNy            StART WitH ти▒  ConneCT bY NoCYClE ти▒         UNpivot eXcLuDE NULlS             fOr "" @ ""   all   =>  DefaUlT  aS  @             iN     +              wHeRe ти▒  HAViNg ти▒    with ChECK oPTioN  cOnStrAINt "" @ ""   aLL      =>  DeFaUlT                     OVERlAps  not *   iS a sET        aS                 AT TImE zoNE sESSiOntIMeZONE     ** xmLagg  NOt syS_connEct_by_PAth           IN  *         ORDeR SiBlinGS by    @    =>  nOT ExIsTS   wIth "" @ ""    aS  wIth  @ ""     ""  DEfAULT           uniquE ""  =>  ти▒          As  SelEcT defAuLt     BulK cOlLeCt InTo  @    DIStiNCt     uNiqUe "" @    =>  DEFAUlt  ""         +     FROm THe  ти▒   vErsioNS PeRioD fOr "" @       .    alL ти▒       BETWeEn  EXtRAct  deFAULT  As "" @ ""      я╝М *    , curSoR  ти▒   aT local              ** ?  aT time ZonE dBTImEZONe         and PrIor  @ ""   .  *   +     aT tIme ZoNE DbtimeZONe            "" @      PArtiTion bY  ""  =>  DEfaUlT       pIVot  "" @       =>  ти▒ aS      FOr    .  ""  DISTinCT          in  ти▒  "" @ ""              stARt WitH ти▒  coNNect by NocYCle ти▒  HAVinG ти▒  grOUP bY cUBE   ти▒              For UPDatE of  "" @ ""      order by ти▒ DEsC        CycLe  @    ти▒ AS "" @           ти▒       +    SET     TO .   DeFaULT n''       SeLEct DiStInCT   =>  DEfAuLT     FRoM  @ ""    SAmpLe  ти▒   seed  ти▒     AS of peRIoD foR ""   uniQuE     ти▒    UNpiVot exClUDe nuLLS    @    aLl         foR  "" @ ""   ""  =>  ти▒         .   @    diStiNcT   DeFaULT  AS "" @ ""         =>  dEfAUlT           +        In  "" @ ""    all     +    as timesTAMp ''''              AS ""    nATURal FuLL  joiN  JSoN_tABlE  ти▒ cOlUMnS   @ ""     FAlse  я╝М FAlSE    EXisTs pATh ""          uNpIvOt     .  *   +       fOr          iN  "" @    uniQue dEfAULT        +            VeRsIONS perioD for  @     +   ти▒  *   AND new ""      +      ** TReat  ти▒ As rEf ""      .   .  "" @ ""   UniQuE       AT loCal             PARTITIoN bY  ти▒ AS        NaTUral fULL OuteR  JOin   wITH  @ ""    As  ти▒   cYcle   ти▒        sET "" @      tO tRue    DEFaULT Nq'\\'        ти▒   FOR uPDAtE  WITh REAd onLY            WHeRe ти▒  coNnECT bY ти▒  StArt WiTH ти▒  grOUp by   ти▒                 SEArcH BreADTH FIRST by ти▒ AsC  nUlLS laSt    set        SeLECT ""  =>  dEfaUlt     BUlk cOLLEcT IntO "" @         +     fROm   wItH "" @     As  ти▒     SElEcT uNiQuE  @    uNiqUe    =>  ти▒    fRom  JsoN_TABLe  ти▒ FORMAT JSoN , DATe 'ЁокМ'    cOlUmnS   @ ""     FalsE  я╝М tRuE   % tyPE    TruNCATe pATH dATe 'ЁжЖП'          PIvoT xMl  DefaULT    fOR ""   DistiNcT  @ ""     =>  defAULT          =>  ти▒         in  ти▒        VeRsiOnS betWeEn tImestaMP  *   aNd  ти▒     ** tREAT  ти▒ aS REF ""       at TiME ZOnE + ти▒             as "" @ ""     pArTiTioN by  ти▒  @ ""        righT OuTeR  joIN  ти▒ oN ти▒      pArtitiOn BY  deFAult  ""          start with ти▒  CoNNECt BY ти▒  HaviNG ти▒    orDer BY ти▒ DeSc     FoR UpDate          UnpiVot  "" @ ""           +    FOr   @             IN      +                 wherE ти▒    FoR UpDate SkiP locked   orDER SIBLinGS bY ти▒    WitH reAD only               > =   selecT *        As       BuLk cOllect INto ""     FRom JSon_taBLe   "" @    dISTiNcT   all ти▒  @          =>  deFaUlt       =>  ти▒     oveRLaps   @ ""   =>  DEFAuLt  AS ""              FORmaT jSoN ColuMnS     trUNCATe fOrMat JSoN WITh CoNditIONAl aRRAY wraPPer  PAtH "" @ ""            RIghT  jOiN  XmLtAble  xMLNamESPACES  dEfauLT ''     я╝М IntErvAL 'Ём║Д' moNTH  TO SEConD    ColUmNs noT cUrrENt of  "" @     aLl          FOr oRdInAlIty     PIvot XmL  ""  DeFAULt  As  @          =>  deFaUlT    FoR   @ ""   *   BEtWeen  *   aND  *              +        IN   WITh ""   AS  ти▒   cYcLE "" @ ""     sET  @ ""     to 0X    DEfAUlt n''        ти▒   OrDER sIblINgs By tRim  ти▒   aT tIMe zOne DBtimEZoNE         is NoT OF TYPe  "" @             NuLLS firST     FOR updAte Of    distiNCT      NowAiT   WitH reaD onlY                    GROup bY               WiTH CHEcK OPTIoN  ConsTraINT ""             dESc             NoT  Like2  XMlCAsT  mUltISEt  sElect ""  =>  *           inTO ""  ALL     +     fROm TABlE  CURRENT of   @    DiSTiNCT    .  *           paRtiTIoN By   @ ""   =>  DEFauLt  aS ""        PIvOt  nOt ExiSTs   wItH        +      AS   ти▒   oRDer SIBlINGS By not EXISts   ти▒           FoR uPdaTe OF  "" @    ""  nOt DecoDE  ти▒         < =  *        as  @          =>  DefaULt       .  *   +    wAit trUE     wIth ReAD oNly  CoNStraInt  @ ""        seaRch bREADTh fIrst by *   in  $.  at LOCAL     ** ""  .        +   % bulk_rOwcOunt  ти▒     At LOCAL               AsC  NUlls LaST    sEt ""       seLECT all "" @    DisTinct  @    uniQue ти▒    =>  DEFAuLt  "" @ ""         =>  noT CuRREnt OF  "" @ ""   ти▒          DEfAUlt             ""      inTO    All       FrOm  "" @     "" @ ""     pARTiTion by      =>  DeFAult      ~ =     "" @    =>  ти▒               aS           As oF tIMeStAMp  .F     ** XmLquErY  neW ""  .  "" @ ""   UNIque DEfAult  as "" @ ""           At LoCAl         PaSsInG *   As  @        +     ReTUrNiNg ContEnt    AT TIMe zOnE SEsSionTimeZONE         not  In      =>  DeFAuLT               piVoT  "" @    =>  deFauLT       FOr      IN  any            ParTiTIOn BY  noT cuRRENt oF  ""  ALL     +             PIvOt xmL  NOT *   Is  not  infiNite         @ ""      For          in  WItH      @ ""   "" @ ""   =>  DeFauLt  as "" @           +      AS  ти▒   SeaRch depth first bY    @    DisTiNcT ти▒      =>  DefAULT  aS ""       noT  IN  ти▒         SeT      CYCle "" @ ""     SEt  @ ""     tO n''''    DEFault D        ти▒   OrDer BY nOt       +   % bUlk_eXcepTioNS  ти▒   . erROr_code         iN    ти▒          AsC  NUllS lASt     With CHECk oPTioN  CoNstRaiNt ""   @    =>  eXtRact  YEaR fROm ти▒      ** eXTractvAlUe  DefauLt  "" @       , TRANSlate  ти▒ using CHaR_cS   At timE Zone ти▒     ** - ти▒        я╝М *      at lOcal                               wHEre not   ""  All    =>  ти▒ aS "" @         ~ =   wIth  @ ""     ""  ALl  @    =>  ти▒      .  ""   +      aS  ти▒   seArcH deptH FiRst BY ти▒ nULLs FIRst    Set ""     cycLE  @ ""      .  *   +    seT     TO 0X    DefAULt q'()'       seLeCT unIque "" @    =>  DEfAUlT     FroM ти▒ UNPiVOt InCLuDE NulLs  "" @    ALL      fOr    unIQUE          in      +       aS ''               croSS JOIN  TABLE  ти▒      uNPIVot eXCluDe NuLls   @ ""     FoR ""  dEfAUlT             =>  DeFaULt  ""           IN   "" @    dIstINCT ти▒ as  @ ""          +                 cOnnEct By NOcyCle ти▒  STArT wITh ти▒              sTaRT wiTH *   =  TriM  ти▒ fRoM  ти▒               CoNnEcT by  "" @ ""      =>  DeFaUlT      ovErLAPs   @ ""   =>  ти▒                grOUP BY  nOt *   iS OF  ONLY "" @                     HaviNg NoT EXIsTs   SElEct UnIQuE DEFault     BULK coLLEct INTo ""  .  *     FRoM ти▒ aS oF scn  DEFault  "" @          ""    nAturaL jOIn    ти▒   @ ""     PaRtITioN bY  ти▒     INNER join  ти▒ uSIng     aLl   DIsTINcT  @ ""   =>  ти▒      =>  dEFAUlt  AS          +        veRSIoNs betWeen TImEsTamp  "" @ ""   uniQue     UniQue     WIthIn gROUP  oRDEr sIBliNGS BY ти▒      oVer  orDEr BY ти▒ DEsC        AT loCAL     ** TRANSLate  ти▒ USing CHAR_Cs   at tiMe ZONE CHR  ти▒ UsinG nChAr_Cs            aND - ConNEcT_bY_Root ти▒           unpIVot   "" @     +       fOr      iN   ""  DefAULt  "" @          .  *   +       As INTErvAL '''' hour  0X   , Date ''                    ParTITiON BY    =>  ти▒ As        JoIN   @     SUbpartItIon  ""          parTitiOn By  dEfauLT      InNER jOiN  ти▒  ON ти▒      whERe ти▒  ConNECt BY NocYcLe ти▒    ORDer bY ти▒ nUlls lASt                fOr UPDate SKip lOcked           as ""     for  @ ""   UnIquE       iN  Not *   Is Of TyPE   @ ""                       WHErE CuRRent of  "" @     +           OrDer BY eXisTs   wiTH    AS  SElEcT nOt neW  @ ""   ""  ""  dIStINCt    =>  ти▒      =>  DeFaUlT  "" @           +    At TimE zONE dbtImezoNE     **    +   kEEp  DENSe_ranK lAst OrdEr SIBLiNgs By ти▒ dEsC  nullS last              NOt  bETwEEn  *   aND  *        "" @ ""       iNTO "" @       .   @       fROM xmlTABlE  TImEstaMp ''   PASsiNg BY VALUE "" @ ""   All EXisTS   ти▒             =>  NoT pRIor    OVEr  paRtitIOn By DEfaUlt        At TiMe zOnE seSSIOnTIMezoNe           NoT MeMBEr oF   DisTINct "" @    =>  dEfAulT        +   % nOTfOunD  AT loCal                aS          pIvOT xml  dEfauLt    for "" @ ""    UNIQuE     +     in  ти▒        VErsioNS PERIod FOR  @ ""   .  "" @ ""       betWeEN  EXTract  SecOnd fROM daTE  CuRrENt oF    uNIQue ти▒ aS ""         +           at LOcal     ** XmLqueRy  *   pAssInG *   As ""   DEFaUlt             ReTUrnIng CONtENt          And *       PARtItioN BY   @       =>  NOt nEW ""  .  *   +    aT timE zOne SeSsIoNTiMezONE                   UnpIvOT iNClude nUlLs   "" @ ""        For     @    unIQue    =>  DeFaUlT        +        IN    .  *    As Nq'[]'               CoNNEcT bY NoCyCLe ExISTs   ти▒         sTarT wITH NOT TrIm  trAILiNg FrOm  ти▒     ** ""  ти▒ AS "" @           keep  DEnse_RaNk lAst order sibLINgs by ти▒ ASc  nUlLS FiRST       Over  ORdeR SiBlinGS bY ти▒ asc     RaNGe bEtweeN ти▒  pREcEding  aNd ти▒  PreCedinG       At TIME zonE DbtimeZOnE         lIke2  *         GROup BY   rollUP  Xmlagg  ти▒     ** conNECt_BY_ROot ?          Not  BetweEN  *   And  *                         FoR uPDate OF   @         NOwAIt   OrDER SiBlingS By nOt  ти▒ aS  @ ""        OverLApS  ""  DIStINcT defaUlt       =>  ти▒ ""                 wItH read oNly          ти▒      wItH chEck optiON           DESC  NUllS LAST     WItH rEaD oNLY      As Time  WItH  DisTiNCt    locAl     TimE  UnIqUE    ZONE    =>  dEFAulT  ""         % TYpE      At LOcAl         EScapE not   defaUlT      In    @ ""   =>  + xmLQueRy  *   PAssINg bY ValUE *   aS "" @    DiSTInct DefAuLT        +     retURNiNG CoNtENt     AT TIme zOne TRIm  ти▒   aT LoCaL        ** XmLAGg  ти▒ ordEr bY ти▒ Nulls LAsT             =   @    ""  =>  ти▒       uniqUe     +   OVer  orDer BY ти▒                                  ..  nOT cuRRenT oF   @ ""             AUThiD DefInER        inVALiDatE     